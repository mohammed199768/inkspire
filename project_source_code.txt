
================================================================================
FILE: .\next-env.d.ts
================================================================================

/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/building-your-application/configuring/typescript for more information.



================================================================================
FILE: .\tailwind.config.ts
================================================================================

import type { Config } from "tailwindcss";

const config: Config = {
    content: [
        "./pages/**/*.{js,ts,jsx,tsx,mdx}",
        "./components/**/*.{js,ts,jsx,tsx,mdx}",
        "./app/**/*.{js,ts,jsx,tsx,mdx}",
    ],
    theme: {
        extend: {
            colors: {
                background: "#09060f",
                foreground: "var(--foreground)",
                inkspireBlack: '#09060f',
                inkspirePurple: '#201037', // Deep Royal
                inkspireIndigo: '#0d0e22', // Midnight
                accentPurple: '#a78bfa',    // Soft Light Purple for highlights
            },
            fontFamily: {
                sans: ['var(--font-inter)', 'sans-serif'],
                display: ['var(--font-outfit)', 'sans-serif'],
            },
            // --- Sci-Fi Animation Systems ---
            animation: {
                'scanline': 'scanline 8s linear infinite',
                'spin-slow': 'spin 12s linear infinite',
                'pulse-neon': 'pulse-neon 2s ease-in-out infinite',
                'glitch': 'glitch 0.3s cubic-bezier(.25,.46,.45,.94) both infinite',
                'float': 'float 6s ease-in-out infinite',
            },
            keyframes: {
                scanline: {
                    '0%': { transform: 'translateY(-100%)' },
                    '100%': { transform: 'translateY(500%)' },
                },
                'pulse-neon': {
                    '0%, 100%': { opacity: '1', filter: 'drop-shadow(0 0 5px rgba(168,85,247,0.5))' },
                    '50%': { opacity: '0.7', filter: 'drop-shadow(0 0 20px rgba(168,85,247,0.8))' },
                },
                glitch: {
                    '0%': { transform: 'translate(0)' },
                    '20%': { transform: 'translate(-2px, 2px)' },
                    '40%': { transform: 'translate(-2px, -2px)' },
                    '60%': { transform: 'translate(2px, 2px)' },
                    '80%': { transform: 'translate(2px, -2px)' },
                    '100%': { transform: 'translate(0)' },
                },
                float: {
                    '0%, 100%': { transform: 'translateY(0)' },
                    '50%': { transform: 'translateY(-20px)' },
                }
            },
            // --- End of Sci-Fi Additions ---
        },
    },
    plugins: [],
};
export default config;


================================================================================
FILE: .\app\globals.css
================================================================================

@tailwind base;
@tailwind components;
@tailwind utilities;

@import "../styles/tablet.css";

:root {
  --bg-base: #09060f;
  --bg-deep: #0d0e22;
  --bg-accent: #201037;
  --bg-primary: #09060f;
  --bg-secondary: #0d0e22;
  --accent-purple: #a78bfa;
  --depth-indigo: #0d0e22;
  --foreground: rgba(255, 255, 255, 0.9);
  --text-secondary: rgba(255, 255, 255, 0.65);

  /* Typography Scale - Calibrated Clamps */
  --fs-display: clamp(2.5rem, 7vw, 5.5rem);
  --fs-h1: clamp(2.25rem, 5vw, 4rem);
  --fs-h2: clamp(1.85rem, 4vw, 3rem);
  --fs-h3: clamp(1.5rem, 3vw, 2.25rem);
  --fs-h4: clamp(1.25rem, 2.5vw, 1.75rem);
  --fs-body: clamp(0.95rem, 1.2vw, 1.125rem);
  --fs-sm: clamp(0.8rem, 1vw, 0.9rem);

  /* Spacing Scale */
  --space-xxl: clamp(4rem, 10vh, 8rem);
  --space-xl: clamp(3rem, 7vh, 5rem);
  --space-lg: clamp(2rem, 4vh, 3rem);
  --space-md: clamp(1rem, 2vh, 1.5rem);
  --container-padding: clamp(1.25rem, 5vw, 4rem);
}

body {
  color: var(--foreground);
  background: var(--bg-base); 
  background: linear-gradient(-45deg, #09060f, #0d0e22, #201037, #0d0e22);
  background-size: 400% 400%;
  background-attachment: fixed;
  min-height: 100vh;
  overflow-x: hidden;
  font-family: var(--font-ibrand), var(--font-outfit), sans-serif;
  font-size: var(--fs-body);
  line-height: 1.6;
}

@keyframes cinematicGradient {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Subtle animation on desktop only */
@media (min-width: 1024px) {
  @media (prefers-reduced-motion: no-preference) {
    body {
      animation: cinematicGradient 20s ease infinite;
    }
  }
}

/* Fix for iOS Safari / Mobile - Static Deep Gradient */
@supports (-webkit-touch-callout: none) {
  body {
    background-attachment: scroll;
    background: linear-gradient(180deg, var(--bg-base) 0%, var(--bg-deep) 100%);
    animation: none !important;
  }
}

@media (max-width: 1023px) {
  body {
    animation: none !important;
  }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #0a0a0a;
}

::-webkit-scrollbar-thumb {
  background: #333;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* Hide scrollbar for IE, Edge and Firefox */
/* Hide scrollbar for IE, Edge and Firefox */
html {
  -ms-overflow-style: none;
  /* IE and Edge */
  scroll-behavior: smooth;
}

@supports (scrollbar-width: none) {
  html {
    scrollbar-width: none;
    /* Firefox */
  }
}

/* Magic Wave Transition Styling */
.hero-wave-container {
  width: 100%;
  height: 100%;
  background: linear-gradient(-45deg, var(--bg-primary), var(--depth-indigo), var(--bg-secondary), var(--depth-indigo));
  background-size: 400% 400%;
  animation: gradientShift 25s ease infinite;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320' preserveAspectRatio='none'%3E%3Cpath d='M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,224C672,245,768,267,864,261.3C960,256,1056,224,1152,197.3C1248,171,1344,149,1392,138.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z' /%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320' preserveAspectRatio='none'%3E%3Cpath d='M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,224C672,245,768,267,864,261.3C960,256,1056,224,1152,197.3C1248,171,1344,149,1392,138.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z' /%3E%3C/svg%3E");
  -webkit-mask-size: 100% 100%;
  mask-size: 100% 100%;
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
}

/* Utility for text selection color */
::selection {
  background: var(--bg-accent);
  color: #ffffff;
}

/* IBRAND - Special brand font for "Inkspire" */
/* GLOBAL TYPOGRAPHY SYSTEM
   Unifying all headings and bold text to match "Our Clients" style */
h1,
h2,
h3,
h4,
h5,
h6,
strong,
b,
.font-bold,
.font-semibold,
.font-extrabold,
.font-black,
.brand-font {
  font-family: var(--font-ibrand), var(--font-outfit), sans-serif;
  font-weight: 400;
  /* iBrand appears bold naturally; maintain Our Clients look */
  letter-spacing: 0.02em;
  line-height: 1.25;
}

h1 { font-size: var(--fs-h1); }
h2 { font-size: var(--fs-h2); }
h3 { font-size: var(--fs-h3); }
h4 { font-size: var(--fs-h4); }
h5 { font-size: var(--fs-h4); opacity: 0.9; }
h6 { font-size: var(--fs-sm); text-transform: uppercase; letter-spacing: 0.2em; }

/* Hero Animations */
@keyframes slideRight {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(20%);
  }
}

@keyframes slideLeft {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(-20%);
  }
}

@keyframes slideDown {
  0% {
    transform: translateY(0);
  }

  100% {
    transform: translateY(15%);
  }
}

@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.animate-slide-right {
  animation: slideRight 20s ease-in-out infinite alternate;
}

.animate-slide-left {
  animation: slideLeft 25s ease-in-out infinite alternate;
}

.animate-slide-down {
  animation: slideDown 30s ease-in-out infinite alternate;
}

.animated-gradient-text {
  background: linear-gradient(
    90deg,
    #ffffff,
    #a78bfa,
    #201037,
    #a78bfa,
    #ffffff
  );
  background-size: 300% 300%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: gradientShift 8s ease infinite;
  transition: all 0.3s ease;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.group:hover .animated-gradient-text {
  animation: gradientShift 2s ease infinite;
  filter: brightness(1.2);
  transform: scale(1.05);
}

/* Vector Particles */
.vector-particle {
  width: calc(var(--particle-size) * 1px);
  height: calc(var(--particle-size) * 1px);
  left: var(--particle-left);
  top: var(--particle-top);
  opacity: var(--particle-opacity);
}

/* Floating 3D Image Plane Animation */
@keyframes floaty {
  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-15px);
  }
}

.selectedwork-plane {
  will-change: transform;
  animation: floaty 6s ease-in-out infinite;
  transform-style: preserve-3d;
}

/* Elite CTA Premium Effects */
.elite-cta-glow {
  position: absolute;
  inset: -20px;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
  border-radius: 9999px;
  filter: blur(25px);
  opacity: 0;
  transition: opacity 0.6s ease, transform 0.6s ease;
  pointer-events: none;
  z-index: -1;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.group:hover .elite-cta-glow {
  opacity: 1;
  transform: scale(1.3);
  animation: eliteBreathingGlow 4s ease-in-out infinite;
}

@keyframes eliteBreathingGlow {
  0%, 100% { opacity: 0.4; transform: scale(1.1); }
  50% { opacity: 0.7; transform: scale(1.4); }
}

.conic-border-wrap {
  position: relative;
  padding: 1.5px;
  border-radius: 9999px;
  background: rgba(255, 255, 255, 0.15);
  overflow: hidden;
  transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
  isolation: isolate;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.conic-border-wrap::before {
  content: '';
  position: absolute;
  top: -150%;
  left: -150%;
  width: 400%;
  height: 400%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    transparent 120deg,
    rgba(255, 255, 255, 0) 150deg,
    rgba(255, 255, 255, 0.8) 180deg,
    rgba(255, 255, 255, 0) 210deg,
    transparent 240deg,
    transparent 360deg
  );
  animation: rotateEliteBorder 5s linear infinite;
  opacity: 0;
  transition: opacity 0.4s ease;
  z-index: -1;
}

.group:hover .conic-border-wrap::before {
  opacity: 1;
}

@keyframes rotateEliteBorder {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.group:hover .conic-border-wrap {
    transform: translateY(-3px);
    box-shadow: 0 25px 50px -12px rgba(255, 255, 255, 0.15);
    background: rgba(255, 255, 255, 0.2);
}


/* Scanline Animation */
@keyframes scanline {
  0% { transform: translateY(-100%); }
  100% { transform: translateY(100%); }
}

.scan-line {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, transparent, rgba(160, 160, 255, 0.05), transparent);
  pointer-events: none;
  animation: scanline 6s linear infinite;
  z-index: 5;
}

/* Cinematic Header Utilities */
.text-cinematic-xl {
  font-size: var(--fs-display);
  line-height: 0.95;
  letter-spacing: -0.04em;
}

/* Safari / Heavy Blur Fallback utility */
.safari-no-backdrop {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

.premium-glass-performance {
  background-color: rgba(10, 10, 15, 0.75);
  background-image: 
    radial-gradient(circle at top left, rgba(255, 255, 255, 0.08), transparent),
    url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)\'/%3E%3C/svg%3E");
  background-blend-mode: overlay;
  border: 1px solid rgba(255, 255, 255, 0.12);
}

/* Safari Logo Fringing Fix */
.safari-logo-fix {
  filter: none !important;
  -webkit-filter: none !important;
  mix-blend-mode: normal !important;
}

/* Base state for GSAP Fade Up to prevent flickering */
.fade-up {
  opacity: 0;
  visibility: hidden;
}



================================================================================
FILE: .\app\layout.tsx
================================================================================

import type { Metadata, Viewport } from "next";
import dynamic from "next/dynamic";
import localFont from "next/font/local";
import "./globals.css";
import { siteContent } from '@/data/siteContent';
import NavbarFullMenu from "@/components/layout/NavbarFullMenu";
import MotionLayout from "@/components/layout/MotionLayout";
import SmoothScroll from "@/components/layout/SmoothScroll";
import Preloader from "@/components/ui/Preloader";
import { PopupProvider } from "@/hooks/usePopup";
import InsightPopup from "@/components/popup/InsightPopup";

// Optimized Font Loading with next/font/local
const inter = localFont({
    src: "./fonts/InterVariable.woff2",
    variable: "--font-inter",
    display: "swap",
    weight: "100 900",
});

const outfit = localFont({
    src: [
        { path: "./fonts/Outfit-Regular.ttf", weight: "400", style: "normal" },
        { path: "./fonts/Outfit-Bold.ttf", weight: "700", style: "normal" },
    ],
    variable: "--font-outfit",
    display: "swap",
});

const ibrand = localFont({
    src: "./fonts/ibrand.otf",
    variable: "--font-ibrand",
    display: "swap",
});

// Lazy load heavy visual effects
const FloatingVectorParticles = dynamic(() => import("@/components/ui/FloatingVectorParticles"), { ssr: false });


const Cursor = dynamic(() => import("@/components/ui/Cursor"), { ssr: false });

export const metadata: Metadata = {
    metadataBase: new URL('https://inkspire.studio'),
    title: {
        default: "Inkspire Agency | Cinematic Digital Experiences",
        template: "%s | Inkspire Agency"
    },
    description: "We turn raw ideas into cinematic digital experiences. Expert web design, development, branding, and motion graphics in Amman, Jordan.",
    keywords: ["web design", "web development", "branding", "motion graphics", "digital agency", "creative studio", "Amman", "Jordan", "UI/UX design"],
    authors: [{ name: "Mohammad Aldomi" }],
    creator: "Inkspire Agency",
    publisher: "Inkspire Agency",
    formatDetection: {
        email: false,
        address: false,
        telephone: false,
    },
    openGraph: {
        type: "website",
        locale: "en_US",
        url: "https://inkspire.studio",
        title: "Inkspire Agency | Cinematic Digital Experiences",
        description: "We turn raw ideas into cinematic digital experiences. Expert web design, development, and branding.",
        siteName: "Inkspire Agency",
        images: [{
            url: "/logos/Inkspire logos/logo1.png",
            width: 1200,
            height: 630,
            alt: "Inkspire Agency"
        }],
    },
    twitter: {
        card: "summary_large_image",
        title: "Inkspire Agency | Cinematic Digital Experiences",
        description: "We turn raw ideas into cinematic digital experiences.",
        images: ["/logos/Inkspire logos/logo1.png"],
    },
    robots: {
        index: true,
        follow: true,
        googleBot: {
            index: true,
            follow: true,
            'max-video-preview': -1,
            'max-image-preview': 'large',
            'max-snippet': -1,
        },
    },
};

export const viewport: Viewport = {
    themeColor: '#000000',
    width: 'device-width',
    initialScale: 1,
    maximumScale: 5,
};

export default function RootLayout({
    children,
}: Readonly<{
    children: React.ReactNode;
}>) {
    return (
        <html lang="en" className={`${inter.variable} ${outfit.variable} ${ibrand.variable}`}>
            <head>
                <link rel="icon" href="/logos/Inkspire logos/logo1.png" type="image/png" />
                <link rel="preconnect" href="https://images.unsplash.com" crossOrigin="anonymous" />
            </head>
            <body className="antialiased overflow-x-hidden text-white selection:bg-inkspirePurple selection:text-white font-sans">
                <Preloader />
                <SmoothScroll>
                    <PopupProvider>
                        <FloatingVectorParticles />
                        <Cursor />
                        <NavbarFullMenu />
                        <MotionLayout>
                            {children}
                        </MotionLayout>
                        <InsightPopup />
                    </PopupProvider>
                </SmoothScroll>
            </body>
        </html>
    );
}



================================================================================
FILE: .\app\manifest.ts
================================================================================

import { MetadataRoute } from 'next'

export default function manifest(): MetadataRoute.Manifest {
    return {
        name: 'Inkspire Studio',
        short_name: 'Inkspire',
        description: 'We turn raw ideas into cinematic digital experiences',
        start_url: '/',
        display: 'standalone',
        background_color: '#000000',
        theme_color: '#09060f',
        icons: [
            {
                src: '/logos/Inkspire logos/logo.svg',
                sizes: 'any',
                type: 'image/svg+xml',
            },
        ],
    }
}



================================================================================
FILE: .\app\page.tsx
================================================================================

import NineDimensionsLayout from "@/components/nine-dimensions/NineDimensionsLayout";

export default function Home() {
    return <NineDimensionsLayout />;
}



================================================================================
FILE: .\app\sitemap.ts
================================================================================

import { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
    const baseUrl = 'https://inkspire.studio'

    return [
        {
            url: baseUrl,
            lastModified: new Date(),
            changeFrequency: 'weekly',
            priority: 1,
        },
        {
            url: `${baseUrl}/portfolio`,
            lastModified: new Date(),
            changeFrequency: 'weekly',
            priority: 0.9,
        },
        {
            url: `${baseUrl}/contact`,
            lastModified: new Date(),
            changeFrequency: 'monthly',
            priority: 0.8,
        },
    ]
}



================================================================================
FILE: .\app\contact\metadata.ts
================================================================================

import type { Metadata } from "next";

export const metadata: Metadata = {
    title: "Contact Us",
    description: "Get in touch with Inkspire Studio. Let's collaborate to turn your vision into a cinematic digital experience. Based in Amman, Jordan.",
    openGraph: {
        title: "Contact Us | Inkspire Studio",
        description: "Let's collaborate to turn your vision into reality.",
        images: ["/logos/Inkspire logos/logo1.png"],
    },
};



================================================================================
FILE: .\app\contact\page.tsx
================================================================================

"use client";

import React from "react";
import ContactCommandCenter from "@/components/contact/ContactCommandCenter";
import dynamic from "next/dynamic";
const ParticleGlobeScene = dynamic(() => import("@/components/contact/ParticleGlobeScene"), { ssr: false });
import { useCinematicTransitions } from "@/hooks/useCinematicTransitions";

export default function ContactPage() {
    // Preserve cinematic transitions for the page entry
    useCinematicTransitions();

    return (
        <main className="relative w-full min-h-screen text-white overflow-hidden flex flex-col lg:flex-row">
            
            {/* LEFT SIDE: THE COMMAND CENTER (FORM) */}
            <div className="w-full lg:w-1/2 relative z-10">
                <ContactCommandCenter />
            </div>

            {/* RIGHT SIDE: THE HOLOGRAPHIC VOID (3D) */}
            <div className="hidden lg:block lg:w-1/2 h-screen sticky top-0 right-0 overflow-hidden">
                {/* Visual Depth Background */}
                <div className="absolute inset-0 z-0">
                    <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-radial-gradient from-purple-900/10 via-transparent to-transparent opacity-50" />
                </div>
                
                {/* 3D Scene */}
                <div className="relative w-full h-full z-10">
                    <ParticleGlobeScene />
                </div>

                {/* Left Fade Overlay (for seamless split) */}
                <div className="absolute inset-y-0 left-0 w-32 bg-gradient-to-r from-[#09060f] to-transparent z-20 pointer-events-none" />
                
                {/* Top/Bottom Shims */}
                <div className="absolute inset-x-0 top-0 h-32 bg-gradient-to-b from-[#09060f] to-transparent z-20 pointer-events-none" />
                <div className="absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-[#09060f] to-transparent z-20 pointer-events-none" />
            </div>

            {/* Mobile Visual Background (Subtle) */}
            <div className="lg:hidden fixed inset-0 z-0 pointer-events-none">
                 <div className="absolute top-1/4 right-0 w-64 h-64 bg-purple-600/10 rounded-full blur-[100px]" />
                 <div className="absolute bottom-1/4 left-0 w-64 h-64 bg-blue-600/5 rounded-full blur-[100px]" />
            </div>
        </main>
    );
}




================================================================================
FILE: .\app\portfolio\metadata.ts
================================================================================

import type { Metadata } from "next";

export const metadata: Metadata = {
    title: "Portfolio",
    description: "Explore our curated collection of digital masterpieces. From web design to branding, see how we transform ideas into stunning realities.",
    openGraph: {
        title: "Our Portfolio | Inkspire Studio",
        description: "Explore our curated collection of digital masterpieces.",
        images: ["/logos/Inkspire logos/logo1.png"],
    },
};



================================================================================
FILE: .\app\portfolio\page.tsx
================================================================================

"use client";

import dynamic from "next/dynamic";
import PageHero from "@/components/hero/PageHero";
import { useCinematicTransitions } from "@/hooks/useCinematicTransitions";

// Dynamic imports for better performance
const WorksTunnel = dynamic(() => import("@/components/sections/WorksTunnel/WorksTunnel"), {
    loading: () => <div className="min-h-screen" />
});
const FinalCTA = dynamic(() => import("@/components/sections/FinalCTA"));

export default function PortfolioPage() {
    useCinematicTransitions();

    return (
        <main className="flex flex-col w-full min-h-screen">
            <PageHero
                title="Our Work"
                subtitle="A curated selection of our finest digital creations."
            />
            <div className="cinematic-section">
                <WorksTunnel />
            </div>
            <div className="cinematic-section">
                <FinalCTA />
            </div>
        </main>
    );
}



================================================================================
FILE: .\app\portfolio\[slug]\page.tsx
================================================================================

"use client";

import React, { useMemo, useEffect, useState } from "react";
import { useParams, notFound } from "next/navigation";
import Image from "next/image";
import { getProjectBySlug } from "@/data/projects";
import { Instagram, Facebook, Twitter, ExternalLink, Globe, ArrowLeft, Target, ShieldCheck, Zap, Maximize, Share2 } from "lucide-react";
import Link from "next/link";
import { motion, AnimatePresence, useScroll, useTransform } from "framer-motion";

// --- Specialized UI Components for "God Mode" ---

const RevealText = ({ children, delay = 0, className = "" }: { children: React.ReactNode, delay?: number, className?: string }) => (
    <div className={`relative overflow-hidden ${className}`}>
        <motion.div
            initial={{ y: "100%" }}
            animate={{ y: 0 }}
            transition={{ duration: 1, ease: [0.16, 1, 0.3, 1], delay }}
        >
            {children}
        </motion.div>
    </div>
);

const MetaItem = ({ label, value, icon: Icon, delay }: { label: string, value: string, icon: any, delay: number }) => (
    <motion.div
        initial={{ opacity: 0, x: -20 }}
        animate={{ opacity: 1, x: 0 }}
        transition={{ duration: 0.8, delay, ease: "easeOut" }}
        className="group flex items-start gap-3 md:gap-4 p-3 md:p-4 rounded-xl md:rounded-2xl bg-white/[0.02] border border-white/5 hover:bg-white/[0.05] hover:border-purple-500/30 transition-all duration-500"
    >
        <div className="mt-1 p-1.5 md:p-2 bg-purple-500/10 rounded-lg text-purple-400 group-hover:scale-110 group-hover:bg-purple-500/20 transition-all">
            <Icon size={14} className="md:w-4 md:h-4" />
        </div>
        <div>
            <span className="block text-[8px] md:text-[10px] uppercase tracking-[0.2em] md:tracking-[0.3em] text-white/30 mb-1 font-bold">{label}</span>
            <span className="block text-base md:text-lg font-bold tracking-tight text-white/90">{value}</span>
        </div>
    </motion.div>
);

const InteractiveImage = ({ src, alt, priority = false, className = "" }: { src: string, alt: string, priority?: boolean, className?: string }) => (
    <motion.div
        whileHover="hover"
        className={`relative overflow-hidden group/img ${className}`}
    >
        <motion.div
            variants={{
                hover: { scale: 1.05 }
            }}
            transition={{ duration: 1.2, ease: [0.16, 1, 0.3, 1] }}
            className="h-full w-full"
        >
            <Image
                src={src}
                alt={alt}
                fill
                className="object-cover opacity-90 group-hover/img:opacity-100 transition-opacity duration-700"
                priority={priority}
                quality={100}
            />
        </motion.div>
        {/* Shine Overlay */}
        <div className="absolute inset-0 pointer-events-none bg-gradient-to-tr from-purple-500/10 via-transparent to-white/5 opacity-0 group-hover/img:opacity-100 transition-opacity duration-700" />
        {/* Border Glow */}
        <div className="absolute inset-0 border border-white/10 group-hover/img:border-purple-500/30 transition-colors duration-700 rounded-[inherit]" />
    </motion.div>
);

export default function ProjectPage() {
    const params = useParams();
    const slug = params?.slug as string;
    const project = useMemo(() => getProjectBySlug(slug), [slug]);
    const { scrollYProgress } = useScroll();
    const [isMounted, setIsMounted] = useState(false);

    useEffect(() => {
        setIsMounted(true);
        window.scrollTo(0, 0);
    }, []);

    if (!project) {
        notFound();
    }

    const {
        title,
        subtitle,
        description,
        coverImage,
        logo,
        gallery,
        clientName,
        year,
        services,
        links
    } = project;

    // Parallax values for decorative elements
    const y1 = useTransform(scrollYProgress, [0, 1], [0, -200]);
    const y2 = useTransform(scrollYProgress, [0, 1], [0, -400]);

    if (!isMounted) return <div className="min-h-screen bg-black" />;

    return (
        <main className="relative min-h-screen bg-[#020204] text-white selection:bg-purple-500/40 overflow-x-hidden">

            {/* --- Global Decorative Layer --- */}
            <div className="fixed inset-0 pointer-events-none z-0 overflow-hidden">
                <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-soft-light" />
                <motion.div style={{ y: y1 }} className="absolute -top-[10%] -right-[5%] w-[300px] h-[300px] md:w-[800px] md:h-[800px] bg-purple-900/10 rounded-full blur-[80px] md:blur-[150px]" />
                <motion.div style={{ y: y2 }} className="absolute top-[40%] -left-[10%] w-[250px] h-[250px] md:w-[600px] md:h-[600px] bg-indigo-900/10 rounded-full blur-[60px] md:blur-[120px]" />
            </div>

            {/* --- TOP HUD: Navigation & Progress --- */}
            <nav className="fixed top-24 md:top-0 left-0 w-full z-[40] px-6 py-4 md:py-8 flex justify-between items-center pointer-events-none">
                <motion.div
                    initial={{ opacity: 0, x: -50 }}
                    animate={{ opacity: 1, x: 0 }}
                    className="pointer-events-auto"
                >
                    <Link href="/portfolio" className="flex items-center gap-4 group">
                        <div className="w-10 h-10 md:w-12 md:h-12 flex items-center justify-center border border-white/10 rounded-full bg-black/40 backdrop-blur-md group-hover:border-purple-500/50 group-hover:bg-purple-500/10 transition-all duration-500">
                            <ArrowLeft size={18} className="group-hover:-translate-x-1 transition-transform" />
                        </div>
                        <span className="text-[10px] font-black uppercase tracking-[0.4em] hidden md:block">Exit Archive</span>
                    </Link>
                </motion.div>

                <motion.div
                    initial={{ opacity: 0, scale: 0.8 }}
                    animate={{ opacity: 1, scale: 1 }}
                    className="flex items-center gap-6 pointer-events-auto"
                >
                    <button
                        title="Share Project"
                        aria-label="Share Project"
                        className="w-10 h-10 md:w-12 md:h-12 flex items-center justify-center border border-white/10 rounded-full bg-black/40 backdrop-blur-md hover:border-purple-500/50 hover:bg-purple-500/10 transition-all shadow-xl"
                    >
                        <Share2 size={16} className="md:w-[18px] md:h-[18px]" />
                    </button>
                </motion.div>
            </nav>

            <div className="relative z-10 max-w-[1600px] mx-auto pt-32 md:pt-44 pb-32 px-6 md:px-12 lg:px-20">

                {/* --- HERO SECTION --- */}
                <header className="mb-20 lg:mb-40 grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12 items-end">
                    <div className="lg:col-span-8">
                        <motion.div
                            initial={{ width: 0 }}
                            animate={{ width: "80px" }}
                            transition={{ duration: 1.5, ease: [0.16, 1, 0.3, 1] }}
                            className="h-1 bg-purple-500 mb-8 md:mb-10"
                        />
                        <div className="space-y-4">
                            <RevealText delay={0.2} className="text-4xl sm:text-6xl md:text-8xl lg:text-[10rem] font-black brand-font leading-[0.9] md:leading-[0.82] tracking-tighter italic uppercase break-words">
                                {title}
                            </RevealText>
                            {subtitle && (
                                <motion.div
                                    initial={{ opacity: 0, y: 20 }}
                                    animate={{ opacity: 1, y: 0 }}
                                    transition={{ duration: 1, delay: 0.6 }}
                                    className="flex items-center gap-3 md:gap-4 text-purple-400 font-medium font-outfit uppercase tracking-[0.3em] md:tracking-[0.5em] text-xs md:text-xl"
                                >
                                    <div className="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-purple-500 animate-pulse" />
                                    {subtitle}
                                </motion.div>
                            )}
                        </div>
                    </div>

                    {/* Unified Logo Plate */}
                    <div className="lg:col-span-4 flex justify-start lg:justify-end mt-8 lg:mt-0">
                        <motion.div
                            initial={{ opacity: 0, rotate: -10, scale: 0.8 }}
                            animate={{ opacity: 1, rotate: 0, scale: 1 }}
                            transition={{ duration: 1, delay: 0.8, type: "spring" }}
                            className="relative group"
                        >
                            <div className="absolute -inset-4 bg-gradient-to-tr from-purple-500/20 to-indigo-500/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-1000" />
                            <div className="relative w-24 h-24 sm:w-32 sm:h-32 md:w-44 md:h-44 bg-[#0a0a0f] border border-white/10 rounded-[2rem] md:rounded-[2.5rem] p-4 md:p-6 flex items-center justify-center overflow-hidden">
                                {logo ? (
                                    <Image src={logo} alt={`${title} Logo`} width={120} height={120} className="object-contain transition-transform duration-700 group-hover:scale-110" />
                                ) : (
                                    <span className="text-4xl md:text-6xl font-black text-purple-500/40 italic">{title[0]}</span>
                                )}
                                {/* HUD Decorative Lines */}
                                <div className="absolute top-4 left-4 w-4 h-[1px] bg-white/20" />
                                <div className="absolute top-4 left-4 w-[1px] h-4 bg-white/20" />
                                <div className="absolute bottom-4 right-4 w-4 h-[1px] bg-white/20" />
                                <div className="absolute bottom-4 right-4 w-[1px] h-4 bg-white/20" />
                            </div>
                            <motion.div
                                animate={{ rotate: 360 }}
                                transition={{ duration: 20, repeat: Infinity, ease: "linear" }}
                                className="absolute -inset-2 border border-dashed border-white/5 rounded-[2.5rem] md:rounded-[3rem] pointer-events-none"
                            />
                        </motion.div>
                    </div>
                </header>

                <div className="grid grid-cols-1 lg:grid-cols-12 gap-16 lg:gap-32">

                    {/* --- LEFT: Information Hub --- */}
                    <div className="lg:col-span-5 space-y-16 lg:space-y-20">
                        {/* Summary */}
                        <motion.section
                            initial={{ opacity: 0, y: 30 }}
                            whileInView={{ opacity: 1, y: 0 }}
                            viewport={{ once: true }}
                            transition={{ duration: 1 }}
                            className="relative"
                        >
                            <SectionTitle num="01" label="Mission Intel" />
                            <p className="text-lg md:text-3xl text-white/70 leading-relaxed font-light font-sans mt-8 border-l-2 border-purple-500/30 pl-6 md:pl-10 italic">
                                {description}
                            </p>
                        </motion.section>

                        {/* Intelligence Metrics */}
                        <section className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <MetaItem label="Strategic Patron" value={clientName || "Confidential"} icon={ShieldCheck} delay={0.4} />
                            <MetaItem label="Era Released" value={year || "Year Unknown"} icon={Target} delay={0.5} />
                            {services && (
                                <motion.div
                                    initial={{ opacity: 0, y: 20 }}
                                    whileInView={{ opacity: 1, y: 0 }}
                                    viewport={{ once: true }}
                                    transition={{ duration: 0.8, delay: 0.6 }}
                                    className="col-span-full mt-4"
                                >
                                    <span className="text-[10px] uppercase tracking-[0.3em] text-white/30 mb-4 block font-black">Augmented Services</span>
                                    <div className="flex flex-wrap gap-2">
                                        {services.map((s, i) => (
                                            <div key={i} className="px-4 py-2 md:px-6 md:py-2.5 bg-white/5 border border-white/10 rounded-full text-[10px] md:text-xs font-bold hover:bg-purple-500/10 hover:border-purple-500/40 transition-all duration-300 backdrop-blur-md shadow-2xl flex items-center gap-2">
                                                <Zap size={10} className="text-purple-500" />
                                                {s.toUpperCase()}
                                            </div>
                                        ))}
                                    </div>
                                </motion.div>
                            )}
                        </section>

                        {/* Action Command Nexus */}
                        {links && (
                            <motion.div
                                initial={{ opacity: 0, y: 30 }}
                                whileInView={{ opacity: 1, y: 0 }}
                                viewport={{ once: true }}
                                transition={{ duration: 1 }}
                                className="pt-10 flex flex-col sm:flex-row flex-wrap gap-6 md:gap-8 items-center"
                            >
                                {links.website && (
                                    <a
                                        href={links.website}
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="group relative w-full sm:w-auto px-10 py-5 md:px-12 md:py-6 bg-white text-black rounded-2xl font-black text-xs uppercase tracking-[0.25em] overflow-hidden transition-all duration-500 shadow-[0_20px_50px_rgba(255,255,255,0.1)] hover:shadow-[0_20px_70px_rgba(168,85,247,0.4)]"
                                    >
                                        <div className="absolute inset-0 bg-[#020204] translate-y-full group-hover:translate-y-0 transition-transform duration-500 cubic-bezier(0.16, 1, 0.3, 1)" />
                                        <span className="relative z-10 group-hover:text-white transition-colors flex items-center justify-center gap-4">
                                            Initiate Platform <Globe size={18} />
                                        </span>
                                    </a>
                                )}
                                <div className="flex items-center gap-4">
                                    {[
                                        { icon: Instagram, href: links.instagram, label: "Instagram" },
                                        { icon: ExternalLink, href: links.behance, label: "Behance" }
                                    ].map((social, i) => social.href && (
                                        <a
                                            key={i}
                                            href={social.href}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            aria-label={social.label}
                                            className="w-14 h-14 md:w-16 md:h-16 flex items-center justify-center bg-white/5 border border-white/10 rounded-2xl text-white/30 hover:text-purple-400 hover:border-purple-500/50 hover:bg-purple-500/10 transition-all duration-500"
                                        >
                                            <social.icon size={20} />
                                        </a>
                                    ))}
                                </div>
                            </motion.div>
                        )}
                    </div>

                    {/* --- RIGHT: Media Archives --- */}
                    <div className="lg:col-span-7 space-y-12">
                        {/* Hero Image Section */}
                        <motion.div
                            initial={{ opacity: 0, x: 50 }}
                            whileInView={{ opacity: 1, x: 0 }}
                            viewport={{ once: true }}
                            transition={{ duration: 1.2, ease: [0.16, 1, 0.3, 1] }}
                            className="relative group/mainimg"
                        >
                            <SectionTitle num="02" label="Visual Evidence" className="mb-6 md:mb-8" />
                            <div className="relative aspect-[16/10] rounded-[1.5rem] md:rounded-[3rem] overflow-hidden shadow-[0_50px_100px_-20px_rgba(0,0,0,1)] border border-white/10 group-hover/mainimg:border-purple-500/30 transition-colors duration-700">
                                <InteractiveImage
                                    src={coverImage || "/works/placeholder.webp"}
                                    alt={title}
                                    priority
                                    className="h-full w-full"
                                />
                                {/* Bottom HUD Label */}
                                <div className="absolute bottom-4 left-4 md:bottom-8 md:left-8 flex items-center gap-2 md:gap-3 bg-black/60 backdrop-blur-xl border border-white/10 px-3 py-1.5 md:px-4 md:py-2 rounded-lg md:rounded-xl text-[8px] md:text-[10px] font-bold tracking-widest text-white/60">
                                    <Maximize size={10} className="text-purple-500" /> FULL_HD_ARCHIVE_SRC
                                </div>
                            </div>
                        </motion.div>

                        {/* Gallery Mosaic Grid */}
                        {gallery && gallery.length > 0 && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                                {gallery.map((img, i) => (
                                    <motion.div
                                        key={i}
                                        initial={{ opacity: 0, y: 50 }}
                                        whileInView={{ opacity: 1, y: 0 }}
                                        viewport={{ once: true }}
                                        transition={{ duration: 1, delay: i * 0.15, ease: "easeOut" }}
                                        className={`rounded-[1.5rem] md:rounded-[2.5rem] overflow-hidden shadow-2xl ${i % 3 === 0 ? 'md:col-span-2 aspect-[16/8]' : 'aspect-square'}`}
                                    >
                                        <InteractiveImage src={img} alt={`${title} Fragment ${i}`} className="h-full w-full" />
                                    </motion.div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            </div>

            {/* Aesthetic Fine Grain Global */}
            <div className="fixed inset-0 pointer-events-none opacity-[0.2] bg-[url('https://grainy-gradients.vercel.app/noise.svg')] mix-blend-soft-light z-0" />
        </main>
    );
}

// --- Internal Helper Components ---

function SectionTitle({ num, label, className = "" }: { num: string, label: string, className?: string }) {
    return (
        <div className={`flex items-center gap-3 md:gap-4 ${className}`}>
            <span className="text-purple-500 font-black text-xs md:text-sm italic">{num}</span>
            <div className="h-px w-6 md:w-10 bg-purple-500/30" />
            <span className="text-[8px] md:text-[10px] uppercase tracking-[0.3em] md:tracking-[0.4em] font-black text-white/30">{label}</span>
        </div>
    );
}



================================================================================
FILE: .\components\contact\ContactCommandCenter.tsx
================================================================================

"use client";

import React, { useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { 
    Mail, MapPin, Phone, Send, CheckCircle, 
    ArrowRight 
} from "lucide-react";
import { ServiceCard } from "./ServiceCard";
import { services } from "@/data/staticData";

export default function ContactCommandCenter() {
    const [formState, setFormState] = useState({
        name: "",
        email: "",
        service: "",
        message: ""
    });
    const [isSubmitted, setIsSubmitted] = useState(false);
    const [activeField, setActiveField] = useState<string | null>(null);

    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        // Simulate API call
        setTimeout(() => setIsSubmitted(true), 1500);
    };

    const containerVariants = {
        hidden: { opacity: 0 },
        visible: {
            opacity: 1,
            transition: {
                staggerChildren: 0.1
            }
        }
    };

    const itemVariants = {
        hidden: { opacity: 0, y: 30 },
        visible: { opacity: 1, y: 0, transition: { duration: 0.8, ease: [0.16, 1, 0.3, 1] as any } }
    };

    return (
        <div className="w-full relative z-10 flex flex-col justify-center p-6 md:p-12 lg:p-24 xl:p-32 overflow-y-auto min-h-screen">
            
            {/* Scanline Effect on the left side too for consistency */}
            <div className="scan-line opacity-[0.03] pointer-events-none" />

            {/* Header Content */}
            <motion.div 
                initial={{ opacity: 0, y: 40 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ duration: 1, ease: [0.16, 1, 0.3, 1] }}
                className="mb-16 mt-20 lg:mt-0"
            >
                <div className="inline-flex items-center gap-2 px-5 py-2 rounded-full bg-green-500/10 border border-green-500/20 text-green-400 text-[10px] font-mono mb-10 tracking-[0.2em]">
                    <span className="w-2.5 h-2.5 rounded-full bg-green-400 animate-pulse shadow-[0_0_10px_rgba(74,222,128,0.5)]"></span>
                    SYSTEMS READY / ACCEPTING MISSIONS
                </div>
                <h1 className="text-cinematic-xl font-black mb-6 leading-none bg-clip-text text-transparent bg-gradient-to-br from-white via-purple-100 to-white/20">
                    LET'S TALK <br /> <span className="text-purple-500">FUTURE.</span>
                </h1>
                <p className="text-gray-400 max-w-xl leading-relaxed font-light" style={{ fontSize: 'var(--fs-body)' }}>
                    Ready to build something impossible? Fill out the intel below and we'll initiate the launch sequence.
                </p>
            </motion.div>

            <AnimatePresence mode="wait">
                {!isSubmitted ? (
                    <motion.form 
                        key="contact-form"
                        variants={containerVariants}
                        initial="hidden"
                        animate="visible"
                        exit={{ opacity: 0, scale: 0.95 }}
                        onSubmit={handleSubmit}
                        className="space-y-16 max-w-3xl"
                    >
                        {/* 1. Identity Section */}
                        <motion.div variants={itemVariants} className="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div className="relative group">
                                <label className={`text-xs font-mono uppercase tracking-[0.3em] mb-4 block transition-colors ${activeField === 'name' ? 'text-purple-400' : 'text-gray-500'}`}>01. Operator Name</label>
                                <input 
                                    type="text" 
                                    placeholder="Enter your name..."
                                    className="w-full bg-transparent border-b border-white/10 py-4 text-xl md:text-2xl focus:outline-none focus:border-purple-500 transition-all placeholder:text-white/5 font-light"
                                    onFocus={() => setActiveField('name')}
                                    onBlur={() => setActiveField(null)}
                                    value={formState.name}
                                    onChange={(e) => setFormState({...formState, name: e.target.value})}
                                    required
                                />
                                <div className={`absolute bottom-0 left-0 h-[2px] bg-purple-500 transition-all duration-700 ease-out ${activeField === 'name' ? 'w-full' : 'w-0'}`} />
                            </div>
                            <div className="relative group">
                                <label className={`text-xs font-mono uppercase tracking-[0.3em] mb-4 block transition-colors ${activeField === 'email' ? 'text-purple-400' : 'text-gray-500'}`}>02. Comms Channel</label>
                                <input 
                                    type="email" 
                                    placeholder="your@intel.com"
                                    className="w-full bg-transparent border-b border-white/10 py-4 text-xl md:text-2xl focus:outline-none focus:border-purple-500 transition-all placeholder:text-white/5 font-light"
                                    onFocus={() => setActiveField('email')}
                                    onBlur={() => setActiveField(null)}
                                    value={formState.email}
                                    onChange={(e) => setFormState({...formState, email: e.target.value})}
                                    required
                                />
                                <div className={`absolute bottom-0 left-0 h-[2px] bg-purple-500 transition-all duration-700 ease-out ${activeField === 'email' ? 'w-full' : 'w-0'}`} />
                            </div>
                        </motion.div>

                        {/* 2. Service Selection */}
                        <motion.div variants={itemVariants}>
                            <label className="text-xs font-mono uppercase tracking-[0.3em] text-gray-500 mb-8 block font-semibold">03. Select Mission Objective</label>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {services.slice(0, 3).map((s, idx) => (
                                    <ServiceCard 
                                        key={idx} 
                                        {...s} 
                                        selected={formState.service === s.title}
                                        onClick={() => setFormState({...formState, service: s.title})}
                                    />
                                ))}
                            </div>
                        </motion.div>

                        {/* 4. Message */}
                        <motion.div variants={itemVariants} className="relative">
                            <label className={`text-xs font-mono uppercase tracking-[0.3em] mb-6 block transition-colors ${activeField === 'msg' ? 'text-purple-400' : 'text-gray-500'}`}>04. Intelligence Briefing</label>
                            <textarea 
                                rows={5}
                                placeholder="Describe the mission parameters and objectives..."
                                className="w-full bg-white/[0.03] border border-white/10 rounded-2xl p-6 text-lg md:text-xl focus:outline-none focus:border-purple-500 focus:bg-white/[0.06] transition-all placeholder:text-white/5 resize-none shadow-2xl font-light"
                                onFocus={() => setActiveField('msg')}
                                onBlur={() => setActiveField(null)}
                                value={formState.message}
                                onChange={(e) => setFormState({...formState, message: e.target.value})}
                                required
                            />
                        </motion.div>

                        {/* 5. Submit Button */}
                        <motion.button 
                            variants={itemVariants}
                            whileHover={{ scale: 1.02, y: -5 }}
                            whileTap={{ scale: 0.98 }}
                            type="submit"
                            className="group relative w-full py-8 bg-white text-black font-black uppercase tracking-[0.4em] text-xs md:text-sm overflow-hidden rounded-2xl transition-all duration-500 shadow-[0_30px_60px_rgba(255,255,255,0.05)] hover:shadow-purple-500/20"
                        >
                            <div className="absolute inset-0 bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out opacity-10" />
                            <span className="relative z-10 flex items-center justify-center gap-4 transition-all group-hover:gap-8">
                                INITIALIZE MISSION <ArrowRight size={18} className="group-hover:translate-x-2 transition-transform duration-500" />
                            </span>
                        </motion.button>
                    </motion.form>
                ) : (
                    <motion.div 
                        initial={{ scale: 0.9, opacity: 0 }}
                        animate={{ scale: 1, opacity: 1 }}
                        className="bg-purple-500/5 border border-purple-500/10 p-16 md:p-24 rounded-[3rem] text-center max-w-2xl mx-auto relative overflow-hidden backdrop-blur-xl"
                    >
                        <div className="absolute top-0 right-0 w-64 h-64 bg-purple-500/5 blur-[100px] rounded-full" />
                        <div className="w-24 h-24 bg-purple-500 text-black rounded-3xl flex items-center justify-center mx-auto mb-10 rotate-12 shadow-[0_0_60px_rgba(160,160,255,0.3)]">
                            <CheckCircle size={48} />
                        </div>
                        <h3 className="text-4xl md:text-5xl font-black text-white mb-6 tracking-tighter">TRANSMISSION COMPLETE.</h3>
                        <p className="text-gray-400 text-xl md:text-2xl leading-relaxed mb-12 font-light">
                            Our strategic team is analyzing your intel. Expect contact within 24 hours. Stand by.
                        </p>
                        <button 
                            onClick={() => setIsSubmitted(false)}
                            className="px-10 py-4 rounded-full border border-purple-500/20 text-purple-400 text-xs font-mono tracking-[0.3em] hover:bg-purple-500 hover:text-white transition-all uppercase"
                        >
                            INITIATE NEW TRANSMISSION
                        </button>
                    </motion.div>
                )}
            </AnimatePresence>


            {/* Footer / Status Bars */}
            <div className="mt-24 flex flex-wrap gap-x-16 gap-y-8 text-[12px] text-gray-500 font-mono border-t border-white/5 pt-16 uppercase tracking-[0.3em]">
                <div className="flex items-center gap-4 hover:text-purple-400 transition-all duration-500 cursor-pointer group">
                    <div className="p-3 rounded-xl bg-white/5 group-hover:bg-purple-500/10 transition-colors border border-white/5 group-hover:border-purple-500/20">
                        <Mail size={16} />
                    </div>
                    hello@inkspire.agency
                </div>
                <div className="flex items-center gap-4 hover:text-purple-400 transition-all duration-500 cursor-pointer group">
                    <div className="p-3 rounded-xl bg-white/5 group-hover:bg-purple-500/10 transition-colors border border-white/5 group-hover:border-purple-500/20">
                        <MapPin size={16} />
                    </div>
                    GLOBAL / AMMAN
                </div>
                <div className="flex items-center gap-4 hover:text-purple-400 transition-all duration-500 cursor-pointer group">
                    <div className="p-3 rounded-xl bg-white/5 group-hover:bg-purple-500/10 transition-colors border border-white/5 group-hover:border-purple-500/20">
                        <Phone size={16} />
                    </div>
                    +962 779 667 168
                </div>
            </div>
        </div>
    );
}




================================================================================
FILE: .\components\contact\ParticleGlobeScene.tsx
================================================================================

"use client";

import React, { useState, useRef, Suspense } from "react";
import { Canvas, useFrame } from "@react-three/fiber";
import { Points, PointMaterial, Float } from "@react-three/drei";
import * as THREE from "three";

function ParticleGlobe(props: any) {
    const ref = useRef<any>();
    const outerRef = useRef<any>();

    // Generate random points on a sphere natively to avoid build/import issues
    const [sphere] = useState(() => {
        const points = new Float32Array(5000 * 3);
        const radius = 1.2;
        for (let i = 0; i < 5000; i++) {
            const r = radius; // Surface of sphere
            const theta = Math.random() * 2 * Math.PI;
            const phi = Math.acos(2 * Math.random() - 1);
            points[i * 3] = r * Math.sin(phi) * Math.cos(theta);
            points[i * 3 + 1] = r * Math.sin(phi) * Math.sin(theta);
            points[i * 3 + 2] = r * Math.cos(phi);
        }
        return points;
    });

    // Generate loose outer particles
    const [outerPoints] = useState(() => {
        const points = new Float32Array(500 * 3);
        for (let i = 0; i < 500 * 3; i++) {
            points[i] = (Math.random() - 0.5) * 5;
        }
        return points;
    });

    useFrame((state, delta) => {
        if (ref.current) {
            ref.current.rotation.y += delta / 10;
            ref.current.rotation.x += delta / 20;
        }
        if (outerRef.current) {
            outerRef.current.rotation.y -= delta / 15;
        }
    });

    return (
        <group>
            <Points ref={ref} positions={sphere} stride={3} frustumCulled={false} {...props}>
                <PointMaterial
                    transparent
                    color="#f2e9ff"
                    size={0.008}
                    sizeAttenuation={true}
                    depthWrite={false}
                    opacity={0.6}
                />
            </Points>
            <Points ref={outerRef} positions={outerPoints} stride={3} frustumCulled={false}>
                <PointMaterial
                    transparent
                    color="#ffffff"
                    size={0.01}
                    sizeAttenuation={true}
                    depthWrite={false}
                    opacity={0.2}
                />
            </Points>
        </group>
    );
}

export default function ParticleGlobeScene() {
    return (
        <div className="w-full h-full relative group">
            <Canvas 
                camera={{ position: [0, 0, 2.5] }} 
                dpr={[1, 1.5]}
                frameloop="always" // We'll keep always but cap it or use visibility
                onCreated={(state) => {
                    state.scene.fog = new THREE.FogExp2(0x09060f, 0.3);
                }}
            >
                <Suspense fallback={null}>
                    <Float
                        speed={1} 
                        rotationIntensity={0.2} 
                        floatIntensity={0.5} 
                    >
                        <ParticleGlobe />
                    </Float>
                </Suspense>
            </Canvas>
            
            {/* Ambient Background Glow - Matches NineDimensions indigo/purple */}
            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[-1] pointer-events-none">
                 <div className="w-[800px] h-[800px] bg-purple-600/[0.03] rounded-full blur-[150px] animate-pulse" />
            </div>
            
            {/* Cinematic Gradient Overlay - blends into the site's radial gradient */}
            <div className="absolute inset-0 bg-gradient-to-l from-transparent via-[#09060f]/40 to-[#09060f] pointer-events-none" />
            
            {/* Scanline Effect */}
            <div className="scan-line opacity-[0.15]" />
        </div>
    );
}





================================================================================
FILE: .\components\contact\ServiceCard.tsx
================================================================================

"use client";

import React from "react";
import * as LucideIcons from "lucide-react";
import { CheckCircle } from "lucide-react";

interface ServiceCardProps {
    icon: string;
    title: string;
    desc?: string;
    selected: boolean;
    onClick: () => void;
}

const iconMap: Record<string, any> = {
    Fingerprint: LucideIcons.Fingerprint,
    Clapperboard: LucideIcons.Clapperboard,
    Laptop: LucideIcons.Laptop,
    CalendarCheck: LucideIcons.CalendarCheck,
    PenTool: LucideIcons.PenTool,
    Megaphone: LucideIcons.Megaphone,
};

export const ServiceCard = ({ icon, title, desc, selected, onClick }: ServiceCardProps) => {
    const Icon = iconMap[icon] || CheckCircle;

    return (
        <div
            onClick={onClick}
            className={`relative cursor-pointer group p-6 rounded-2xl border transition-all duration-500 ${
                selected 
                ? "bg-purple-500/20 border-purple-400/50 shadow-[0_0_50px_rgba(160,160,255,0.2)] scale-[1.03]" 
                : "bg-white/[0.03] border-white/10 hover:bg-white/[0.08] hover:border-white/20 hover:scale-[1.02]"
            }`}
        >
            <div className={`absolute top-4 right-4 w-6 h-6 rounded-full border flex items-center justify-center transition-all duration-500 ${
                selected ? "border-purple-400 bg-purple-400 scale-100 rotate-0" : "border-white/20 scale-50 opacity-0 group-hover:opacity-100 -rotate-90"
            }`}>
                {selected && <CheckCircle size={14} className="text-black" />}
            </div>
            
            <div className={`mb-5 p-3 rounded-xl inline-block transition-all duration-500 ${selected ? "bg-purple-500/30 text-purple-300 scale-110" : "bg-white/5 text-gray-500 group-hover:text-white group-hover:rotate-12"}`}>
                <Icon size={28} />
            </div>

            <h4 className={`text-base md:text-lg font-bold tracking-tight mb-2 ${selected ? "text-white" : "text-gray-400 transition-colors group-hover:text-white"}`}>{title}</h4>
            
            {desc && (
                <p className={`text-[11px] leading-snug transition-opacity duration-500 font-light ${selected ? "text-purple-200/60" : "text-gray-600 group-hover:text-gray-400"}`}>
                    {desc.split('.')[0]}.
                </p>
            )}
        </div>
    );
};



================================================================================
FILE: .\components\hero\CinematicRevealGrid.tsx
================================================================================

"use client";

import Image from "next/image";
import { useCinematicReveal } from "@/hooks/useCinematicReveal";
import "@/styles/cinematic-reveal.css";

// Using the same 4 image pairs. 
// If the user wants "More images", they likely need to duplicate them or provide more.
// I will duplicate them to fill the grid nicely if it's wide, but sticking to 4 columns implies 4 images.
// The user said "images more" (photo akther), maybe meaning quantity or quality?
// "photo akther" = more photos?
// Reference HTML has 4 stacks.
// Current implementation has 4 stacks.
// If I add more, I need to adjust grid?
// I'll stick to 4 for now to match the "feature parity" request of the logic, 
// but ensure they look "more" (larger/fuller) by removing gaps.

const STACKS = [
    { id: 1, base: "/hero/be 1.webp", overlay: "/hero/af 1.webp", alt: "Cinematic Reveal 1" },
    { id: 2, base: "/hero/be 2.webp", overlay: "/hero/af 2.webp", alt: "Cinematic Reveal 2" },
    { id: 3, base: "/hero/be 3.webp", overlay: "/hero/af 3.webp", alt: "Cinematic Reveal 3" },
    { id: 4, base: "/hero/be 4.webp", overlay: "/hero/af 4.webp", alt: "Cinematic Reveal 4" },
];

export default function CinematicRevealGrid() {
    const { isTouch, containerRef, setStackRef } = useCinematicReveal();

    return (
        <div
            ref={containerRef}
            className={`re-reveal-container ${isTouch ? 'is-touch' : ''}`}
        >
            {/* Global Atmosphere Layers */}
            <div className="re-grain" />
            <div className="re-dim-layer" />
            <div className="re-spotlight" />

            {/* Seamless Grid */}
            <div className="re-stacks-grid">
                {STACKS.map((stack, index) => (
                    <div
                        key={stack.id}
                        className={`re-stack ${(index === 1 || index === 2) ? 're-stack-lifted' : ''}`}
                        ref={(el) => setStackRef(el, index)}
                    >
                        {/* Base Image */}
                        <Image
                            src={stack.base}
                            alt={stack.alt}
                            fill
                            priority={index === 0} // Only first image as priority for LCP
                            quality={85} // Optimized quality
                            className="re-stack-image re-stack-base"
                            sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 25vw"
                        />

                        {/* Overlay Image (Revealed) - HIDDEN ON MOBILE */}
                        {!isTouch && (
                            <div className="re-stack-overlay absolute inset-0 w-full h-full">
                                <Image
                                    src={stack.overlay}
                                    alt={stack.alt}
                                    fill
                                    quality={80} // Overlay needs less quality
                                      loading="lazy"
                                    className="re-stack-image"
                                    sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 25vw"
                                />
                            </div>
                        )}
                    </div>
                ))}
            </div>
        </div>
    );
}



================================================================================
FILE: .\components\hero\HeroScene.tsx
================================================================================

"use client";

import { useRef } from "react";
import Image from "next/image";
import { siteContent } from "@/data/siteContent";
import { useHeroAnimation } from "@/hooks/useHeroAnimation";
import CinematicRevealGrid from "./CinematicRevealGrid";
import { motion } from "framer-motion";
import TypewriterText from "@/components/ui/TypewriterText";

export default function HeroScene() {
    const containerRef = useRef<HTMLElement>(null);
    const titleRef = useRef<HTMLDivElement>(null);
    const ctaRef = useRef<HTMLAnchorElement>(null);
    const scrollLabelRef = useRef<HTMLDivElement>(null);

    // Use the custom hook for animations
    useHeroAnimation(containerRef, titleRef, ctaRef, scrollLabelRef);

    // Safari detection for performance optimization
    const isSafari = typeof navigator !== 'undefined' && 
                     /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

    return (
        <section 
            ref={containerRef}
            id="home"
            className="relative min-h-[100svh] flex flex-col justify-end items-center pt-[4.5rem] pb-16 md:pb-24 lg:pb-32 overflow-hidden scroll-mt-24"
            style={{ paddingLeft: 'var(--container-padding)', paddingRight: 'var(--container-padding)' }}
        >
            {/* Tablet-only readability veil background */}
            <div className="absolute inset-x-0 bottom-0 h-[55vh] md:h-[45vh] tablet-text-veil pointer-events-none z-20 md:block lg:hidden hidden" />

            {/* 1. Images Row - Background Everywhere */}
            <div className="absolute inset-0 w-full h-full overflow-visible pointer-events-none z-10">
                <CinematicRevealGrid />
            </div>

            {/* Main Title Container with Glassmorphism - Positioned above CTA */}
            <div ref={titleRef} className="relative z-30 flex flex-col items-center text-center max-w-[95vw] md:max-w-7xl mx-auto mb-4 md:mb-6 translate-y-8 md:translate-y-12">
                {/* Premium Clean Glass Capsule (No Blur) - Visual depth via layered transparency */}
                <div className="relative px-8 py-8 md:px-12 md:py-10 rounded-full overflow-hidden w-full"
                     style={{ 
                         background: `
                            linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)),
                            linear-gradient(180deg, rgba(167,139,250,0.08), rgba(109,40,217,0.04))
                         `,
                         boxShadow: `
                            inset 0 0 0 1px rgba(255,255,255,0.12),
                            0 20px 60px rgba(0,0,0,0.35)
                         `,
                         transition: 'all 0.5s ease'
                     }}
                >
                    {/* Atmospheric Glow inside glass - Clean & subtle */}
                    <div className="absolute -top-1/2 -left-1/2 w-full h-full bg-indigo-500/5 blur-[100px] pointer-events-none" />
                    <div className="absolute -bottom-1/2 -right-1/2 w-full h-full bg-purple-500/5 blur-[100px] pointer-events-none" />

                    {/* Main Heading - Clean White */}
                    <h1 className="hero-tagline relative z-10 font-black leading-[1.3] drop-shadow-lg text-balance tracking-tighter uppercase text-white"
                        style={{ fontSize: 'var(--fs-h3)' }}
                    >
                        <TypewriterText 
                            text="From ink we started, to make people Inkspired." 
                            speed={35}
                            delay={1500}
                        />
                    </h1>
                </div>

                {/* Elite CTA Button - Positioned near bottom */}
                <a
                    ref={ctaRef}
                    href={siteContent.hero.primaryCtaHref}
                    className="group relative mt-3 md:mt-4 block interactive z-[60]" 
                >
                    <div className="elite-cta-glow !bg-white/10 !blur-[30px] opacity-0 group-hover:opacity-100 transition-opacity duration-700" />

                    <div className="conic-border-wrap shadow-[0_0_50px_rgba(255,255,255,0.1)] !p-[1.5px] bg-gradient-to-r from-transparent via-white/30 to-transparent">
                        <div 
                            className="relative flex items-center gap-4 md:gap-6 px-10 py-5 md:px-16 md:py-8 bg-[#ffffff]/05 rounded-full border border-white/20 group-hover:bg-white/10 transition-all duration-700 overflow-hidden will-change-transform"
                            style={{ 
                                backgroundImage: 'linear-gradient(to bottom, rgba(255,255,255,0.08), transparent)',
                                backdropFilter: 'blur(6px)',
                                WebkitBackdropFilter: 'blur(6px)',
                                transform: 'translateZ(0)'
                            }}
                        >
                            <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-in-out" />

                            <span className="relative text-white font-black uppercase tracking-[0.3em] group-hover:tracking-[0.4em] transition-all duration-700 italic"
                                  style={{ fontSize: 'var(--fs-sm)' }}
                            >
                                {siteContent.hero.primaryCtaLabel}
                            </span>

                            <div className="relative flex items-center justify-center w-8 h-8 md:w-12 md:h-12 rounded-full bg-white/10 border border-white/20 group-hover:bg-white group-hover:scale-110 group-hover:rotate-45 transition-all duration-500 shadow-xl">
                                <svg 
                                    viewBox="0 0 24 24" 
                                    className="w-4 h-4 md:w-6 md:h-6 text-white group-hover:text-black transition-colors"
                                    fill="none" 
                                    stroke="currentColor" 
                                    strokeWidth="3.5"
                                >
                                    <path d="M7 17L17 7M17 7H7M17 7V17" strokeLinecap="round" strokeLinejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    {/* 4. Floating Reflection Layer */}
                    <div className="absolute inset-x-10 -bottom-2 h-[2px] bg-gradient-to-r from-transparent via-white/60 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-700 blur-[2px] group-hover:blur-none" />
                </a>
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\hero\PageHero.tsx
================================================================================

"use client";

import { useEffect, useRef } from "react";
import gsap from "gsap";

interface PageHeroProps {
    title: string;
    subtitle: string;
}

export default function PageHero({ title, subtitle }: PageHeroProps) {
    const containerRef = useRef<HTMLDivElement>(null);
    const titleRef = useRef<HTMLHeadingElement>(null);
    const subtitleRef = useRef<HTMLParagraphElement>(null);

    useEffect(() => {
        const ctx = gsap.context(() => {
            const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

            tl.from(titleRef.current, {
                y: 50,
                opacity: 0,
                duration: 1,
            });

            tl.from(subtitleRef.current, {
                y: 30,
                opacity: 0,
                duration: 0.8,
            }, "-=0.6");

        }, containerRef);

        return () => ctx.revert();
    }, []);

    return (
        <section
            ref={containerRef}
            className="cinematic-section relative h-[60vh] flex flex-col justify-center items-center px-6 overflow-hidden pt-20"
        >
            {/* Background Gradient */}
            <div className="absolute inset-0 bg-gradient-to-b from-purple-900/20 to-black z-0" />

            {/* Content */}
            <div className="relative z-10 text-center max-w-4xl parallax-content">
                <h1 ref={titleRef} className="text-5xl md:text-7xl lg:text-8xl font-black tracking-tighter mb-6">
                    <span className="animated-gradient-text">
                        {title}
                    </span>
                </h1>
                <p ref={subtitleRef} className="text-lg md:text-xl text-white/80 font-light max-w-2xl mx-auto">
                    {subtitle}
                </p>
            </div>

            <style jsx>{`
                @keyframes gradientShift {
                    0% { background-position: 0% 50%; }
                    50% { background-position: 100% 50%; }
                    100% { background-position: 0% 50%; }
                }

                .animated-gradient-text {
                    background: linear-gradient(
                        90deg,
                        #ffffff,
                        #f2e9ff,
                        #6b4092,
                        #404f96,
                        #f2e9ff,
                        #ffffff
                    );
                    background-size: 300% 300%;
                    background-clip: text;
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    animation: gradientShift 8s ease infinite;
                }
            `}</style>
        </section>
    );
}



================================================================================
FILE: .\components\layout\MotionLayout.tsx
================================================================================

"use client";

import { usePathname } from "next/navigation";
import { useEffect, useRef } from "react";
import gsap from "gsap";

export default function MotionLayout({ children }: { children: React.ReactNode }) {
    const pathname = usePathname();
    const wrapperRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        if (!wrapperRef.current) return;

        // Simple fade in animation on route change
        gsap.fromTo(
            wrapperRef.current,
            { opacity: 0, y: 20 },
            { opacity: 1, y: 0, duration: 0.5, ease: "power2.out" }
        );
    }, [pathname]);

    return (
        <div ref={wrapperRef} data-page className="min-h-[100dvh]">
            {children}
        </div>
    );
}



================================================================================
FILE: .\components\layout\NavbarFullMenu.tsx
================================================================================

"use client";

import { useState, useEffect, useRef } from "react";
import Link from "next/link";
import Image from "next/image";
import gsap from "gsap";
import { siteContent } from "@/data/siteContent";

export default function NavbarFullMenu() {
    const [isOpen, setIsOpen] = useState(false);
    const menuRef = useRef<HTMLDivElement>(null);
    const linksRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        if (isOpen) {
            // Prevent body scroll when menu is open
            document.body.style.overflow = "hidden";

            gsap.to(menuRef.current, {
                opacity: 1,
                pointerEvents: "all",
                duration: 0.5,
                ease: "power2.out",
            });

            const links = linksRef.current?.children;
            if (links) {
                gsap.fromTo(
                    links,
                    { y: 50, opacity: 0 },
                    {
                        y: 0,
                        opacity: 1,
                        duration: 0.5,
                        stagger: 0.1,
                        delay: 0.2,
                        ease: "power2.out",
                    }
                );
            }
        } else {
            // Re-enable body scroll when menu closes
            document.body.style.overflow = "";

            gsap.to(menuRef.current, {
                opacity: 0,
                pointerEvents: "none",
                duration: 0.5,
                ease: "power2.in",
            });
        }
    }, [isOpen]);

    const handleLinkClick = (href: string) => {
        setIsOpen(false);

        // Smooth scroll to section if it's an anchor link
        if (href.includes("#")) {
            const targetId = href.split("#")[1];
            setTimeout(() => {
                const element = document.getElementById(targetId);
                if (element) {
                    element.scrollIntoView({ behavior: "smooth", block: "start" });
                }
            }, 500); // Wait for menu close animation
        }
    };

    return (
        <>
            {/* Top Navbar - Always visible */}
            <nav className="fixed top-0 left-0 w-full z-50 px-6 py-6 flex justify-between items-center">
<div className="absolute inset-0 bg-transparent" />

                <Link
                    href="/"
                    className="relative z-10 interactive hover:brightness-125 transition-all"
                >
                    <Image
                        src="/logos/Inkspire logos/Untitled-2-03.webp"
                        alt="Inkspire"
                        width={180}
                        height={60}
                        className="w-auto h-10 md:h-14 object-contain"
                    />
                </Link>

                <button
                    onClick={() => setIsOpen(true)}
                    className="relative z-10 text-sm font-medium uppercase tracking-widest text-white hover:text-inkspirePurple transition-all interactive"
                >
                    Menu
                </button>
            </nav>

            {/* Fullscreen Menu Overlay */}
            <div
                ref={menuRef}
                className="fixed inset-0 z-[100] bg-gradient-to-br from-inkspirePurple to-inkspireIndigo opacity-0 pointer-events-none flex flex-col items-center justify-center"
            >
                {/* Close Button */}
                <button
                    onClick={() => setIsOpen(false)}
                    className="absolute top-6 right-6 text-white text-sm font-medium uppercase tracking-widest hover:scale-110 transition-all interactive group"
                >
                    <span className="mr-2"></span>
                    Close
                </button>

                {/* Menu Links */}
                <div ref={linksRef} className="flex flex-col items-center gap-6 md:gap-8">
                    {siteContent.navigation.menuItems.map((item) => (
                        <Link
                            key={item.label}
                            href={item.href}
                            onClick={() => handleLinkClick(item.href)}
                            className="text-4xl sm:text-5xl md:text-7xl font-bold text-white hover:text-white/70 transition-all interactive relative group"
                        >
                            {item.label}
                            <span className="absolute -bottom-2 left-0 w-0 h-1 bg-white group-hover:w-full transition-all duration-300" />
                        </Link>
                    ))}
                </div>

                {/* Footer text */}
                <div className="absolute bottom-6 text-white/50 text-sm">
                    {siteContent.global.footerText}
                </div>
            </div>
        </>
    );
}



================================================================================
FILE: .\components\layout\ResponsiveSection.tsx
================================================================================

"use client";

import React, { forwardRef } from "react";
import { motion, type Variants } from "framer-motion";
import { useNativeScroll } from "@/hooks/useNativeScroll";
import { useResponsiveMode, type ScrollMode } from "@/hooks/useResponsiveMode";

// ============================================================================
// TYPES
// ============================================================================
interface ResponsiveSectionProps {
  /** Section content */
  children: React.ReactNode;
  /** Additional CSS classes */
  className?: string;
  /** Section ID for navigation */
  id?: string;
  /** Override scroll mode for this section */
  scrollModeOverride?: ScrollMode;
  /** Disable animations for this section */
  disableAnimation?: boolean;
  /** Custom animation variants */
  animationVariants?: Variants;
}

// ============================================================================
// DEFAULT ANIMATION VARIANTS
// ============================================================================
const defaultVariants = {
  hidden: {
    opacity: 0,
    y: 30,
  },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.6,
      ease: [0.25, 0.1, 0.25, 1],
    },
  },
};

// Reduced motion variants (immediate, no animation)
const reducedMotionVariants = {
  hidden: { opacity: 1, y: 0 },
  visible: { opacity: 1, y: 0 },
};

// ============================================================================
// THE COMPONENT
// ============================================================================
/**
 * Wrapper component for consistent responsive section behavior.
 * 
 * Features:
 * - Uses 100svh for proper mobile viewport handling
 * - Safe-area padding support for notched devices
 * - In-view animations for native scroll mode
 * - Respects prefersReducedMotion
 */
const ResponsiveSection = forwardRef<HTMLElement, ResponsiveSectionProps>(
  (
    {
      children,
      className = "",
      id,
      scrollModeOverride,
      disableAnimation = false,
      animationVariants,
    },
    forwardedRef
  ) => {
    const { scrollMode, prefersReducedMotion } = useResponsiveMode();
    const { ref: inViewRef, inView } = useNativeScroll({
      threshold: 0.15,
      triggerOnce: true,
      rootMargin: "-10% 0px",
    });

    const activeScrollMode = scrollModeOverride ?? scrollMode;
    const shouldAnimate =
      !disableAnimation &&
      !prefersReducedMotion &&
      activeScrollMode === "native";

    // Choose animation variants
    const variants = prefersReducedMotion
      ? reducedMotionVariants
      : animationVariants ?? defaultVariants;

    // Combine refs
    const setRef = (element: HTMLElement | null) => {
      // Update inViewRef
      (inViewRef as React.MutableRefObject<HTMLElement | null>).current = element;
      
      // Update forwarded ref
      if (typeof forwardedRef === "function") {
        forwardedRef(element);
      } else if (forwardedRef) {
        forwardedRef.current = element;
      }
    };

    // Base classes for proper responsive height
    const baseClasses = [
      "w-full",
      "relative",
      // Use svh for proper mobile viewport (accounts for browser chrome)
      "min-h-[100svh]",
      // Safe area padding for notched devices
      "pb-[env(safe-area-inset-bottom)]",
      // Flex container for content centering
      "flex",
      "flex-col",
    ].join(" ");

    // Cinematic mode: No in-view animation (handled by page transitions)
    if (activeScrollMode === "cinematic" || !shouldAnimate) {
      return (
        <section
          ref={setRef}
          id={id}
          className={`${baseClasses} ${className}`}
        >
          {children}
        </section>
      );
    }

    // Native mode: Use Framer Motion for in-view animations
    return (
      <motion.section
        ref={setRef}
        id={id}
        className={`${baseClasses} ${className}`}
        initial="hidden"
        animate={inView.hasBeenInView ? "visible" : "hidden"}
        variants={variants}
      >
        {children}
      </motion.section>
    );
  }
);

ResponsiveSection.displayName = "ResponsiveSection";

export default ResponsiveSection;

// ============================================================================
// UTILITY: Section content wrapper for inner padding
// ============================================================================
interface SectionContentProps {
  children: React.ReactNode;
  className?: string;
  /** Center content vertically */
  centered?: boolean;
}

export function SectionContent({
  children,
  className = "",
  centered = false,
}: SectionContentProps) {
  return (
    <div
      className={`
        w-full
        max-w-7xl
        mx-auto
        px-[var(--container-padding)]
        ${centered ? "flex-1 flex flex-col justify-center" : "flex flex-col justify-start"}
        ${className}
      `}
    >
      {children}
    </div>
  );
}



================================================================================
FILE: .\components\layout\SmoothScroll.tsx
================================================================================

"use client";

import { useCinematicScroll } from "@/hooks/useCinematicScroll";

/**
 * SmoothScroll component - Simplified wrapper around useCinematicScroll.
 * 
 * This component delegates all scroll management to the useCinematicScroll hook,
 * which handles:
 * - SSR-safe initialization
 * - Lenis + GSAP ScrollTrigger integration
 * - Aggressive cleanup on mode switch
 * - Page visibility gating
 * - Excluded paths (/, /experience)
 * 
 * The hook internally uses useResponsiveMode to determine when to activate
 * cinematic scroll vs falling back to native scroll.
 */
export default function SmoothScroll({ children }: { children: React.ReactNode }) {
  // The hook handles all the logic:
  // - Initializes Lenis only when scrollMode === 'cinematic'
  // - Excludes paths that handle their own navigation
  // - Cleans up aggressively on mode changes
  useCinematicScroll({
    excludePaths: ["/", "/experience"],
  });

  return <>{children}</>;
}



================================================================================
FILE: .\components\nine-dimensions\NineDimensionsBackground.tsx
================================================================================

"use client";

import { useEffect, useRef, useMemo, useCallback } from "react";
import * as THREE from "three";
import gsap from "gsap";
import { usePageVisibility } from "@/hooks/usePageVisibility";
import { useResponsiveMode } from "@/hooks/useResponsiveMode";

// ============================================================================
// TYPES
// ============================================================================
interface NineDimensionsBackgroundProps {
  targetShapeIndex: number;
  /** Lite mode for tablets: reduced particles, no post-fx */
  lite?: boolean;
}

// ============================================================================
// PALETTE CONSTANTS
// ============================================================================
const BG_BASE = "#09060f";
const BG_DEEP = "#0d0e22";
const BG_ACCENT = "#201037";

// ============================================================================
// PERFORMANCE PROFILES
// Now uses useResponsiveMode instead of window.innerWidth checks
// ============================================================================
interface PerformanceProfile {
  mode: "mobile" | "tablet" | "desktop";
  count: number;
  pixelRatio: number;
  postFX: boolean;
}

const PROFILES: Record<string, PerformanceProfile> = {
  desktop: { mode: "desktop", count: 1800, pixelRatio: 1.5, postFX: true },
  tablet: { mode: "tablet", count: 1200, pixelRatio: 1.0, postFX: false },
  mobile: { mode: "mobile", count: 600, pixelRatio: 1.0, postFX: false },
  reducedMotion: { mode: "mobile", count: 400, pixelRatio: 1.0, postFX: false },
  lite: { mode: "tablet", count: 800, pixelRatio: 1.0, postFX: false },
};

// ============================================================================
// SHADERS
// ============================================================================
const vertexShader = `
    uniform float uTime;
    uniform float uProgress;
    attribute float aInstanceIdx;
    attribute vec3 aPosStart;
    attribute vec3 aPosEnd;

    varying vec3 vColor;
    varying float vOpacity;

    void main() {
        // 1. Interpolate between shapes
        vec3 morphedPos = mix(aPosStart, aPosEnd, uProgress);
        
        // 2. Add dynamic movement - CINEMATIC DRIFT (slower, more subtle)
        float variance = 1.0 + mod(aInstanceIdx, 10.0) * 0.08;
        float noise = sin(uTime * variance * 0.5 + aInstanceIdx) * 0.5;
        float drift = cos(uTime * 0.15 + aInstanceIdx) * 0.25;
        
        vec3 finalOffset = vec3(noise, noise + drift, drift * 0.8);
        
        // 3. Subtle Pulse Scaling (reduced amplitude)
        float pulse = 1.0 + sin(uTime * 2.0 + aInstanceIdx) * 0.15;
        
        // 4. Combine
        vec3 instanceCenter = morphedPos + finalOffset;
        vec3 scaledVertex = position * pulse;
        
        // Transform
        vec4 mvPosition = modelViewMatrix * instanceMatrix * vec4(instanceCenter + scaledVertex, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        
        vColor = instanceColor;
        
        // Distance based opacity (depth feel) - REDUCED RANGE for subtlety (0.15-0.55)
        float depth = length(mvPosition.xyz);
        vOpacity = clamp(1.0 - (depth / 500.0), 0.15, 0.55);
    }
`;

const fragmentShader = `
    varying vec3 vColor;
    varying float vOpacity;

    void main() {
        // ULTRA-CLEAN CINEMATIC ALPHA (0.15 -> 0.45 range controlled by vOpacity)
        gl_FragColor = vec4(vColor, vOpacity * 0.4);
    }
`;

// ============================================================================
// THE COMPONENT
// ============================================================================
/**
 * NineDimensionsBackground - Three.js particle system background.
 * 
 * Features:
 * - SSR-safe: Uses useResponsiveMode for profile selection
 * - Demand rendering: Stops RAF loop when not visible or page inactive
 * - Lite mode: Reduced particles for capable tablets
 * - Visibility gating: IntersectionObserver pauses when off-screen
 * - Proper cleanup: Disposes all Three.js resources
 */
export default function NineDimensionsBackground({
  targetShapeIndex,
  lite = false,
}: NineDimensionsBackgroundProps) {
  const containerRef = useRef<HTMLDivElement>(null);
  const isPageActive = usePageVisibility();
  const { breakpoint, prefersReducedMotion } = useResponsiveMode();

  // Determine profile based on responsive mode
  const profile = useMemo((): PerformanceProfile => {
    if (prefersReducedMotion) return PROFILES.reducedMotion;
    if (lite) return PROFILES.lite;
    return PROFILES[breakpoint] || PROFILES.desktop;
  }, [breakpoint, prefersReducedMotion, lite]);

  // Refs for Three.js objects
  const rendererRef = useRef<THREE.WebGLRenderer | null>(null);
  const sceneRef = useRef<THREE.Scene | null>(null);
  const cameraRef = useRef<THREE.PerspectiveCamera | null>(null);
  const meshRef = useRef<THREE.InstancedMesh | null>(null);
  const materialRef = useRef<THREE.ShaderMaterial | null>(null);
  const geometryRef = useRef<THREE.InstancedBufferGeometry | null>(null);
  const baseGeoRef = useRef<THREE.SphereGeometry | null>(null);
  const reqIdRef = useRef<number | null>(null);
  const gsapCtxRef = useRef<gsap.Context | null>(null);

  // State management
  const isVisible = useRef(true);
  const currentShapeIndexRef = useRef(0);
  const targetShapeIndexRef = useRef(0);
  const animParams = useRef({ progress: 0 });

  // ============================================================================
  // PRE-CALCULATE SHAPES
  // ============================================================================
  const shapes = useMemo(() => {
    const count = profile.count;
    const result: Float32Array[] = [];

    for (let s = 0; s < 9; s++) {
      const data = new Float32Array(count * 3);
      for (let i = 0; i < count; i++) {
        let x = 0,
          y = 0,
          z = 0;
        switch (s) {
          case 0: // Genesis (Chaos)
            x = (Math.random() - 0.5) * 400;
            y = (Math.random() - 0.5) * 300;
            z = (Math.random() - 0.5) * 200;
            break;
          case 1: // Tunnel
            const r = 30 + Math.random() * 10;
            const theta = Math.random() * Math.PI * 2;
            x = Math.cos(theta) * r;
            y = Math.sin(theta) * r;
            z = (Math.random() - 0.5) * 400;
            break;
          case 2: // Sphere
            const radius = 60;
            const phi = Math.acos(-1 + (2 * i) / count);
            const thetaSphere = Math.sqrt(count * Math.PI) * phi;
            x = radius * Math.cos(thetaSphere) * Math.sin(phi);
            y = radius * Math.sin(thetaSphere) * Math.sin(phi);
            z = radius * Math.cos(phi);
            break;
          case 3: // Cube
            const size = 80;
            x = (Math.random() - 0.5) * size;
            y = (Math.random() - 0.5) * size;
            z = (Math.random() - 0.5) * size;
            if (Math.random() > 0.5) {
              const axis = Math.floor(Math.random() * 3);
              if (axis === 0) x = Math.sign(x) * (size / 2);
              if (axis === 1) y = Math.sign(y) * (size / 2);
              if (axis === 2) z = Math.sign(z) * (size / 2);
            }
            break;
          case 4: // Helix
            const t = (i / count) * Math.PI * 20;
            x = Math.cos(t) * 20;
            y = (i / count - 0.5) * 200;
            z = Math.sin(t) * 20;
            if (i % 2 === 0) {
              x = Math.cos(t + Math.PI) * 20;
              z = Math.sin(t + Math.PI) * 20;
            }
            break;
          case 5: // Grid
            const col = i % 50;
            const row = Math.floor(i / 50);
            x = (col - 25) * 8;
            z = (row - 30) * 8;
            y = Math.sin(x * 0.1) * Math.cos(z * 0.1) * 10 - 40;
            break;
          case 6: // Ring
            const ringR = 60 + Math.random() * 20;
            const ringTheta = (i / count) * Math.PI * 2 * 10;
            x = Math.cos(ringTheta) * ringR;
            y = Math.sin(ringTheta) * ringR;
            z = (Math.random() - 0.5) * 5;
            break;
          case 7: // Vortex
            const vRatio = i / count;
            const vR = vRatio * 80 + 5;
            const vTheta = vRatio * Math.PI * 20;
            y = (vRatio - 0.5) * 200;
            x = Math.cos(vTheta) * vR;
            z = Math.sin(vTheta) * vR;
            break;
          case 8: // Harmony
            if (i < count * 0.7) {
              const r2 = 30;
              const p2 = Math.acos(-1 + (2 * i) / (count * 0.7));
              const t2 = Math.sqrt(count * 0.7 * Math.PI) * p2;
              x = r2 * Math.cos(t2) * Math.sin(p2);
              y = r2 * Math.sin(t2) * Math.sin(p2);
              z = r2 * Math.cos(p2);
            } else {
              x = (Math.random() - 0.5) * 300;
              y = (Math.random() - 0.5) * 300;
              z = (Math.random() - 0.5) * 300;
            }
            break;
        }
        data[i * 3] = x;
        data[i * 3 + 1] = y;
        data[i * 3 + 2] = z;
      }
      result.push(data);
    }
    return result;
  }, [profile.count]);

  // ============================================================================
  // CLEANUP FUNCTION
  // ============================================================================
  const cleanup = useCallback(() => {
    // Cancel RAF
    if (reqIdRef.current) {
      cancelAnimationFrame(reqIdRef.current);
      reqIdRef.current = null;
    }

    // Revert GSAP context
    if (gsapCtxRef.current) {
      gsapCtxRef.current.revert();
      gsapCtxRef.current = null;
    }

    // Dispose Three.js objects
    if (rendererRef.current) {
      rendererRef.current.dispose();
      if (containerRef.current && rendererRef.current.domElement) {
        try {
          containerRef.current.removeChild(rendererRef.current.domElement);
        } catch (e) {
          // Ignore if already removed
        }
      }
      rendererRef.current = null;
    }

    if (geometryRef.current) {
      geometryRef.current.dispose();
      geometryRef.current = null;
    }

    if (baseGeoRef.current) {
      baseGeoRef.current.dispose();
      baseGeoRef.current = null;
    }

    if (materialRef.current) {
      materialRef.current.dispose();
      materialRef.current = null;
    }

    meshRef.current = null;
    sceneRef.current = null;
    cameraRef.current = null;
  }, []);

  // ============================================================================
  // THREE.JS SETUP EFFECT
  // ============================================================================
  useEffect(() => {
    if (!containerRef.current) return;
    if (profile.count === 0) return;

    const count = profile.count;

    // Setup scene
    const scene = new THREE.Scene();
    sceneRef.current = scene;
    scene.fog = new THREE.FogExp2(BG_BASE, 0.002);

    // Setup camera
    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      2000
    );
    cameraRef.current = camera;
    camera.position.z = 100;

    // Setup renderer
    const renderer = new THREE.WebGLRenderer({
      alpha: true,
      antialias: profile.mode === "desktop",
      powerPreference: "high-performance",
    });
    rendererRef.current = renderer;
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(
      Math.min(window.devicePixelRatio, profile.pixelRatio)
    );
    containerRef.current.appendChild(renderer.domElement);

    // Setup geometry
    const baseGeo = new THREE.SphereGeometry(0.4, 8, 8);
    baseGeoRef.current = baseGeo;
    const geometry = new THREE.InstancedBufferGeometry().copy(baseGeo as any);
    geometryRef.current = geometry;
    geometry.instanceCount = count;

    // Attributes
    const instanceIdx = new Float32Array(count);
    for (let i = 0; i < count; i++) instanceIdx[i] = i;
    geometry.setAttribute(
      "aInstanceIdx",
      new THREE.InstancedBufferAttribute(instanceIdx, 1)
    );

    const posStart = new THREE.InstancedBufferAttribute(shapes[0], 3);
    const posEnd = new THREE.InstancedBufferAttribute(shapes[0], 3);
    geometry.setAttribute("aPosStart", posStart);
    geometry.setAttribute("aPosEnd", posEnd);

    // Setup material
    const material = new THREE.ShaderMaterial({
      uniforms: {
        uTime: { value: 0 },
        uProgress: { value: 0 },
      },
      vertexShader,
      fragmentShader,
      transparent: true,
      depthWrite: false,
      blending: THREE.AdditiveBlending,
    });
    materialRef.current = material;

    // Setup mesh
    const mesh = new THREE.InstancedMesh(geometry, material, count);
    meshRef.current = mesh;

    // Inkspire Dark Cinematic Colors (70% White, 30% Soft Purple)
    const colorWhite = new THREE.Color("#ffffff"); 
    const colorPurpleLight = new THREE.Color("#a78bfa"); 
    const colorPurpleDeep = new THREE.Color("#201037"); 

    for (let i = 0; i < count; i++) {
        const c = Math.random();
        let finalColor;
        if (c < 0.7) {
            // 70% Soft White (slightly desaturated)
            finalColor = colorWhite.clone().lerp(new THREE.Color("#09060f"), 0.15);
        } else {
            // 30% Purple Gradient (Deep Royal to Light Lavender)
            const t = (c - 0.7) / 0.3;
            finalColor = colorPurpleDeep.clone().lerp(colorPurpleLight, t);
        }
        mesh.setColorAt(i, finalColor);
    }
    scene.add(mesh);

    // Animation loop with demand rendering
    const animate = () => {
      if (!isVisible.current || !isPageActive) {
        reqIdRef.current = null;
        return;
      }
      reqIdRef.current = requestAnimationFrame(animate);

      const time = Date.now() * 0.00015; // 50% slower Cinematic Drift
      scene.rotation.y = time * 0.03; 
      scene.rotation.z = Math.sin(time * 0.2) * 0.01;

      if (materialRef.current) {
        materialRef.current.uniforms.uTime.value = time * 1.5; // Shader pulse speed
        materialRef.current.uniforms.uProgress.value =
          animParams.current.progress;
      }

      renderer.render(scene, camera);
    };
    animate();

    // Resize handler
    const handleResize = () => {
      if (!cameraRef.current || !rendererRef.current) return;
      cameraRef.current.aspect = window.innerWidth / window.innerHeight;
      cameraRef.current.updateProjectionMatrix();
      rendererRef.current.setSize(window.innerWidth, window.innerHeight);
      rendererRef.current.setPixelRatio(
        Math.min(window.devicePixelRatio, profile.pixelRatio)
      );
    };
    window.addEventListener("resize", handleResize);

    // Visibility observer for demand rendering
    const observer = new IntersectionObserver(
      ([entry]) => {
        isVisible.current = entry.isIntersecting;
        if (isVisible.current && isPageActive && !reqIdRef.current) {
          animate();
        }
      },
      { threshold: 0.1 }
    );
    observer.observe(containerRef.current);

    return () => {
      window.removeEventListener("resize", handleResize);
      observer.disconnect();
      cleanup();
    };
  }, [profile, shapes, isPageActive, cleanup]);

  // ============================================================================
  // SHAPE TRANSITION EFFECT (GSAP)
  // ============================================================================
  useEffect(() => {
    if (targetShapeIndex === targetShapeIndexRef.current) return;
    if (!meshRef.current) return;

    gsapCtxRef.current = gsap.context(() => {
      const mesh = meshRef.current;
      if (!mesh) return;

      const startData = shapes[currentShapeIndexRef.current];
      const endData = shapes[targetShapeIndex];

      const geo = mesh.geometry as THREE.InstancedBufferGeometry;
      const startAttr = geo.getAttribute(
        "aPosStart"
      ) as THREE.InstancedBufferAttribute;
      const endAttr = geo.getAttribute(
        "aPosEnd"
      ) as THREE.InstancedBufferAttribute;

      startAttr.set(startData);
      endAttr.set(endData);
      startAttr.needsUpdate = true;
      endAttr.needsUpdate = true;

      targetShapeIndexRef.current = targetShapeIndex;
      animParams.current.progress = 0;

      // Camera position based on shape
      let cameraX = 0;
      let cameraZ = 100;
      if (targetShapeIndex === 1) cameraZ = 50;
      else if (targetShapeIndex === 6) cameraX = 60;

      if (cameraRef.current) {
        gsap.to(cameraRef.current.position, {
          x: cameraX,
          z: cameraZ,
          duration: prefersReducedMotion ? 0 : 1.5,
          ease: "power2.inOut",
        });
      }

      gsap.to(animParams.current, {
        progress: 1,
        duration: prefersReducedMotion ? 0 : 1.5,
        ease: "power2.inOut",
        onComplete: () => {
          currentShapeIndexRef.current = targetShapeIndexRef.current;
          animParams.current.progress = 0;
          const finalStartAttr = geo.getAttribute(
            "aPosStart"
          ) as THREE.InstancedBufferAttribute;
          finalStartAttr.set(shapes[currentShapeIndexRef.current]);
          finalStartAttr.needsUpdate = true;
        },
      });
    });

    return () => {
      if (gsapCtxRef.current) {
        gsapCtxRef.current.revert();
      }
    };
  }, [targetShapeIndex, shapes, prefersReducedMotion]);

  return (
    <div ref={containerRef} className="fixed inset-0 z-0 pointer-events-none" />
  );
}



================================================================================
FILE: .\components\nine-dimensions\NineDimensionsHUD.tsx
================================================================================

"use client";

import React from "react";

interface NineDimensionsHUDProps {
    currentSection: number;
    totalSections: number;
    onDotClick: (index: number) => void;
    isAnimating: boolean;
}

export default function NineDimensionsHUD({ 
    currentSection, 
    totalSections, 
    onDotClick,
    isAnimating 
}: NineDimensionsHUDProps) {
    return (
        <>
            {/* Scroll Hint - Desktop Only */}
            <div className={`fixed bottom-8 left-1/2 -translate-x-1/2 z-50 transition-opacity duration-300 ${isAnimating ? 'opacity-0' : 'opacity-50'}`}>
                <div className="text-[10px] tracking-[3px] text-white/50 uppercase select-none animate-pulse">
                    Scroll / Arrow Keys
                </div>
            </div>

            {/* Dots Navigation */}
            <div className="fixed right-8 top-1/2 -translate-y-1/2 flex flex-col gap-4 z-50">
                {Array.from({ length: totalSections }).map((_, idx) => (
                    <button
                        key={idx}
                        onClick={() => !isAnimating && onDotClick(idx)}
                        className={`group relative flex items-center justify-center w-3 h-3 rounded-full transition-all duration-300`}
                        aria-label={`Go to section ${idx + 1}`}
                    >
                        {/* Dot */}
                        <div className={`w-1.5 h-1.5 rounded-full transition-all duration-500 
                            ${currentSection === idx 
                                ? 'bg-[#f2e9ff] scale-150 shadow-[0_0_15px_rgba(242,233,255,0.5)]' 
                                : 'bg-white/20 group-hover:bg-white/50'}`} 
                        />
                        
                        {/* Optional Tooltip/Number (Hidden by default, reveal on hover) */}
                        <span className={`absolute right-6 text-[10px] text-white/80 tracking-widest opacity-0 -translate-x-2 transition-all duration-300
                            ${currentSection === idx ? 'opacity-100 translate-x-0' : 'group-hover:opacity-100 group-hover:translate-x-0'}`}>
                            0{idx + 1}
                        </span>
                    </button>
                ))}
            </div>
        </>
    );
}



================================================================================
FILE: .\components\nine-dimensions\NineDimensionsLayout.tsx
================================================================================

"use client";

import dynamic from "next/dynamic";
import { AnimatePresence, motion } from "framer-motion";
import { useResponsiveMode } from "@/hooks/useResponsiveMode";
import { useNineDimensionsController } from "@/hooks/useNineDimensionsController";
import NineDimensionsBackground from "./NineDimensionsBackground";
import NineDimensionsHUD from "./NineDimensionsHUD";
import ResponsiveSection from "@/components/layout/ResponsiveSection";

// Import mapping sections
import HeroScene from "@/components/hero/HeroScene";
import StatsSection from "@/components/sections/StatsSection";
import AboutSection from "@/components/sections/AboutSection";
import ServicesSection from "@/components/sections/ServicesSection";

// Heavy sections dynamic
const SelectedWorkSection = dynamic(
  () => import("@/components/sections/SelectedWorkSection")
);
const TeamSection = dynamic(() => import("@/components/sections/TeamSection"));
const ClientsMarquee = dynamic(
  () => import("@/components/sections/ClientsMarquee")
);
const TestimonialsSection = dynamic(
  () => import("@/components/sections/TestimonialsSection")
);
const FinalCTA = dynamic(() => import("@/components/sections/FinalCTA"));

// ============================================================================
// SECTION DEFINITIONS
// ============================================================================
const SECTIONS = [
  { id: "genesis", component: <HeroScene /> }, // 0: Genesis (Chaos)
  { id: "tunnel", component: <StatsSection /> }, // 1: Tunnel
  { id: "sphere", component: <AboutSection /> }, // 2: Sphere
  { id: "cube", component: <ServicesSection /> }, // 3: Cube
  { id: "helix", component: <SelectedWorkSection /> }, // 4: Helix
  { id: "grid", component: <TeamSection /> }, // 5: Grid
  { id: "ring", component: <ClientsMarquee /> }, // 6: Ring
  { id: "vortex", component: <TestimonialsSection /> }, // 7: Vortex
  { id: "harmony", component: <FinalCTA /> }, // 8: Harmony
];

// Sections that need full-height styling
const FULL_HEIGHT_SECTIONS = new Set([0, 2, 6, 7, 8]);

// ============================================================================
// ANIMATION VARIANTS
// ============================================================================
const cinematicVariants = {
  initial: { opacity: 0, y: 50, scale: 0.9 },
  animate: { opacity: 1, y: 0, scale: 1 },
  exit: { opacity: 0, y: -50, scale: 1.1 },
};

const reducedMotionVariants = {
  initial: { opacity: 1 },
  animate: { opacity: 1 },
  exit: { opacity: 1 },
};

// ============================================================================
// THE COMPONENT
// ============================================================================
/**
 * NineDimensionsLayout - Main home page layout with 9 cinematic sections.
 * 
 * Rendering Modes:
 * - scrollMode === 'native': Stacked sections with natural scroll (mobile + tablet)
 * - scrollMode === 'cinematic': Fixed viewport with section-by-section animation (desktop)
 * 
 * Background Rendering:
 * - render3D === true on desktop: Full 3D particle animation
 * - render3D === true on tablet (hybrid): Lite 3D (reduced particles, no post-fx)
 * - render3D === false: Static gradient background
 * 
 * SSR Safety:
 * - No window.innerWidth checks in render path
 * - Uses useResponsiveMode hook with useSyncExternalStore
 * - Stable initial state matches server render (desktop/cinematic)
 */
export default function NineDimensionsLayout() {
  const totalSections = SECTIONS.length;
  
  // SSR-safe responsive mode detection
  const { scrollMode, render3D, prefersReducedMotion, isMobile, isTablet, isHydrated } =
    useResponsiveMode();

  // Section navigation controller (only active in cinematic mode)
  const { currentSection, isAnimating, navigate, isReady } =
    useNineDimensionsController(totalSections, {
      enabled: isHydrated && scrollMode === "cinematic",
    });

  // Choose animation variants based on reduced motion preference
  const variants = prefersReducedMotion
    ? reducedMotionVariants
    : cinematicVariants;

  // ============================================================================
  // HYDRATION PLACEHOLDER - Prevents layout flicker
  // ============================================================================
  if (!isHydrated) {
    return (
      <main className="fixed inset-0 w-full h-full bg-[#09060f]" />
    );
  }


  // ============================================================================
  // NATIVE SCROLL MODE (Mobile + Tablet)
  // ============================================================================
  if (scrollMode === "native") {
    return (
      <main className="w-full min-h-screen relative bg-[#09060f] text-white">
        {/* Background Layer */}
        {render3D && isTablet ? (
          // Tablet with capable device: Lite 3D background
          <NineDimensionsBackground targetShapeIndex={0} lite />
        ) : (
          // Mobile or incapable tablet: Static gradient
          <div className="fixed inset-0 z-0 bg-gradient-to-b from-[#0d0e22] to-[#09060f] pointer-events-none" />
        )}

        {/* Stacked Sections */}
        <div className="relative z-10 flex flex-col w-full">
          {SECTIONS.map((item, idx) => (
            <ResponsiveSection
              key={idx}
              id={item.id}
              scrollModeOverride="native"
              className="justify-start pt-16 md:pt-20 scroll-mt-24"
            >
              {item.component}
            </ResponsiveSection>
          ))}
        </div>
      </main>
    );
  }

  // ============================================================================
  // CINEMATIC MODE (Desktop)
  // Wait for controller to be ready before rendering
  // ============================================================================
  if (!isReady) {
    // SSR-safe placeholder that matches server render
    return (
      <main className="overflow-hidden fixed inset-0 w-full h-full bg-[#09060f]" />
    );
  }

  const isFullHeight = FULL_HEIGHT_SECTIONS.has(currentSection);

  return (
    <main className="overflow-hidden fixed inset-0 w-full h-full">
      {/* 1. 3D Background Layer */}
      {render3D && (
        <NineDimensionsBackground targetShapeIndex={currentSection} />
      )}

      {/* Fallback gradient if 3D is disabled (reduced motion) */}
      {!render3D && (
        <div className="fixed inset-0 z-0 bg-gradient-to-b from-[#0d0e22] to-[#09060f] pointer-events-none" />
      )}

      {/* 2. HUD Layer */}
      <NineDimensionsHUD
        currentSection={currentSection}
        totalSections={totalSections}
        onDotClick={navigate}
        isAnimating={isAnimating}
      />

      {/* 3. Content Layer */}
      <AnimatePresence mode="wait">
        <motion.section
          key={currentSection}
          initial="initial"
          animate="animate"
          exit="exit"
          variants={variants}
          transition={{
            duration: prefersReducedMotion ? 0 : 1,
            ease: [0.23, 1, 0.32, 1],
          }}
          className={`
            absolute inset-0 z-50 w-full h-full 
            flex flex-col items-center justify-start 
            pointer-events-none pt-16 md:pt-20
            ${isFullHeight ? "p-0" : "px-4 md:px-8"}
          `}
        >
          <div
            className={`
            w-full pointer-events-auto
            ${isFullHeight ? "h-full" : "max-w-[1400px]"}
          `}
          >
            {SECTIONS[currentSection].component}
          </div>
        </motion.section>
      </AnimatePresence>
    </main>
  );
}



================================================================================
FILE: .\components\popup\InsightPopup.tsx
================================================================================

"use client";

import React, { useEffect } from "react";
import { AnimatePresence, motion } from "framer-motion";
import { usePopup } from "@/hooks/usePopup";
import { X, Facebook, Instagram, Twitter, Linkedin, ExternalLink, Zap, Target, Layers } from "lucide-react";
import Image from "next/image";

// --- Premium UI Support Components ---

const GlassCorner = ({ position }: { position: 'tl' | 'tr' | 'bl' | 'br' }) => {
    const classes = {
        tl: "top-0 left-0 border-t border-l rounded-tl-2xl",
        tr: "top-0 right-0 border-t border-r rounded-tr-2xl",
        bl: "bottom-0 left-0 border-b border-l rounded-bl-2xl",
        br: "bottom-0 right-0 border-b border-r rounded-br-2xl",
    };
    return (
        <div className={`absolute w-8 h-8 border-white/20 z-20 pointer-events-none ${classes[position]}`} />
    );
};

const SocialLink = ({ href, icon: Icon, label }: { href?: string; icon: any; label: string }) => {
    if (!href) return null;
    return (
        <a
            href={href}
            target="_blank"
            rel="noopener noreferrer"
            className="group relative p-3 bg-white/5 border border-white/10 rounded-xl overflow-hidden transition-all duration-500 hover:border-purple-500/50 hover:bg-purple-500/10 shadow-lg"
            aria-label={label}
        >
            <div className="absolute inset-0 bg-gradient-to-tr from-purple-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
            <Icon size={18} className="text-white/40 group-hover:text-purple-400 group-hover:scale-110 transition-all duration-500 relative z-10" />
        </a>
    );
};

export default function InsightPopup() {
    const { isOpen, currentPopup, closePopup } = usePopup();

    useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            if (e.key === "Escape") closePopup();
        };
        if (isOpen) {
            window.addEventListener("keydown", handleKeyDown);
            document.body.style.overflow = "hidden";
        } else {
            document.body.style.overflow = "";
        }
        return () => {
            window.removeEventListener("keydown", handleKeyDown);
            document.body.style.overflow = "";
        };
    }, [isOpen, closePopup]);

    return (
        <AnimatePresence>
            {isOpen && currentPopup && (
                <div key={currentPopup.id || "popup-overlay"} className="fixed inset-0 z-[9999] flex items-center justify-center p-4 md:p-8">

                    {/* Cinematic Overlay */}
                    <motion.div
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        transition={{ duration: 0.6 }}
                        className="absolute inset-0 bg-black/80 backdrop-blur-md overflow-hidden"
                        onClick={closePopup}
                    >
                        {/* Animated Grain/Noise for Texture */}
                        <div className="absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://grainy-gradients.vercel.app/noise.svg')] mix-blend-overlay" />
                        {/* Ambient Glows */}
                        <div className="absolute top-1/4 -left-1/4 w-[600px] h-[600px] bg-purple-900/20 rounded-full blur-[120px] pointer-events-none" />
                        <div className="absolute bottom-1/4 -right-1/4 w-[600px] h-[600px] bg-indigo-900/20 rounded-full blur-[120px] pointer-events-none" />
                    </motion.div>

                    {/* Main Popup: Beast Mode UI */}
                    <motion.div
                        layoutId={currentPopup.id}
                        initial={{ scale: 0.9, opacity: 0, y: 40 }}
                        animate={{ scale: 1, opacity: 1, y: 0 }}
                        exit={{ scale: 0.9, opacity: 0, y: 40 }}
                        transition={{ type: "spring", damping: 28, stiffness: 350 }}
                        className="relative w-full max-w-6xl max-h-[90vh] bg-[#050507]/80 backdrop-blur-lg border border-white/10 rounded-2xl shadow-[0_0_80px_rgba(0,0,0,0.8)] overflow-hidden flex flex-col md:flex-row z-10 group"
                        onClick={(e) => e.stopPropagation()}
                    >
                        {/* Decorative HUD Elements */}
                        <GlassCorner position="tl" />
                        <GlassCorner position="tr" />
                        <GlassCorner position="bl" />
                        <GlassCorner position="br" />

                        {/* Animated Floating Glow Border */}
                        <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-1000 bg-gradient-to-r from-purple-500/10 via-transparent to-indigo-500/10 pointer-events-none" />

                        {/* Technical Close Button */}
                        <button
                            onClick={closePopup}
                            aria-label="Close Case Study"
                            className="absolute top-6 right-6 z-50 p-2 text-white/40 hover:text-white transition-all bg-white/5 hover:bg-red-500/20 border border-white/10 hover:border-red-500/40 rounded-lg group/close"
                        >
                            <X size={20} className="group-hover/close:rotate-90 transition-transform duration-500" />
                        </button>

                        {/* --- LEFT: Visual Intel --- */}
                        {currentPopup.imageUrl && (
                            <div className="w-full md:w-[45%] h-80 sm:h-96 md:h-auto md:min-h-[600px] relative overflow-hidden bg-zinc-950 border-b md:border-b-0 md:border-r border-white/5">
                                <Image
                                    src={currentPopup.imageUrl}
                                    alt={currentPopup.title}
                                    fill
                                    className="object-cover object-top opacity-80 group-hover:opacity-100 transition-all duration-1000 scale-[1.01] group-hover:scale-105"
                                    sizes="(max-width: 768px) 100vw, 50vw"
                                    quality={90}
                                />
                                {/* Dynamic Overlays */}
                                <div className="absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-[#050507] via-[#050507]/40 to-transparent md:hidden" />
                                <div className="absolute inset-y-0 right-0 w-32 bg-gradient-to-r from-transparent to-[#050507] hidden md:block" />

                                {/* Technical HUD Scanning Line (Subtle) */}
                                <div className="absolute inset-x-0 top-0 h-px bg-white/20 animate-scanline pointer-events-none opacity-40" />
                            </div>
                        )}

                        {/* --- RIGHT: Content Core --- */}
                        <div className={`w-full ${currentPopup.imageUrl ? 'md:w-[55%]' : 'w-full'} flex flex-col relative min-h-0`}>

                            {/* Technical Header Area */}
                            <div className="px-6 pt-10 md:px-14 md:pt-14 relative z-10">
                                <div className="flex items-center gap-3 mb-4">
                                    <div className="h-px w-6 md:w-8 bg-purple-500" />
                                    <span className="text-[9px] md:text-[10px] font-bold tracking-[0.3em] md:tracking-[0.4em] text-purple-400 uppercase">
                                        Project Insight // {currentPopup.source || "Featured"}
                                    </span>
                                </div>
                                <h2 className="text-3xl sm:text-4xl md:text-6xl font-bold text-white mb-2 leading-[1] md:leading-[0.9] brand-font tracking-tighter">
                                    {currentPopup.title}
                                </h2>
                                {currentPopup.subtitle && (
                                    <p className="text-sm md:text-xl text-white/40 font-medium font-outfit uppercase tracking-[0.15em] md:tracking-widest mt-1 md:mt-2">
                                        {currentPopup.subtitle}
                                    </p>
                                )}
                            </div>

                            {/* Scrollable Intelligence Body */}
                            <div className="flex-1 overflow-y-auto px-6 md:px-14 py-6 md:py-8 custom-scrollbar relative z-10">
                                <div className="text-white/70 text-base md:text-xl leading-relaxed font-light font-sans max-w-2xl border-l-2 border-purple-500/20 pl-4 md:pl-6 py-2">
                                    {currentPopup.description}
                                </div>

                                {/* Dynamic Service Chips */}
                                {currentPopup.tags && (
                                    <div className="flex flex-wrap gap-2 mt-8 md:mt-10">
                                        {currentPopup.tags.map((tag, i) => (
                                            <div key={i} className="flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-1.5 bg-white/5 border border-white/10 rounded-full text-[10px] md:text-[11px] font-bold text-white/40 hover:text-white hover:border-purple-500/40 transition-all cursor-default group/tag backdrop-blur-sm">
                                                <Target size={10} className="text-purple-500/60 group-hover/tag:scale-110 transition-transform" />
                                                {tag.toUpperCase()}
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>

                            {/* Footer: Action nexus */}
                            <div className="px-6 pb-8 md:px-14 md:pb-12 pt-6 border-t border-white/5 flex flex-col sm:flex-row items-center justify-between gap-6 md:gap-8 z-20 mt-auto">

                                <div className="flex flex-col gap-3 w-full sm:w-auto items-center sm:items-start">
                                    <span className="text-[9px] font-black text-white/20 tracking-[0.3em] uppercase">Connect Protocol</span>
                                    <div className="flex items-center gap-2">
                                        <SocialLink href={currentPopup.social?.facebookUrl} icon={Facebook} label="FB" />
                                        <SocialLink href={currentPopup.social?.instagramUrl} icon={Instagram} label="IG" />
                                        <SocialLink href={currentPopup.social?.twitterUrl} icon={Twitter} label="TW" />
                                        <SocialLink href={currentPopup.social?.linkedinUrl} icon={Linkedin} label="LI" />
                                        <SocialLink href={currentPopup.social?.behanceUrl} icon={ExternalLink} label="BE" />
                                    </div>
                                </div>

                                {currentPopup.projectSlug && (
                                    <a
                                        href={`/portfolio/${currentPopup.projectSlug}`}
                                        className="w-full sm:w-auto relative group/btn flex items-center justify-center gap-3 px-8 py-4 md:px-12 md:py-5 bg-white text-black overflow-hidden rounded-xl transition-all duration-300 active:scale-95"
                                        onClick={closePopup}
                                    >
                                        {/* Cinematic Button Hover Effect */}
                                        <div className="absolute inset-0 bg-purple-600 translate-y-full group-hover/btn:translate-y-0 transition-transform duration-500 ease-out" />

                                        <span className="relative z-10 font-bold text-xs md:text-sm uppercase tracking-wider group-hover/btn:text-white transition-colors duration-300">
                                            Explore Full Case Study
                                        </span>
                                        <Layers size={16} className="relative z-10 group-hover/btn:text-white transition-all duration-300 group-hover/btn:rotate-12" />
                                    </a>
                                )}
                            </div>
                        </div>

                    </motion.div>
                </div>
            )}

            <style jsx global>{`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: rgba(255, 255, 255, 0.02);
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(168, 85, 247, 0.2);
                    border-radius: 20px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(168, 85, 247, 0.5);
                }
            `}</style>
        </AnimatePresence>
    );
}


================================================================================
FILE: .\components\sections\AboutSection.tsx
================================================================================

"use client";

import { useGSAPFade } from "@/hooks/useGSAPFade";
import SectionTitle from "@/components/ui/SectionTitle";

export default function AboutSection() {
    const containerRef = useGSAPFade();

    return (
        <section 
            ref={containerRef} 
            className="scroll-mt-24 w-full min-h-[100svh] flex flex-col items-center justify-start pt-16 md:pt-20 pb-8 px-4 md:px-6 relative isolate z-10 overflow-hidden"
        >
            {/* 1. Precise Title Layer - Tightened Spacing */}
            <div className="relative z-50 mb-2 md:mb-4 isolate">
                <SectionTitle 
                    title="About" 
                    highlight="Us" 
                    highlightColor="text-accentPurple"
                    className="!mb-0 !opacity-100 !visible" 
                />
            </div>

            {/* 2. Responsive Content Card - Width controlled for cinematic focus */}
            <div className="w-full md:w-[min(90vw,900px)] lg:w-[min(70vw,1100px)] -translate-y-2 md:-translate-y-4 mx-auto border border-white/5 rounded-[1.5rem] md:rounded-[2rem] p-[clamp(1.25rem,4vw,3.5rem)] relative overflow-hidden max-h-[80vh] overflow-y-auto custom-scrollbar
                bg-[linear-gradient(180deg,rgba(255,255,255,0.05),rgba(255,255,255,0.015))]
                shadow-[inset_0_0_0_1px_rgba(255,255,255,0.08),0_20px_60px_rgba(0,0,0,0.45)]
                before:absolute before:inset-0 before:bg-[linear-gradient(180deg,rgba(167,139,250,0.08),rgba(109,40,217,0.04))] before:opacity-100 before:pointer-events-none">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
                    
                    {/* Text Column - Calibrated Typography */}
                    <div className="fade-up space-y-4 md:space-y-6 text-left">
                        <h3 className="font-bold tracking-tight text-white/90 leading-tight" style={{ fontSize: 'var(--fs-h3)' }}>
                            Inspired by <span className="text-accentPurple">Ink</span>
                        </h3>
                        
                        <div className="space-y-4 md:space-y-5 max-w-xl">
                            <p className="text-white/90 font-bold leading-tight" style={{ fontSize: 'clamp(1rem, 2vw, 1.25rem)' }}>
                                we craft brands with intention every line, every word, every visual.
                            </p>
                            <p className="text-white/65 leading-relaxed font-medium" style={{ fontSize: 'var(--fs-body)' }}>
                                Inkspire is a creative studio built on intuition, emotion, and strategy. 
                                We turn blank pages into brands with identity, businesses into stories with meaning, and social feeds into experiences people actually engage with.
                                <br /><br className="hidden md:block"/>
                                Whether youre launching something new, leveling up your brand, level of search, youre in the perfect place.
                            </p>
                        </div>
                    </div>

                    {/* Video Column - Aspect-controlled for mobile density */}
                    <div className="fade-up relative rounded-[1rem] md:rounded-[1.5rem] overflow-hidden shadow-2xl shadow-purple-900/10 aspect-video lg:aspect-square xl:aspect-video grayscale hover:grayscale-0 transition-all duration-700 w-full group isolate max-h-[25vh] lg:max-h-none">
                        <video
                            className="w-full h-full object-cover scale-105 group-hover:scale-100 transition-transform duration-1000"
                            src="/1_2.mp4"
                            autoPlay
                            muted
                            loop
                            playsInline
                            preload="metadata"
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-[#09060f]/60 via-transparent to-transparent pointer-events-none" />
                        <div className="absolute inset-0 border border-white/5 rounded-[1rem] md:rounded-[1.5rem] pointer-events-none" />
                    </div>
                </div>
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\sections\ClientsMarquee.tsx
================================================================================

"use client";

import Image from "next/image";
import { useRouter } from "next/navigation";
import dynamic from "next/dynamic";
import { clients } from "@/data/clients";
import { usePopup } from "@/hooks/usePopup";
import { buildPopupFromProject } from "@/lib/popupMappers";
import { projects } from "@/data/projects";
import { useResponsiveMode } from "@/hooks/useResponsiveMode";

// Dynamic import for the 3D scene (Desktop only heavyweight)
const OrbitalClientsScene = dynamic(() => import("./clients/OrbitalClientsScene"), {
    ssr: false,
    loading: () => <div className="w-full h-full flex items-center justify-center text-white/20">Loading Orbital System...</div>
});

export default function ClientsSection() {
    const router = useRouter();
    const { openPopup } = usePopup();
    const { hasTouch, render3D, scrollMode } = useResponsiveMode();

    // Safari detection for performance and rendering optimization
    const isSafari = typeof navigator !== 'undefined' && 
                     /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

    // Show grid on touch devices or native scroll mode
    const showGrid = hasTouch || scrollMode === "native";
    // Show 3D only on desktop cinematic mode with render3D enabled
    const show3D = render3D && scrollMode === "cinematic";

    return (
        <section className="min-h-[100dvh] w-full flex items-start bg-white/[0.02] border-y border-white/5 relative overflow-visible pt-0">

            {/* 1. 3D BACKGROUND LAYER (Active on Desktop cinematic mode) */}
            {show3D && (
                <div className="absolute inset-0 z-0 overflow-visible pointer-events-auto">
                     <OrbitalClientsScene />
                </div>
            )}

            {/* 2. CONTENT LAYER (z-10) */}
            <div className="w-full h-full flex flex-col lg:flex-row relative z-10 pointer-events-none overflow-visible">

                {/* Left Column: Title */}
                <div className="w-full lg:w-1/3 p-6 md:p-12 flex flex-col justify-start pt-16 md:pt-20 pb-8 border-b lg:border-b-0 lg:border-r border-white/5 relative z-20 bg-black/20 backdrop-blur-sm pointer-events-auto">
                    <div className="relative">
                        <h6 className="text-sm font-medium text-purple-400 uppercase tracking-[0.2em] mb-4">
                            Partners
                        </h6>
                        <h3 className="text-4xl sm:text-5xl md:text-6xl font-bold leading-tight brand-font text-white">
                            Our <br /> Clients
                        </h3>
                        <div className="mt-8 w-24 h-1 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-full opacity-80" />

                        <p className="mt-6 text-white/50 max-w-sm text-lg">
                            Trusted by innovative brands worldwide to bring their vision to life.
                        </p>
                    </div>
                </div>

                {/* Right Column: Interaction Area */}
                <div className="w-full lg:w-2/3 relative min-h-[500px] lg:min-h-screen">
                    
                    {/* Grid for touch/native scroll mode */}
                    {showGrid && (
                        <div className="w-full h-full pointer-events-auto">
                            <div className="absolute inset-0 bg-gradient-to-b from-transparent to-black/20 pointer-events-none z-0" />
                            <div className="grid grid-cols-2 md:grid-cols-4 h-full border-t lg:border-t-0 border-l border-white/5">
                                {clients.slice(0, 16).map((client) => (
                                    <div
                                        key={client.id}
                                        onClick={() => {
                                            if (client.projectSlug) {
                                                const project = projects.find(p => p.slug === client.projectSlug);
                                                if (project) {
                                                    openPopup(buildPopupFromProject(project));
                                                    return;
                                                }
                                            }
                                            const randomProject = projects[Math.floor(Math.random() * projects.length)];
                                            if (randomProject) {
                                                openPopup(buildPopupFromProject(randomProject));
                                            }
                                        }}
                                        className={`group relative min-h-[160px] lg:min-h-[25vh] border-r border-b border-white/5 flex items-center justify-center p-8 transition-all duration-500 overflow-visible cursor-pointer hover:z-30
                                            ${client.projectSlug
                                                ? 'hover:bg-white/[0.06]'
                                                : 'hover:bg-white/[0.02]'}`}
                                    >
                                        <div className="absolute inset-0 pointer-events-none overflow-hidden">
                                            <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent transition-transform duration-1000 ease-in-out skew-x-12" />
                                        </div>
                                        <div className={`relative z-10 w-full h-full flex items-center justify-center transition-all duration-500 ease-out group-hover:scale-110 group-hover:-translate-y-2
                                            ${isSafari ? 'opacity-40 group-hover:opacity-100' : ''}
                                            ${!isSafari ? (client.projectSlug
                                                ? 'grayscale opacity-40 group-hover:grayscale-0 group-hover:opacity-100'
                                                : 'grayscale opacity-20 group-hover:grayscale-0 group-hover:opacity-60') : ''}`}>
                                            <Image
                                                src={client.logo}
                                                alt={client.name || "Client Logo"}
                                                fill
                                                className={`object-contain transition-all duration-500 ${
                                                    isSafari ? 'safari-logo-fix' : 'brightness-0 invert group-hover:brightness-[2]'
                                                }`}
                                                sizes="(max-width: 768px) 50vw, 25vw"
                                            />
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\sections\ContactForm.tsx
================================================================================

"use client";

import { Send } from "lucide-react";

export default function ContactForm() {
    return (
        <section className="py-20 px-6 relative z-10">
            <div className="max-w-3xl mx-auto">
                <form className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="space-y-3">
                            <label
                                htmlFor="name"
                                className="block text-sm font-medium text-white/90 uppercase tracking-widest"
                            >
                                Name
                            </label>
                            <input
                                type="text"
                                id="name"
                                className="w-full bg-gradient-to-br from-white/[0.08] to-white/[0.03] backdrop-blur-xl border border-white/20 rounded-2xl px-5 py-4 text-white text-base placeholder:text-white/40 focus:outline-none focus:border-purple-400/60 focus:bg-white/[0.12] transition-all duration-300 shadow-lg shadow-black/20"
                                placeholder="John Doe"
                            />
                        </div>
                        <div className="space-y-3">
                            <label
                                htmlFor="email"
                                className="block text-sm font-medium text-white/90 uppercase tracking-widest"
                            >
                                Email
                            </label>
                            <input
                                type="email"
                                id="email"
                                className="w-full bg-gradient-to-br from-white/[0.08] to-white/[0.03] backdrop-blur-xl border border-white/20 rounded-2xl px-5 py-4 text-white text-base placeholder:text-white/40 focus:outline-none focus:border-purple-400/60 focus:bg-white/[0.12] transition-all duration-300 shadow-lg shadow-black/20"
                                placeholder="john@example.com"
                            />
                        </div>
                    </div>

                    <div className="space-y-3">
                        <label
                            htmlFor="message"
                            className="block text-sm font-medium text-white/90 uppercase tracking-widest"
                        >
                            Message
                        </label>
                        <textarea
                            id="message"
                            rows={6}
                            className="w-full bg-gradient-to-br from-white/[0.08] to-white/[0.03] backdrop-blur-xl border border-white/20 rounded-2xl px-5 py-4 text-white text-base placeholder:text-white/40 focus:outline-none focus:border-purple-400/60 focus:bg-white/[0.12] transition-all duration-300 resize-none shadow-lg shadow-black/20"
                            placeholder="Tell us about your project..."
                        />
                    </div>

                    <div className="pt-4">
                        <button
                            type="submit"
                            className="group relative px-8 py-4 bg-white text-black font-bold rounded-full overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-purple-500/50 flex items-center gap-3"
                        >
                            <span className="relative z-10">Send Message</span>
                            <Send size={18} className="relative z-10 group-hover:translate-x-1 transition-transform duration-300" />
                            <div className="absolute inset-0 bg-gradient-to-r from-purple-600 to-pink-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
                        </button>
                    </div>
                </form>
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\sections\FinalCTA.tsx
================================================================================

"use client";

import { siteContent } from "@/data/siteContent";

export default function FinalCTA() {
    return (
        <section id="contact" className="scroll-mt-24 w-full min-h-[100dvh] relative z-10 flex flex-col items-center justify-start lg:justify-center text-center pt-16 md:pt-20 lg:pt-0 pb-8 md:pb-12 lg:pb-0">
            {/* Background - Fully integrated with tunnel darkness */}
            <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent pointer-events-none overflow-hidden" />

            {/* Main Content - Centered but feels boundless */}
            <div className="relative z-10 max-w-4xl mx-auto px-6">
                <h2 className="text-4xl sm:text-5xl md:text-8xl font-bold text-white mb-10 leading-none tracking-tight">
                    {siteContent.finalCta.title}
                </h2>
                <p className="text-xl md:text-2xl text-white/60 font-light mb-16 max-w-2xl mx-auto">
                    {siteContent.finalCta.description}
                </p>

                <a
                    href={siteContent.finalCta.buttonHref}
                    className="inline-flex items-center justify-center px-12 py-6 bg-white text-black rounded-full text-xl font-bold tracking-wide hover:scale-105 hover:bg-inkspirePurple hover:text-white transition-all duration-300 shadow-[0_0_40px_rgba(255,255,255,0.2)] hover:shadow-[0_0_60px_rgba(124,58,237,0.6)]"
                >
                    {siteContent.finalCta.buttonLabel}
                </a>
            </div>

            <footer className="absolute bottom-6 w-full text-center text-white/30 text-sm">
                {siteContent.global.footerText}
            </footer>
        </section>
    );
}



================================================================================
FILE: .\components\sections\SelectedWorkSection.tsx
================================================================================

"use client";

import Image from "next/image";
import { useRouter } from "next/navigation";
import { Swiper, SwiperSlide } from "swiper/react";
import { Autoplay, EffectCreative, Pagination } from "swiper/modules";
import "swiper/css";
import "swiper/css/effect-creative";
import "swiper/css/pagination";
import SectionTitle from "@/components/ui/SectionTitle";
import { useGSAPFade } from "@/hooks/useGSAPFade";
import { usePopup } from "@/hooks/usePopup";
import { buildPopupFromProject } from "@/lib/popupMappers";

import { projects } from "@/data/projects";

export default function SelectedWorkSection() {
    const containerRef = useGSAPFade();
    const { openPopup } = usePopup();

    // Use a subset of projects for Selected Work
    const selectedWorks = projects.slice(0, 6);

    return (
        <section 
            id="work"
            ref={containerRef} 
            className="scroll-mt-20 h-[100dvh] w-full flex flex-col relative isolate overflow-hidden bg-transparent"
        >
            {/* 1. Title Rail - High priority visibility */}
            <div className="relative z-50 pt-16 md:pt-20 pb-2 isolate flex-shrink-0 pointer-events-none">
                <SectionTitle 
                    title="Selected" 
                    highlight="Work" 
                    highlightColor="text-accentPurple" 
                    className="!mb-0"
                />
            </div>

            {/* 2. Slider Rail - Flexes to fill remaining height */}
            <div className="flex-grow w-full max-w-[1700px] mx-auto px-4 flex items-center justify-center overflow-visible pb-12 md:pb-20">
                <div className="w-full h-full max-h-[500px] md:max-h-[700px] flex items-center">
                    <Swiper
                        effect={'creative'}
                        grabCursor={true}
                        centeredSlides={true}
                        slidesPerView={'auto'}
                        creativeEffect={{
                            perspective: true,
                            limitProgress: 2,
                            prev: {
                                translate: ['-90%', 0, -400],
                                rotate: [0, 0, -5],
                                opacity: 0.6,
                                scale: 0.85,
                            },
                            next: {
                                translate: ['90%', 0, -400],
                                rotate: [0, 0, 5],
                                opacity: 0.6,
                                scale: 0.85,
                            },
                            shadowPerProgress: false
                        }}
                        pagination={true}
                        modules={[EffectCreative, Pagination, Autoplay]}
                        className="w-full h-full !overflow-visible"
                        autoplay={{ delay: 3000, disableOnInteraction: false }}
                        loop={true}
                        speed={1000}
                    >
                        {selectedWorks.map((work, index) => (
                            <SwiperSlide
                                key={index}
                                onClick={() => openPopup(buildPopupFromProject(work))}
                                className="!w-[85vw] md:!w-[1100px] !h-full relative cursor-pointer"
                            >
                                {/* Floating Plane Wrapper */}
                                <div className="selectedwork-plane w-full h-full relative">
                                    <Image
                                        src={work.coverImage || "/works/placeholder.webp"}
                                        alt={work.title}
                                        fill
                                        className="object-cover rounded-md"
                                        sizes="(max-width: 768px) 90vw, 1200px"
                                        quality={95}
                                        priority={index < 3}
                                    />
                                </div>
                            </SwiperSlide>
                        ))}
                    </Swiper>
                </div>
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\sections\ServicesSection.tsx
================================================================================

"use client";

import { services } from "@/data/staticData";
import SectionTitle from "@/components/ui/SectionTitle";
import {
    Fingerprint,
    Clapperboard,
    Laptop,
    CalendarCheck,
    PenTool,
    Target,
    Megaphone,
    CheckCircle,
    LucideIcon
} from "lucide-react";
import { useGSAPFade } from "@/hooks/useGSAPFade";
import { usePopup } from "@/hooks/usePopup";
import { buildPopupFromService } from "@/lib/popupMappers";

const iconMap: Record<string, LucideIcon> = {
    Fingerprint,
    Clapperboard,
    Laptop,
    CalendarCheck,
    PenTool,
    Target,
    Megaphone
};

export default function ServicesSection() {
    const containerRef = useGSAPFade();
    const { openPopup } = usePopup();

    return (
        <div id="services" ref={containerRef} className="scroll-mt-24 min-h-screen lg:h-full flex flex-col justify-start pt-4 md:pt-8 lg:pt-10 pb-8 px-4 md:px-6 relative isolate overflow-visible">
            {/* Background Veil - High contrast for readability */}
            <div className="absolute inset-x-0 top-1/2 -translate-y-1/2 h-full lg:h-[95%] w-full max-w-7xl mx-auto pointer-events-none z-0"
                 style={{ 
                     background: 'radial-gradient(circle at center, rgba(9,6,15,0.7), rgba(9,6,15,0.0) 85%)' 
                 }} 
            />

            <div className="max-w-7xl mx-auto w-full relative z-10 flex flex-col h-full">
                <SectionTitle 
                    title="Our" 
                    highlight="Intelligent" 
                    highlightColor="text-accentPurple"
                    className="mb-4 md:mb-6 lg:mb-8"
                />
                
                {/* 
                    Grid System for 6 Cards:
                    - Optimized to fit 100vh on Desktop
                    - Uses auto-rows-fr for equal heights
                */}
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 lg:auto-rows-fr gap-3 md:gap-4 lg:gap-5 overflow-y-auto lg:overflow-visible pb-10 lg:pb-0 custom-scrollbar">
                    {services.map((service, i) => {
                        const IconComponent = iconMap[service.icon] || CheckCircle;

                        return (
                            <div
                                key={i}
                                onClick={() => openPopup(buildPopupFromService(service))}
                                className="fade-up group p-4 md:p-5 lg:p-6 cursor-pointer relative overflow-hidden flex flex-col items-start transition-all duration-500 hover:-translate-y-1 h-full"
                                style={{
                                    background: `
                                        linear-gradient(180deg, rgba(9,6,15,0.85), rgba(13,14,34,0.65)),
                                        radial-gradient(1200px 500px at 20% 0%, rgba(32,16,55,0.28), transparent 60%)
                                    `,
                                    boxShadow: `
                                        inset 0 0 0 1px rgba(255,255,255,0.08),
                                        0 20px 50px rgba(0,0,0,0.45)
                                    `,
                                    borderRadius: '24px'
                                }}
                            >
                                <div className="absolute inset-0 bg-black/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none" />
                                
                                <div className="relative z-10 w-full">
                                    <div className="w-8 h-8 md:w-10 md:h-10 bg-white/5 rounded-xl border border-white/10 flex items-center justify-center mb-3 group-hover:scale-110 group-hover:bg-white/10 transition-all duration-300 shadow-inner">
                                        <IconComponent className="text-white group-hover:text-accentPurple transition-colors w-4 h-4 md:w-5 md:h-5" />
                                    </div>
                                    
                                    <h3 
                                        className="text-base md:text-lg lg:text-xl font-bold mb-1.5 tracking-tight transition-colors line-clamp-1"
                                        style={{ color: 'rgba(255,255,255,0.92)' }}
                                    >
                                        {service.title}
                                    </h3>
                                    
                                    <p 
                                        className="leading-relaxed text-[11px] md:text-xs lg:text-sm line-clamp-2 md:line-clamp-3 font-medium"
                                        style={{ color: 'rgba(255,255,255,0.70)' }}
                                    >
                                        {service.desc}
                                    </p>
                                </div>
                            </div>
                        );
                    })}
                </div>
            </div>
        </div>
    );
}



================================================================================
FILE: .\components\sections\StatsSection.tsx
================================================================================

import { stats } from "@/data/staticData";
import AnimatedCounter from "@/components/ui/AnimatedCounter";
import SectionTitle from "@/components/ui/SectionTitle";

export default function StatsSection() {
    return (
        <section className="scroll-mt-24 min-h-[100svh] relative isolate flex flex-col items-center justify-start pt-16 md:pt-20 pb-8 text-white w-full overflow-visible">
            {/* High-priority Title Layer - Isolated from overlays and animations */}
            <div className="relative z-50 w-full mb-8 md:mb-12 isolate">
                <SectionTitle 
                    title="Strategic" 
                    highlight="Impact" 
                    highlightColor="text-accentPurple"
                    className="!opacity-100 !visible !block" 
                />
            </div>

            <div className="relative z-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-12 text-center w-full max-w-7xl px-4 md:px-6 mx-auto">
                {stats.map((item, i) => (
                    <AnimatedCounter key={i} value={item.val} label={item.label} />
                ))}
            </div>
        </section>
    );
}



================================================================================
FILE: .\components\sections\TeamSection.tsx
================================================================================

"use client";

import Image from "next/image";
import { team } from "@/data/staticData";
import SectionTitle from "@/components/ui/SectionTitle";
import { useGSAPFade } from "@/hooks/useGSAPFade";
import { usePopup } from "@/hooks/usePopup";
import { buildPopupFromTeamMember } from "@/lib/popupMappers";

export default function TeamSection() {
    const containerRef = useGSAPFade();
    const { openPopup } = usePopup();

    return (
        <div id="team" ref={containerRef} className="scroll-mt-24 min-h-[100svh] flex flex-col justify-start pt-16 md:pt-20 pb-8 px-4 md:px-6">
            <SectionTitle 
                title="Meet The" 
                highlight="Team" 
                highlightColor="text-accentPurple" 
            />
            <div className="grid grid-cols-2 md:flex md:flex-wrap justify-center gap-2 md:gap-6 lg:gap-10 max-w-7xl mx-auto w-full">
                {team.map((member, i) => (
                    <div
                        key={i}
                        onClick={() => openPopup(buildPopupFromTeamMember(member))}
                        className="fade-up group relative w-full md:w-[260px] lg:w-[350px] h-[280px] md:h-[380px] lg:h-[500px] rounded-xl md:rounded-3xl overflow-hidden transition-all duration-500 md:hover:scale-105 cursor-pointer"
                    >
                        <Image
                            src={member.image}
                            alt={member.name}
                            fill
                            className="object-cover object-top transition-all duration-500 grayscale-0 opacity-100 md:grayscale md:opacity-60 md:group-hover:grayscale-0 md:group-hover:opacity-100"
                            sizes="(max-width: 768px) 50vw, 350px"
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent flex flex-col justify-end p-4 md:p-6 lg:p-8 translate-y-0 md:translate-y-4 md:group-hover:translate-y-0 transition-transform duration-300 z-10">
                            <h3 className="text-lg md:text-2xl lg:text-3xl font-bold text-white mb-1 leading-tight">{member.name}</h3>
                            <p className="text-accentPurple font-medium tracking-wide text-xs md:text-base">{member.role}</p>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    );
}



================================================================================
FILE: .\components\sections\TestimonialsSection.tsx
================================================================================

"use client";

import React, { useState, useEffect, useCallback, useRef } from "react";
import { createPortal } from "react-dom";
import SectionTitle from "@/components/ui/SectionTitle";
import { useGSAPFade } from "@/hooks/useGSAPFade";
import { AnimatePresence, motion } from "framer-motion";
import { X, ChevronLeft, ChevronRight, Info } from "lucide-react";

// Data Structure
import { useRouter } from "next/navigation";
import { HIGHLIGHTS } from "@/data/stories";
import { usePageVisibility } from "@/hooks/usePageVisibility";

const IMG_DURATION = 4500;

export default function TestimonialsSection() {
    const containerRef = useGSAPFade();
    const router = useRouter();
    const [activeClient, setActiveClient] = useState<number | null>(null);
    const [activeStory, setActiveStory] = useState(0);
    const [isPaused, setIsPaused] = useState(false);
    const [seen, setSeen] = useState<Set<string>>(new Set());
    const [mounted, setMounted] = useState(false);
    const isPageActive = usePageVisibility();
    const timerRef = useRef<NodeJS.Timeout | null>(null);

    useEffect(() => {
        setMounted(true);
    }, []);

    // Close stories
    const closeStories = useCallback(() => {
        if (activeClient !== null) {
            setSeen(prev => new Set(prev).add(HIGHLIGHTS[activeClient].id));
        }
        setActiveClient(null);
        setActiveStory(0);
        setIsPaused(false);
    }, [activeClient]);

    // Next story logic
    const nextStory = useCallback(() => {
        if (activeClient === null) return;
        const currentHighlight = HIGHLIGHTS[activeClient];
        if (activeStory < currentHighlight.stories.length - 1) {
            setActiveStory(prev => prev + 1);
        } else {
            if (activeClient < HIGHLIGHTS.length - 1) {
                setSeen(prev => new Set(prev).add(HIGHLIGHTS[activeClient].id));
                setActiveClient(activeClient + 1);
                setActiveStory(0);
            } else {
                closeStories();
            }
        }
    }, [activeClient, activeStory, closeStories]);

    // Prev story logic
    const prevStory = useCallback(() => {
        if (activeStory > 0) {
            setActiveStory(prev => prev - 1);
        } else if (activeClient !== null && activeClient > 0) {
            setActiveClient(activeClient - 1);
            setActiveStory(HIGHLIGHTS[activeClient - 1].stories.length - 1);
        }
    }, [activeClient, activeStory]);

    // Timer logic
    useEffect(() => {
        if (activeClient !== null && !isPaused && isPageActive) {
            timerRef.current = setTimeout(nextStory, IMG_DURATION);
        }
        return () => {
            if (timerRef.current) clearTimeout(timerRef.current);
        };
    }, [activeClient, activeStory, isPaused, nextStory, isPageActive]);

    // Keyboard controls
    useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            if (activeClient === null) return;
            if (e.key === "Escape") closeStories();
            if (e.key === "ArrowRight") nextStory();
            if (e.key === "ArrowLeft") prevStory();
        };
        window.addEventListener("keydown", handleKeyDown);
        return () => window.removeEventListener("keydown", handleKeyDown);
    }, [activeClient, closeStories, nextStory, prevStory]);

    // Robust Body Scroll Lock
    useEffect(() => {
        if (activeClient !== null) {
            const originalStyle = window.getComputedStyle(document.body).overflow;
            document.body.style.overflow = "hidden";
            document.body.style.touchAction = "none"; // Extra lock for mobile
            return () => {
                document.body.style.overflow = originalStyle;
                document.body.style.touchAction = "";
            };
        }
    }, [activeClient]);

    const renderModal = () => {
        if (!mounted || activeClient === null) return null;

        return createPortal(
            <AnimatePresence>
                <div
                    className="fixed inset-0 z-[999999] flex items-center justify-center overflow-hidden overscroll-none touch-none bg-black md:bg-black/60 md:backdrop-blur-lg"
                    onClick={closeStories}
                >
                    {/* Cinematic Backdrop */}
                    <motion.div
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        className="absolute inset-0 cursor-pointer"
                    />

                    {/* Story Card Wrapper */}
                    <motion.div
                        initial={{ scale: 0.95, opacity: 0, y: 50 }}
                        animate={{ scale: 1, opacity: 1, y: 0 }}
                        exit={{ scale: 0.95, opacity: 0, y: 50 }}
                        transition={{ type: "spring", damping: 30, stiffness: 300 }}
                        onClick={(e) => e.stopPropagation()}
                        className="relative w-full h-[100dvh] md:w-[480px] md:h-[90vh] md:max-h-[950px] md:aspect-[9/16] bg-black md:rounded-[3rem] overflow-hidden shadow-[0_40px_100px_rgba(0,0,0,0.9)] md:border md:border-white/10"
                        onMouseDown={() => setIsPaused(true)}
                        onMouseUp={() => setIsPaused(false)}
                        onMouseLeave={() => setIsPaused(false)}
                        onTouchStart={() => setIsPaused(true)}
                        onTouchEnd={() => setIsPaused(false)}
                    >
                        {/* Media Layer */}
                        <div className="absolute inset-0 bg-black flex items-center justify-center">
                            <motion.img
                                key={`${activeClient}-${activeStory}`}
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                transition={{ duration: 0.3 }}
                                src={HIGHLIGHTS[activeClient].stories[activeStory].src}
                                alt="Story Content"
                                className="w-full h-full object-cover select-none pointer-events-none"
                            />
                            <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-black/40 z-10 pointer-events-none" />
                        </div>

                        {/* Top UI Overlay */}
                        <div className="absolute top-0 left-0 right-0 z-50 p-4 md:p-6 pt-10 md:pt-8 bg-gradient-to-b from-black/80 to-transparent pb-12">
                            {/* Progress Bars */}
                            <div className="flex gap-1.5 md:gap-2 mb-4 md:mb-6">
                                {HIGHLIGHTS[activeClient].stories.map((_, i) => (
                                    <div key={i} className="flex-1 h-[2px] md:h-[3px] bg-white/20 rounded-full overflow-hidden backdrop-blur-sm">
                                        <div
                                            className={`h-full bg-white transition-all linear shadow-[0_0_8px_rgba(255,255,255,0.4)]
                                                ${i <= activeStory ? 'w-full opacity-100' : 'w-0 opacity-30'}
                                                ${i === activeStory ? (isPaused ? 'duration-[99999s]' : 'duration-[4500ms]') : 'duration-0'}
                                            `}
                                        />
                                    </div>
                                ))}
                            </div>

                            {/* Header Info */}
                            <div className="flex items-center justify-between gap-3 text-white">
                                <div className="flex items-center gap-3">
                                    <div className="p-[2px] bg-gradient-to-tr from-[#f09433] to-[#bc1888] rounded-full shadow-lg">
                                        <img
                                            src={HIGHLIGHTS[activeClient].avatar}
                                            className="w-9 h-9 md:w-11 md:h-11 rounded-full border border-black/20 object-cover"
                                            alt="Avatar"
                                        />
                                    </div>
                                    <div>
                                        <p className="text-[14px] md:text-[15px] font-bold tracking-wide drop-shadow-md leading-tight">{HIGHLIGHTS[activeClient].name}</p>
                                        <p className="text-[11px] md:text-[12px] text-white/80 font-medium drop-shadow-sm">{HIGHLIGHTS[activeClient].sub}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={(e) => { e.stopPropagation(); closeStories(); }}
                                    className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 active:scale-90 backdrop-blur-md rounded-full transition-all border border-white/5 relative z-[60]"
                                    aria-label="Close"
                                >
                                    <X size={20} className="drop-shadow-lg" />
                                </button>
                            </div>
                        </div>

                        {/* Stealth Navigation Zones */}
                        <div className="absolute inset-0 z-30 flex">
                            <div
                                className="w-[35%] h-full cursor-pointer touch-manipulation active:bg-white/5 transition-colors"
                                onClick={(e) => { e.stopPropagation(); prevStory(); }}
                            />
                            <div className="flex-1 h-full" />
                            <div
                                className="w-[35%] h-full cursor-pointer touch-manipulation active:bg-white/5 transition-colors"
                                onClick={(e) => { e.stopPropagation(); nextStory(); }}
                            />
                        </div>

                        {/* Tag & Action Overlay */}
                        <div className="absolute bottom-[env(safe-area-inset-bottom,30px)] left-0 right-0 z-40 flex flex-col items-center gap-4 px-4 mb-4 md:mb-8">
                            <motion.div
                                key={`tag-${activeClient}-${activeStory}`}
                                initial={{ opacity: 0, y: 15 }}
                                animate={{ opacity: 1, y: 0 }}
                                className="inline-block px-6 py-2.5 rounded-full bg-black/30 backdrop-blur-lg border border-white/10 shadow-[0_10px_30px_rgba(0,0,0,0.5)]"
                            >
                                <span className="text-[12px] font-bold text-white tracking-widest uppercase">
                                    {HIGHLIGHTS[activeClient].stories[activeStory].tag}
                                </span>
                            </motion.div>

                            {HIGHLIGHTS[activeClient].projectSlug && (
                                <motion.button
                                    initial={{ opacity: 0, y: 10 }}
                                    animate={{ opacity: 1, y: 0 }}
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        const slug = HIGHLIGHTS[activeClient].projectSlug;
                                        closeStories();
                                        router.push(`/portfolio/${slug}`);
                                    }}
                                    className="flex items-center gap-2 px-8 py-4 bg-white text-black rounded-full font-bold text-sm hover:scale-105 active:scale-95 transition-all shadow-[0_15px_40px_rgba(255,255,255,0.2)]"
                                >
                                    <Info size={18} />
                                    View Project
                                </motion.button>
                            )}
                        </div>
                    </motion.div>

                    {/* Cinematic Navigation Arrows */}
                    <div className="hidden lg:flex absolute inset-0 items-center justify-between px-20 pointer-events-none z-[100]">
                        <motion.button
                            whileHover={{ scale: 1.1, x: -8 }}
                            whileTap={{ scale: 0.9 }}
                            onClick={(e) => { e.stopPropagation(); prevStory(); }}
                            className={`w-14 h-14 bg-white/5 hover:bg-white/10 border border-white/20 backdrop-blur-lg rounded-full flex items-center justify-center text-white pointer-events-auto transition-all shadow-2xl ${activeClient === 0 && activeStory === 0 ? "opacity-10 cursor-not-allowed" : "opacity-100"}`}
                        >
                            <ChevronLeft size={28} />
                        </motion.button>
                        <motion.button
                            whileHover={{ scale: 1.1, x: 8 }}
                            whileTap={{ scale: 0.9 }}
                            onClick={(e) => { e.stopPropagation(); nextStory(); }}
                            className="w-14 h-14 bg-white/5 hover:bg-white/10 border border-white/20 backdrop-blur-lg rounded-full flex items-center justify-center text-white pointer-events-auto transition-all shadow-2xl"
                        >
                            <ChevronRight size={28} />
                        </motion.button>
                    </div>
                </div>
            </AnimatePresence>,
            document.body
        );
    };

    return (
        <div id="testimonials" ref={containerRef} className="scroll-mt-24 min-h-[100svh] flex flex-col justify-start pt-16 md:pt-20 pb-8 px-4 md:px-6 relative z-10" dir="ltr">
            <SectionTitle title="Client" highlight="Stories" highlightColor="text-accentPurple" />

            {/* Highlights Row */}
            <div className="max-w-6xl w-full flex gap-4 md:gap-10 overflow-x-auto pb-8 md:pb-12 scrollbar-none px-2 md:px-4 justify-start md:justify-center items-center -mx-4 md:mx-auto">
                {HIGHLIGHTS.map((client, idx) => (
                    <button
                        key={client.id}
                        onClick={() => setActiveClient(idx)}
                        className="flex flex-col items-center gap-3 md:gap-4 group flex-shrink-0"
                        aria-label={`Watch ${client.name} stories`}
                        title={client.name}
                    >
                        <div className={`ring-container p-[3px] md:p-[4px] rounded-full transition-all duration-500 group-hover:scale-105 active:scale-95
                            ${seen.has(client.id) ? "seen opacity-50" : "unseen"}`}
                        >
                            <div className="w-[85px] h-[85px] md:w-[130px] md:h-[130px] rounded-full bg-black p-[2px] md:p-[3px] overflow-hidden relative">
                                <img
                                    src={client.avatar}
                                    alt={client.name}
                                    className="w-full h-full rounded-full object-cover transition-all duration-700 brightness-110 group-hover:brightness-125"
                                />
                                {seen.has(client.id) && (
                                    <div className="absolute inset-0 bg-black/40 backdrop-blur-[1px]" />
                                )}
                            </div>
                        </div>
                        <span className={`text-[16px] md:text-[20px] font-bold tracking-tight transition-all duration-300 ${seen.has(client.id) ? "text-gray-500" : "text-gray-300 group-hover:text-white"}`}>
                            {client.name}
                        </span>
                    </button>
                ))}
            </div>



            {renderModal()}

            <style jsx>{`
                .ring-container {
                    position: relative;
                }
                .ring-container.unseen {
                    background: conic-gradient(from 180deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888, #f09433);
                    box-shadow: 0 12px 35px rgba(220, 39, 67, 0.35);
                }
                .ring-container.seen {
                    background: rgba(255, 255, 255, 0.15);
                }
                .scrollbar-none::-webkit-scrollbar {
                    display: none;
                }
                .scrollbar-none {
                    -ms-overflow-style: none;
                    scrollbar-width: none;
                }
                @media (max-width: 768px) {
                    .ring-container.unseen {
                        box-shadow: 0 8px 20px rgba(220, 39, 67, 0.25);
                    }
                }
            `}</style>
        </div>
    );
}



================================================================================
FILE: .\components\sections\clients\HoloClientsScene.module.css
================================================================================

/* Scoped Styles for HoloClientsScene */

/* Container for the 3D Canvas */
.canvasContainer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    overflow: hidden;
    cursor: none; /* Hide default cursor ONLY inside this container */
    background: radial-gradient(circle at center, #0d0e22 0%, #09060f 100%); /* Local background matches global */
}

/* Screen FX (Scanlines + Vignette) - Absolute over canvas */
.screenFx {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 20;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
    background-size: 100% 4px;
    box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
    opacity: 0.6;
}

/* Drone Cursor - Scoped to container */
.cursor {
    position: absolute;
    top: 0;
    left: 0;
    width: 40px;
    height: 40px;
    pointer-events: none;
    z-index: 1000;
    transform: translate(-50%, -50%);
    mix-blend-mode: overlay;
    display: none; /* Hidden by default, shown via JS on desktop */
}

.cursorCircle {
    position: absolute;
    width: 100%;
    height: 100%;
    border: 1px solid rgba(160, 160, 255, 0.5);
    border-radius: 50%;
    animation: spin 4s linear infinite;
}

.cursorDot {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 4px;
    height: 4px;
    background: #fff;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 0 10px #fff;
}

.cursorText {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    color: #f2e9ff;
    white-space: nowrap;
    letter-spacing: 2px;
    font-weight: bold;
    text-shadow: 0 0 5px #f2e9ff;
}

/* Holo Interface (Overlay) */
.holoInterface {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    z-index: 50;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
}

.holoFrame {
    border: 1px solid rgba(160, 160, 255, 0.3);
    background: rgba(10, 10, 20, 0.6);
    backdrop-filter: blur(8px);
    padding: 30px 50px;
    clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%);
    position: relative;
    box-shadow: 0 0 30px rgba(160, 160, 255, 0.15);
    text-align: center;
}

/* Tech decorative corners */
.holoFrame::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 10px;
    height: 10px;
    border-top: 2px solid #f2e9ff;
    border-left: 2px solid #f2e9ff;
}

.holoFrame::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 10px;
    height: 10px;
    border-bottom: 2px solid #f2e9ff;
    border-right: 2px solid #f2e9ff;
}

.holoTitle {
    font-size: var(--fs-h2);
    font-weight: 700;
    color: white;
    text-transform: uppercase;
    margin: 0;
    text-shadow: 0 0 15px rgba(255,255,255,0.5);
    font-family: var(--font-outfit), sans-serif;
}

.holoSubtitle {
    font-size: 0.9rem;
    color: #f2e9ff;
    letter-spacing: 4px;
    margin-top: 8px;
    text-transform: uppercase;
    font-family: monospace;
}

.holoScan {
    width: 100%;
    height: 2px;
    background: #f2e9ff;
    margin-top: 15px;
    box-shadow: 0 0 10px #f2e9ff;
    animation: scanWidth 0.5s forwards;
}

/* System Status HUD */
.systemStatus {
    position: absolute;
    bottom: 20px;
    left: 20px;
    color: rgba(255,255,255,0.3);
    font-size: 10px;
    letter-spacing: 2px;
    font-family: monospace;
    z-index: 30;
    pointer-events: none;
    line-height: 1.5;
}

.blinking {
    animation: blink 1s infinite;
}

@keyframes spin { 0%{transform: rotate(0deg);} 100%{transform: rotate(360deg);} }
@keyframes scanWidth { from{width: 0;} to{width: 100%;} }
@keyframes blink { 50% { opacity: 0; } }



================================================================================
FILE: .\components\sections\clients\HoloClientsScene.tsx
================================================================================

"use client";

import React, { useEffect, useRef, useState } from 'react';
import * as THREE from 'three';
import gsap from 'gsap';
import { usePageVisibility } from '@/hooks/usePageVisibility';
import { safeDispose, disposeComposer, disposeRenderer } from '@/lib/three/safeDispose';
import { usePopup } from '@/hooks/usePopup';
import { buildPopupFromProject } from '@/lib/popupMappers';
import { projects } from '@/data/projects';
import { clients } from '@/data/clients';
import styles from './HoloClientsScene.module.css';

// Post-processing imports
// Allows for standard three.js / examples import structure
import { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js';
import { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js';
import { UnrealBloomPass } from 'three/examples/jsm/postprocessing/UnrealBloomPass.js';
import { FilmPass } from 'three/examples/jsm/postprocessing/FilmPass.js';
import { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js';
import { RGBShiftShader } from 'three/examples/jsm/shaders/RGBShiftShader.js';

// --- VISUAL CONFIG ---
const GLOW_CONFIG = {
    enabled: true,
    color: "rgba(168, 85, 247, 0.45)", // Subtle Purple
    cardAccent: "#a0a0ff",             // Indigo Accent
    bloomThreshold: 0.9,               // High threshold = less glow
    bloomStrength: 0.35,              // Subdued glow
    bloomRadius: 0.25,
    maxPixelRatio: 1.25
};

export default function HoloClientsScene() {
    const containerRef = useRef<HTMLDivElement>(null);
    const canvasRef = useRef<HTMLDivElement>(null);
    const cursorRef = useRef<HTMLDivElement>(null);
    const cursorTextRef = useRef<HTMLDivElement>(null);
    const cursorCircleRef = useRef<HTMLDivElement>(null);
    const holoRef = useRef<HTMLDivElement>(null);
    const titleRef = useRef<HTMLHeadingElement>(null);
    const subRef = useRef<HTMLDivElement>(null);
    const statusRef = useRef<HTMLDivElement>(null);

    const { openPopup } = usePopup();

    // Scene Refs
    const reqIdRef = useRef<number | null>(null);
    const isVisible = useRef(true);
    const sceneRefs = useRef<{
        scene: THREE.Scene;
        camera: THREE.PerspectiveCamera;
        renderer: THREE.WebGLRenderer;
        composer: EffectComposer;
        slates: THREE.Group[];
        rgbShift: ShaderPass;
        bloomPass: UnrealBloomPass;
        raycaster: THREE.Raycaster;
        mouse: THREE.Vector2;
        droneLight: THREE.PointLight;
        activeSlate: THREE.Group | null;
    } | null>(null);
    const isPageActive = usePageVisibility();

    useEffect(() => {
        if (!canvasRef.current || !containerRef.current) return;
        
        let alive = true;

        // --- 1. SETUP ---
        const scene = new THREE.Scene();
        // Dark fog for depth
        scene.fog = new THREE.FogExp2(0x050510, 0.015);

        const width = containerRef.current.clientWidth;
        const height = containerRef.current.clientHeight;

        const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
        camera.position.z = 50;

        const renderer = new THREE.WebGLRenderer({ 
            alpha: true, 
            antialias: false,
            powerPreference: "high-performance" 
        });
        renderer.setSize(width, height);

        // Safari Detection
        const isSafari = typeof navigator !== 'undefined' && /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

        // Performance first
        renderer.setPixelRatio(isSafari ? Math.min(window.devicePixelRatio, 1.2) : Math.min(window.devicePixelRatio, 1.25));
        renderer.toneMapping = THREE.ReinhardToneMapping;
        canvasRef.current.appendChild(renderer.domElement);

        // Visibility Observer
        const observer = new IntersectionObserver(
            ([entry]) => {
                isVisible.current = entry.isIntersecting;
                if (entry.isIntersecting && isPageActive && !reqIdRef.current) {
                    animate();
                }
            },
            { threshold: 0.1 }
        );
        observer.observe(containerRef.current);

        // --- 2. POST PROCESSING ---
        const composer = new EffectComposer(renderer);
        const renderPass = new RenderPass(scene, camera);
        composer.addPass(renderPass);

        // Bloom (Glow) - Recalibrated to remove white over-burn
        const bloomPass = new (UnrealBloomPass as any)(
            new THREE.Vector2(width, height), 
            GLOW_CONFIG.bloomStrength, 
            GLOW_CONFIG.bloomRadius, 
            GLOW_CONFIG.bloomThreshold
        );
        bloomPass.threshold = GLOW_CONFIG.bloomThreshold;
        bloomPass.strength = GLOW_CONFIG.bloomStrength;
        bloomPass.radius = GLOW_CONFIG.bloomRadius;
        composer.addPass(bloomPass);

        // Film Grain
        const filmPass = new (FilmPass as any)(0.35, 0.025, 648, false);
        composer.addPass(filmPass);

        // RGB Shift (Glitch)
        const rgbShift = new ShaderPass(RGBShiftShader);
        rgbShift.uniforms['amount'].value = 0.0015;
        composer.addPass(rgbShift);

        // --- 3. HELPERS ---
        // Texture Generator with Logo Support
        const createHoloCardTexture = (client: any, colorHex: string | number) => {
            const canvas = document.createElement('canvas');
            canvas.width = 512; 
            canvas.height = 512;
            const ctx = canvas.getContext('2d');
            // Create texture immediately
            const tex = new THREE.CanvasTexture(canvas);
            if(!ctx) return tex;

            const color = '#' + new THREE.Color(colorHex).getHexString();

            const draw = (img?: HTMLImageElement) => {
                ctx.clearRect(0,0,512,512);

                // 1. Neon Frame - Subtle Purple
                ctx.shadowBlur = 4;
                ctx.shadowColor = GLOW_CONFIG.color;
                ctx.strokeStyle = color;
                ctx.lineWidth = 6;
                ctx.strokeRect(50, 100, 412, 312);

                // 2. Content
                ctx.shadowBlur = 3;
                ctx.shadowColor = GLOW_CONFIG.color;
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                if (img) {
                    // Draw Logo - Contain Logic
                    const maxWidth = 350;
                    const maxHeight = 250;
                    const scale = Math.min(maxWidth / img.width, maxHeight / img.height);
                    const w = img.width * scale;
                    const h = img.height * scale;

                    // Save context to apply glow to image safely
                    ctx.save();
                    // Optional: Make logo monochromatic/white for true holo effect? 
                    // For now, let's keep original colors but add glow. 
                    // To make it truly "Holo", we often want it white/tinted.
                    // Let's try drawing it as-is but with screen blending or just reliance on the material.
                    
                    // Center
                    ctx.drawImage(img, 256 - w/2, 256 - h/2, w, h);
                    ctx.restore();
                } else {
                    // Fallback Text
                    const text = client.name || "CLIENT";
                    ctx.font = 'bold 50px Arial'; 
                    // Break text into lines if too long
                    const words = text.split(' ');
                    if(words.length > 1) {
                        ctx.fillText(words.slice(0, Math.ceil(words.length/2)).join(' '), 256, 236);
                        ctx.fillText(words.slice(Math.ceil(words.length/2)).join(' '), 256, 286);
                    } else {
                        ctx.fillText(text, 256, 256);
                    }
                }
                
                tex.needsUpdate = true;
            };

            // Initial render (Frame only)
            draw();

            // Load Image
            if (client.logo) {
                const img = new Image();
                img.crossOrigin = "Anonymous";
                img.src = client.logo;
                img.onload = () => {
                    if (!alive) return;
                    draw(img);
                };
            } else {
                // If no logo, we already drew the frame + (missing text logic in initial draw? fixed below)
                // Actually initial draw didn't have text. Let's redraw with text if no logo.
                draw(); 
            }

            return tex;
        };

        // --- 4. BUILD SLATES ---
        const slates: THREE.Group[] = [];
        const geometry = new THREE.PlaneGeometry(12, 7);
        const frameGeo = new THREE.BoxGeometry(12.5, 7.5, 0.5);
        const frameMat = new THREE.MeshStandardMaterial({ color: 0x222222, metalness: 0.9, roughness: 0.4 });
        
        // Grid setup
        const displayClients = clients.slice(0, 9); 
        const cols = 3;
        const spacingX = 16;
        const spacingY = 11;

        displayClients.forEach((client, i) => {
            const row = Math.floor(i / cols);
            const col = i % cols;
            
            const group = new THREE.Group();

            // Frame
            const frame = new THREE.Mesh(frameGeo, frameMat);
            group.add(frame);

            // Screen
            const tex = createHoloCardTexture(client, 0xa0a0ff); 
            
            const screenMat = new THREE.MeshBasicMaterial({
                map: tex,
                transparent: true,
                opacity: isSafari ? 0.7 : 0.85,
                blending: THREE.AdditiveBlending,
                side: THREE.FrontSide,
                alphaTest: 0.5,
                depthWrite: false
            });
            const screen = new THREE.Mesh(geometry, screenMat);
            screen.position.z = 0.3;
            group.add(screen);

            // Grid Layout Centered
            const x = (col - 1) * spacingX;
            const y = -(row - 1) * spacingY;
            const z = (Math.random() - 0.5) * 5; 

            group.position.set(x, y, z);

            group.userData = {
                originalPos: new THREE.Vector3(x, y, z),
                velocity: new THREE.Vector3(0,0,0),
                clientData: client,
                isHovered: false
            };

            scene.add(group);
            slates.push(group);
        });

        // --- 5. LIGHTING ---
        const droneLight = new THREE.PointLight(0xa0a0ff, 3, 50);
        scene.add(droneLight);
        
        const ambientLight = new THREE.AmbientLight(0x4040a0, 0.5);
        scene.add(ambientLight);

        // --- 6. INTERACTION STATE ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2(-999, -999); 

        // Store refs
        sceneRefs.current = {
            scene, camera, renderer, composer,
            slates, rgbShift, bloomPass, raycaster, mouse, droneLight,
            activeSlate: null
        };

        // --- 7. ANIMATION LOOP ---
        const animate = () => {
            if (!isVisible.current || !isPageActive) {
                reqIdRef.current = null;
                return;
            }
            reqIdRef.current = requestAnimationFrame(animate);

            const state = sceneRefs.current;
            if(!state) return;

            const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
            const time = (Date.now() * 0.001) * (prefersReducedMotion ? 0.3 : 1);

            // Update Slates Physics
            state.slates.forEach(group => {
                const data = group.userData;
                
                // Floating
                const floatY = Math.sin(time + group.position.x * 0.5) * 0.02;

                // Physics (Spring back to original)
                const targetX = data.originalPos.x;
                const targetY = data.originalPos.y + Math.sin(time + group.position.x)*0.3; 
                const targetZ = data.originalPos.z;

                data.velocity.x += (targetX - group.position.x) * 0.05;
                data.velocity.y += (targetY - group.position.y) * 0.05;
                data.velocity.z += (targetZ - group.position.z) * 0.05;

                // Damping
                data.velocity.multiplyScalar(0.9);
                group.position.add(data.velocity);

                // Rotation tracking mouse (Look At effect)
                const mouseX3D = state.mouse.x * 40; 
                const mouseY3D = state.mouse.y * 30;

                if (state.activeSlate !== group) {
                    group.rotation.x += ((mouseY3D * 0.01 - group.position.y * 0.05) * 0.05 - group.rotation.x) * 0.1;
                    group.rotation.y += ((mouseX3D * 0.01 - group.position.x * 0.05) * 0.05 - group.rotation.y) * 0.1;
                } else {
                    // Active/Hovered state
                    group.rotation.x += (0 - group.rotation.x) * 0.1;
                    group.rotation.y += (0 - group.rotation.y) * 0.1;
                    group.position.z += (15 - group.position.z) * 0.1; 
                }
            });

            // Random Glitch
            if (Math.random() > 0.99) {
                state.rgbShift.uniforms['amount'].value = 0.005;
            } else {
                state.rgbShift.uniforms['amount'].value = 0.0015;
            }

            // Move Light
            state.droneLight.position.x += ((state.mouse.x * 30) - state.droneLight.position.x) * 0.1;
            state.droneLight.position.y += ((state.mouse.y * 20) - state.droneLight.position.y) * 0.1;
            state.droneLight.position.z = 20;

            state.composer.render();
        };
        animate();

        // --- 8. EVENTS ---
        const onMouseMove = (e: MouseEvent) => {
            if(!canvasRef.current || !sceneRefs.current || !cursorRef.current) return;
            
            const rect = canvasRef.current.getBoundingClientRect();
            // Local mouse coordinates (-1 to 1) relative to container
            const x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
            const y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
            
            sceneRefs.current.mouse.set(x, y);

            // Update Custom Cursor (Visual only) using DOM
            // NOTE: Custom cursor follows mouse within container
            const cursorX = e.clientX - rect.left;
            const cursorY = e.clientY - rect.top;
            
            // Only show cursor if inside
            if (x >= -1 && x <= 1 && y >= -1 && y <= 1) {
                cursorRef.current.style.display = 'block';
                cursorRef.current.style.transform = `translate(${cursorX}px, ${cursorY}px) translate(-50%, -50%)`;
            } else {
                cursorRef.current.style.display = 'none';
            }

            // Raycasting
            sceneRefs.current.raycaster.setFromCamera(sceneRefs.current.mouse, sceneRefs.current.camera);
            
            // Intersect with frame/planes
            const targetObjects: THREE.Object3D[] = [];
            sceneRefs.current.slates.forEach(g => targetObjects.push(...g.children));

            const intersects = sceneRefs.current.raycaster.intersectObjects(targetObjects, false);

            if (intersects.length > 0) {
                const hit = intersects[0].object;
                const parentGroup = hit.parent as THREE.Group; 
                
                if (parentGroup && sceneRefs.current.activeSlate !== parentGroup) {
                    sceneRefs.current.activeSlate = parentGroup;
                    
                    // UI Updates via Refs
                    if(cursorTextRef.current) cursorTextRef.current.innerText = "DETECTED";
                    if(cursorCircleRef.current) cursorCircleRef.current.style.borderColor = "#a0a0ff";

                    if(holoRef.current && titleRef.current && subRef.current) {
                        holoRef.current.style.opacity = '1';
                        holoRef.current.style.visibility = 'visible';
                        // Safety check for title
                        const name = parentGroup.userData.clientData.name || "CLIENT";
                        const slug = parentGroup.userData.clientData.projectSlug || "SYSTEM PARTNER";
                        
                        titleRef.current.innerText = name;
                        subRef.current.innerText = slug;
                    }
                    
                    // Audio/Haptic FX
                     gsap.to(sceneRefs.current.rgbShift.uniforms['amount'], { value: 0.01, duration: 0.1, yoyo: true, repeat: 1 });
                }
            } else {
                if (sceneRefs.current.activeSlate) {
                    sceneRefs.current.activeSlate = null;
                    
                    if(cursorTextRef.current) cursorTextRef.current.innerText = "SCANNING";
                    if(cursorCircleRef.current) cursorCircleRef.current.style.borderColor = "rgba(160, 160, 255, 0.5)";

                    if(holoRef.current) {
                        holoRef.current.style.opacity = '0';
                        holoRef.current.style.visibility = 'hidden';
                    }
                }
            }
        };

        const onMouseDown = () => {
             if(cursorCircleRef.current) {
                  cursorCircleRef.current.style.transform = "scale(0.8)";
             }
             if(sceneRefs.current?.activeSlate) {
                 gsap.to(sceneRefs.current.bloomPass, { strength: 3, duration: 0.1, yoyo: true, repeat: 1 });
             }
        };

        const onMouseUp = () => {
             if(cursorCircleRef.current) {
                  cursorCircleRef.current.style.transform = "scale(1)";
             }
             // Click Logic
             if(sceneRefs.current?.activeSlate) {
                 const client = sceneRefs.current.activeSlate.userData.clientData;
                 
                 // Reuse existing logic from ClientMarquee
                 if (client.projectSlug) {
                    const project = projects.find(p => p.slug === client.projectSlug);
                    if (project) {
                        openPopup(buildPopupFromProject(project));
                        return;
                    }
                }
                const randomProject = projects[Math.floor(Math.random() * projects.length)];
                if (randomProject) {
                    openPopup(buildPopupFromProject(randomProject));
                }
             }
        };

        const handleResize = () => {
            if(!containerRef.current || !sceneRefs.current) return;
            const width = containerRef.current.clientWidth;
            const height = containerRef.current.clientHeight;
            
            sceneRefs.current.camera.aspect = width / height;
            sceneRefs.current.camera.updateProjectionMatrix();
            sceneRefs.current.renderer.setSize(width, height);
            sceneRefs.current.composer.setSize(width, height);
        };

        // Attach listeners
        containerRef.current.addEventListener('mousemove', onMouseMove);
        containerRef.current.addEventListener('mousedown', onMouseDown);
        containerRef.current.addEventListener('mouseup', onMouseUp);
        window.addEventListener('resize', handleResize);

        // --- CLEANUP ---
        return () => {
            alive = false;
            if(reqIdRef.current) cancelAnimationFrame(reqIdRef.current);
            observer.disconnect();
            window.removeEventListener('resize', handleResize);
            if(containerRef.current) {
                containerRef.current.removeEventListener('mousemove', onMouseMove);
                containerRef.current.removeEventListener('mousedown', onMouseDown);
                containerRef.current.removeEventListener('mouseup', onMouseUp);
            }
            
            // Dispose Three.js
            if(sceneRefs.current) {
                // kill GSAP tweens created in this component
                try { gsap.killTweensOf("*"); } catch {}

                // Composer + passes
                disposeComposer(sceneRefs.current.composer);

                // Dispose everything in scene (materials + maps + textures)
                safeDispose(sceneRefs.current.scene);
                sceneRefs.current.scene.clear();

                // Renderer
                disposeRenderer(sceneRefs.current.renderer, false);
            }
            if(canvasRef.current) {
                canvasRef.current.innerHTML = '';
            }
        };
    }, [isPageActive]); 

    // Restart loop when tab becomes active
    useEffect(() => {
        if (isPageActive && isVisible.current && !reqIdRef.current) {
            // Re-triggering the useEffect above by adding isPageActive to dependencies
        }
    }, [isPageActive]);

    return (
        <div ref={containerRef} className="relative w-full h-full min-h-[500px] overflow-visible">
            {/* Scoped Canvas */}
            <div ref={canvasRef} className={styles.canvasContainer} />

            {/* Drone Cursor (Scoped) */}
            <div ref={cursorRef} className={styles.cursor}>
                <div ref={cursorCircleRef} className={styles.cursorCircle} />
                <div className={styles.cursorDot} />
                <div ref={cursorTextRef} className={styles.cursorText}>SCANNING</div>
            </div>

            {/* Screen FX Overlay */}
            <div className={styles.screenFx} />

            {/* Holo Data Interface */}
            <div ref={holoRef} className={styles.holoInterface}>
                <div className={styles.holoFrame}>
                    <h1 ref={titleRef} className={styles.holoTitle}>CLIENT</h1>
                    <div ref={subRef} className={styles.holoSubtitle}>SYSTEM PARTNER</div>
                    <div className={styles.holoScan} />
                </div>
            </div>

            {/* System Status */}
            <div ref={statusRef} className={styles.systemStatus}>
                SYSTEM: ONLINE<br/>
                RENDER: QUANTUM CORE<br/>
                <span className={styles.blinking}>_WAITING FOR INPUT</span>
            </div>
        </div>
    );
}



================================================================================
FILE: .\components\sections\clients\OrbitalClientsScene.module.css
================================================================================

.sceneWrap {
    position: relative;
    width: 100%;
    height: 100%;
    min-height: 500px; /* Fallback */
    overflow: visible;
    /* Cursor handled via JS logic on the canvas container, but default is auto */
    cursor: auto;
}

.canvasContainer {
    position: absolute;
    inset: 0;
    z-index: 100;
}

/* Background UI (Dashed Circle + Label) - Scoped behind canvas */
.bgUI {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 0; /* Below everything */
    pointer-events: none;
    text-align: center;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.bgCircle {
    width: 600px;
    height: 600px;
    border: 1px dashed rgba(160, 160, 255, 0.1);
    border-radius: 50%;
    position: absolute;
    animation: spin 60s linear infinite;
    top: 50%;
    left: 50%;
    /* Transformation handled in animation, but need initial centering context */
    margin-left: -300px;
    margin-top: -300px;
}

.bgLabel {
    font-size: var(--fs-display);
    font-weight: 900;
    color: rgba(255, 255, 255, 0.02);
    line-height: 1;
    letter-spacing: -5px;
    white-space: nowrap;
    user-select: none;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Info Panel (Bottom Left) */
.infoPanel {
    position: absolute;
    bottom: 40px;
    left: 40px;
    z-index: 20; /* Above canvas */
    pointer-events: none;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
}

.infoPanelVisible {
    opacity: 1;
    transform: translateY(0);
}

.panelBox {
    background: rgba(10, 10, 20, 0.85);
    backdrop-filter: blur(12px);
    border-left: 3px solid #f2e9ff;
    padding: 20px 30px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    max-width: 350px;
    border-radius: 0 8px 8px 0;
}

.panelTitle {
    font-size: 1.8rem;
    font-weight: 700;
    margin: 0;
    color: white;
    text-transform: uppercase;
    line-height: 1.1;
    margin-bottom: 0.25rem;
}

.panelCategory {
    font-size: 0.75rem;
    color: #f2e9ff;
    letter-spacing: 0.15em;
    font-weight: 600;
    text-transform: uppercase;
    display: block;
    margin-bottom: 0.75rem;
}

.panelDesc {
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.6);
    line-height: 1.5;
    margin: 0;
}



================================================================================
FILE: .\components\sections\clients\OrbitalClientsScene.tsx
================================================================================

"use client";

import React, { useEffect, useRef, useState } from 'react';
import * as THREE from 'three';
import gsap from 'gsap';
import { usePageVisibility } from '@/hooks/usePageVisibility';
import { safeDispose, disposeRenderer } from '@/lib/three/safeDispose';
import { clients } from '@/data/clients';
import { projects } from '@/data/projects';
import { usePopup } from '@/hooks/usePopup';
import { buildPopupFromProject } from '@/lib/popupMappers';
import styles from './OrbitalClientsScene.module.css';

// --- VISUAL CONFIG ---
const VISUAL_CONFIG = {
    glowColor: "rgba(168, 85, 247, 0.35)", // Subtle Purple
    accentColor: "#f2e9ff",                // Light Accent
    cardOpacity: 0.85,
    shadowBlur: 3,                         // Minimal glow
    logoGlowOpacity: 0.25
};

export default function OrbitalClientsScene() {
    const containerRef = useRef<HTMLDivElement>(null);
    const canvasRef = useRef<HTMLDivElement>(null);
    const { openPopup } = usePopup();

    // UI Refs
    const infoPanelRef = useRef<HTMLDivElement>(null);
    const infoNameRef = useRef<HTMLHeadingElement>(null);
    const infoCatRef = useRef<HTMLSpanElement>(null);
    const infoDescRef = useRef<HTMLParagraphElement>(null);

    // Three.js State Refs
    const sceneRefs = useRef<{
        scene: THREE.Scene;
        camera: THREE.PerspectiveCamera;
        renderer: THREE.WebGLRenderer;
        items: THREE.Group[];
        stars: THREE.Points;
        raycaster: THREE.Raycaster;
        mouse: THREE.Vector2;
        hoveredItem: THREE.Group | null;
        isPaused: boolean;
        reqId: number | null;
        isVisible: boolean;
    } | null>(null);
    const isPageActive = usePageVisibility();

    useEffect(() => {
        if (!containerRef.current || !canvasRef.current) return;

        let alive = true;

        // --- 1. SETUP ---
        const scene = new THREE.Scene();
        // Dark fog to blend with section background
        scene.fog = new THREE.FogExp2(0x09060f, 0.002);

        const width = containerRef.current.clientWidth;
        const height = containerRef.current.clientHeight;

        const camera = new THREE.PerspectiveCamera(50, width / height, 0.1, 1000);
        camera.position.set(0, 10, 90);
        camera.lookAt(0, 0, 0);

        const renderer = new THREE.WebGLRenderer({ 
            alpha: true, 
            antialias: true,
            powerPreference: "high-performance"
        });
        renderer.setSize(width, height);

        // Safari detection
        const isSafari = typeof navigator !== 'undefined' && /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

        // Optimized pixel ratio: Safari on desktop often struggles with high-DPI + filters
        renderer.setPixelRatio(isSafari ? Math.min(window.devicePixelRatio, 1.25) : Math.min(window.devicePixelRatio, 1.5));
        canvasRef.current.appendChild(renderer.domElement);

        // Visibility Observer
        const observer = new IntersectionObserver(
            ([entry]) => {
                if (sceneRefs.current) {
                    sceneRefs.current.isVisible = entry.isIntersecting;
                    // Restart loop if it becomes visible and page is active
                    if (entry.isIntersecting && isPageActive && !sceneRefs.current.reqId) {
                        animate();
                    }
                }
            },
            { threshold: 0.1 }
        );
        observer.observe(containerRef.current);

        // --- 2. HELPERS ---
        
        // Helper to draw the card canvas
        const drawCardCanvas = (ctx: CanvasRenderingContext2D, text: string, color: string, img?: HTMLImageElement) => {
            const w = 512;
            const h = 512;

            ctx.clearRect(0, 0, w, h);

            // Glass Background
            ctx.fillStyle = `rgba(20, 20, 30, ${VISUAL_CONFIG.cardOpacity})`;
            // Rounded Rect manual
            if (ctx.roundRect) {
                ctx.beginPath();
                ctx.roundRect(10, 10, 492, 492, 40);
                ctx.fill();
            } else {
                ctx.fillRect(10, 10, 492, 492);
            }

            // Glowy Border - Use subtle config
            ctx.shadowBlur = VISUAL_CONFIG.shadowBlur;
            ctx.shadowColor = VISUAL_CONFIG.glowColor;
            ctx.strokeStyle = color;
            ctx.lineWidth = 8; // Slightly thinner edge
            if (ctx.roundRect) {
                ctx.beginPath();
                ctx.roundRect(10, 10, 492, 492, 40);
                ctx.stroke();
            } else {
                ctx.strokeRect(10, 10, 492, 492);
            }
            
            // Reset Shadow specifically for image/text clarity
            ctx.shadowBlur = 0;

            if (img) {
                 // Contain Image Logic
                 const maxWidth = 350;
                 const maxHeight = 250;
                 const scale = Math.min(maxWidth / img.width, maxHeight / img.height);
                 const logoW = img.width * scale;
                 const logoH = img.height * scale;

                 // Draw Logo
                 ctx.save();
                 // Safari + Universal Fix: No hard white halos
                 ctx.shadowBlur = VISUAL_CONFIG.shadowBlur;
                 ctx.shadowColor = VISUAL_CONFIG.glowColor;
                 ctx.drawImage(img, 256 - logoW/2, 256 - logoH/2, logoW, logoH);
                 ctx.restore();
            } else {
                // Text Fallback
                ctx.shadowBlur = VISUAL_CONFIG.shadowBlur;
                ctx.shadowColor = VISUAL_CONFIG.glowColor;
                ctx.font = 'bold 60px Arial';
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                const words = text.split(' ');
                if (words.length > 1) {
                    ctx.fillText(words.slice(0, Math.ceil(words.length/2)).join(' '), 256, 220);
                    ctx.fillText(words.slice(Math.ceil(words.length/2)).join(' '), 256, 290);
                } else {
                    ctx.fillText(text, 256, 256);
                }
            }

            // Bottom Label "PARTNER"
            ctx.shadowBlur = 0;
            ctx.font = 'bold 30px Arial';
            ctx.fillStyle = color;
            ctx.textAlign = 'center';
            ctx.fillText("PARTNER", 256, 420);
        };

        const createCardTexture = (client: any) => {
            const canvas = document.createElement('canvas');
            canvas.width = 512; 
            canvas.height = 512;
            const ctx = canvas.getContext('2d');
            const tex = new THREE.CanvasTexture(canvas);
            tex.anisotropy = renderer.capabilities.getMaxAnisotropy();
            
            if (!ctx) return tex;

            const color = "#a0a0ff"; 

            // Initial Draw
            drawCardCanvas(ctx, client.name || "CLIENT", color);

            // Load Image async
            if (client.logo) {
                const img = new Image();
                img.crossOrigin = "Anonymous";
                img.src = client.logo;
                img.onload = () => {
                    if (!alive) return;
                    drawCardCanvas(ctx, client.name, color, img);
                    tex.needsUpdate = true;
                };
            }

            return tex;
        };

        const createGlowSprite = (color: string) => {
            const canvas = document.createElement('canvas');
            canvas.width = 64; canvas.height = 64;
            const ctx = canvas.getContext('2d');
            if(ctx) {
                const gradient = ctx.createRadialGradient(32,32,0, 32,32,32);
                gradient.addColorStop(0, color);
                gradient.addColorStop(1, 'rgba(0,0,0,0)');
                ctx.fillStyle = gradient;
                ctx.fillRect(0,0,64,64);
            }
            
            const tex = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({ 
                map: tex, 
                transparent: true, 
                opacity: isSafari ? 0.35 : 0.5,
                blending: THREE.AdditiveBlending,
                depthWrite: false // <---  :      
            });
            return new THREE.Sprite(material);
        };

        // --- 3. BUILD ORBITS ---
        const mainGroup = new THREE.Group();
        scene.add(mainGroup);

        const items: THREE.Group[] = [];
        const radiusStep = 22; 
        
        // REUSE GEOMETRY
        const cardGeometry = new THREE.PlaneGeometry(8, 8);
        const glowGeometry = new THREE.PlaneGeometry(22, 22);

        let clientIndex = 0;
        const ringCounts = [4, 8]; 
        
        ringCounts.forEach((count, ringIndex) => {
            const radius = (ringIndex + 1.2) * radiusStep;
            
            let ringCount = count;
            if (ringIndex === ringCounts.length - 1) {
                ringCount = Math.max(count, clients.length - clientIndex);
            }
            
            for(let i=0; i < ringCount; i++) {
                if (clientIndex >= clients.length) break;
                
                const client = clients[clientIndex];
                const angle = (i / ringCount) * Math.PI * 2;

                const itemGroup = new THREE.Group();

                // 1. Card Mesh
                const tex = createCardTexture(client);
                const material = new THREE.MeshBasicMaterial({ 
                    map: tex,
                    transparent: true,
                    side: THREE.DoubleSide,
                    alphaTest: 0.5,
                    depthWrite: true
                });

                const mesh = new THREE.Mesh(cardGeometry, material);
                itemGroup.add(mesh);

                // 2. Glow Sprite
                const glow = createGlowSprite(VISUAL_CONFIG.glowColor);
                glow.scale.set(22, 22, 1);
                glow.position.z = -0.5; //   
                itemGroup.add(glow);

                // initial position on ring
                itemGroup.position.set(
                    Math.cos(angle) * radius,
                    0,
                    Math.sin(angle) * radius
                );

                itemGroup.userData = {
                    angle: angle,
                    radius: radius,
                    speed: (ringIndex % 2 === 0 ? 0.15 : -0.10) * (1 / (ringIndex + 0.5)),
                    yOffset: Math.random() * 100,
                    clientData: client,
                    originalScale: 1
                };

                mainGroup.add(itemGroup);
                items.push(itemGroup);
                clientIndex++;
            }
        });

        // --- 4. STARS ---
        const starsGeo = new THREE.BufferGeometry();
        const starCount = 800;
        const starPos = new Float32Array(starCount * 3);
        for(let i=0; i<starCount*3; i++) {
            starPos[i] = (Math.random() - 0.5) * 350;
        }
        starsGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
        const starsMat = new THREE.PointsMaterial({
            color: 0x8888cc, 
            size: 0.6, 
            transparent: true, 
            opacity: 0.4,
            depthWrite: false //    
        });
        const stars = new THREE.Points(starsGeo, starsMat);
        scene.add(stars);

        // --- 5. INTERACTION UTILS ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2(-999, -999);

        // Store refs
        sceneRefs.current = {
            scene, camera, renderer, items, stars, raycaster, mouse,
            hoveredItem: null, isPaused: false, reqId: null, isVisible: true
        };

        // --- 6. ANIMATION LOOP ---
        const animate = () => {
            const r = sceneRefs.current;
            if(!r || !alive) return;
            
            if (!r.isVisible || !isPageActive) {
                r.reqId = null;
                return;
            }
            r.reqId = requestAnimationFrame(animate);

            const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
            const time = (Date.now() * 0.001) * (prefersReducedMotion ? 0.3 : 1);

            // Rotate stars slowly
            r.stars.rotation.y = time * 0.03;

            // Orbit Items
            r.items.forEach(item => {
                // Ensure card always faces camera (Billboard)
                item.lookAt(r.camera.position);

                if (item !== r.hoveredItem) {
                    const data = item.userData;
                    
                    if (!r.isPaused) {
                        data.angle += data.speed * 0.01;
                    }

                    const x = Math.cos(data.angle) * data.radius;
                    const z = Math.sin(data.angle) * data.radius;
                    const y = Math.sin(time + data.yOffset) * 1.5;

                    item.position.set(x, y, z);
                }
            });

            // Camera Parallax with mouse (subtle)
            const parallaxX = r.mouse.x * 5;
            const parallaxY = r.mouse.y * 5 + 10; 
            
            r.camera.position.x += (parallaxX - r.camera.position.x) * 0.05;
            r.camera.position.y += (parallaxY - r.camera.position.y) * 0.05;
            r.camera.lookAt(0,0,0);

            r.renderer.render(r.scene, r.camera);
        };
        
        animate();

        // --- 7. EVENT HANDLERS ---
        const onMouseMove = (e: MouseEvent) => {
            if(!canvasRef.current || !sceneRefs.current) return;
            const state = sceneRefs.current;

            const rect = canvasRef.current.getBoundingClientRect();
            const x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
            const y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
            
            state.mouse.set(x, y);

            // Raycast
            state.raycaster.setFromCamera(state.mouse, state.camera);
            // Intersect only the mesh children of the groups
            const meshes = state.items.map(g => g.children[0]);
            const intersects = state.raycaster.intersectObjects(meshes, false);

            if (intersects.length > 0) {
                const object = intersects[0].object.parent as THREE.Group;
                
                if (state.hoveredItem !== object) {
                    // Unhover previous
                    if (state.hoveredItem) {
                        gsap.to(state.hoveredItem.scale, { x: 1, y: 1, z: 1, duration: 0.3 });
                    }

                    state.hoveredItem = object;
                    state.isPaused = true;
                    if(containerRef.current) containerRef.current.style.cursor = 'pointer';

                    // Scale Up
                    gsap.to(object.scale, { x: 1.5, y: 1.5, z: 1.5, duration: 0.4, ease: "back.out(1.7)" });
                    
                    // Show UI
                    if (infoPanelRef.current) {
                         const client = object.userData.clientData;
                         if(infoNameRef.current) infoNameRef.current.innerText = client.name || "CLIENT";
                         if(infoCatRef.current) infoCatRef.current.innerText = "PARTNER"; 
                         if(infoDescRef.current) infoDescRef.current.innerText = client.projectSlug ? "View Case Study //" : "Strategic Partner";

                         infoPanelRef.current.classList.add(styles.infoPanelVisible);
                    }
                }
            } else {
                if (state.hoveredItem) {
                    gsap.to(state.hoveredItem.scale, { x: 1, y: 1, z: 1, duration: 0.3 });
                    state.hoveredItem = null;
                    state.isPaused = false;
                    if(containerRef.current) containerRef.current.style.cursor = 'auto';
                    if (infoPanelRef.current) {
                        infoPanelRef.current.classList.remove(styles.infoPanelVisible);
                    }
                }
            }
        };

        const onClick = (e: MouseEvent) => {
            if(!sceneRefs.current || !sceneRefs.current.hoveredItem) return;
            const client = sceneRefs.current.hoveredItem.userData.clientData;
            
            if (client.projectSlug) {
                const project = projects.find(p => p.slug === client.projectSlug);
                if(project) {
                    openPopup(buildPopupFromProject(project));
                    return;
                }
            }
            // Fallback random
            const randomProject = projects[Math.floor(Math.random() * projects.length)];
            if(randomProject) openPopup(buildPopupFromProject(randomProject));
        };

        const onResize = () => {
            if(!sceneRefs.current || !containerRef.current) return;
            const w = containerRef.current.clientWidth;
            const h = containerRef.current.clientHeight;
            sceneRefs.current.camera.aspect = w / h;
            sceneRefs.current.camera.updateProjectionMatrix();
            sceneRefs.current.renderer.setSize(w, h);
        };

        // Bind Events
        const el = containerRef.current;
        el.addEventListener('mousemove', onMouseMove);
        el.addEventListener('click', onClick);
        window.addEventListener('resize', onResize);

        // --- CLEANUP ---
        return () => {
            alive = false;
            if(sceneRefs.current?.reqId) cancelAnimationFrame(sceneRefs.current.reqId);
            observer.disconnect();
            window.removeEventListener('resize', onResize);
            el.removeEventListener('mousemove', onMouseMove);
            el.removeEventListener('click', onClick);

            if(sceneRefs.current) {
                // Kill any lingering GSAP tweens touching scene objects
                try { gsap.killTweensOf("*"); } catch {}

                // Dispose all geometries/materials/textures inside the scene
                safeDispose(sceneRefs.current.scene);

                // Remove objects to drop refs
                sceneRefs.current.scene.clear();

                // Renderer cleanup
                disposeRenderer(sceneRefs.current.renderer, false);
            }
            if(canvasRef.current) canvasRef.current.innerHTML = '';
        };
    }, [openPopup, isPageActive]);

    // Restart loop when tab becomes active
    useEffect(() => {
        if (isPageActive && sceneRefs.current?.isVisible && !sceneRefs.current?.reqId) {
            // Re-triggering the useEffect above by adding isPageActive to dependencies 
            // is the cleanest way or we can call the local animate if exposed.
            // Since animate is local, the best way is to include isPageActive in the dependency array.
        }
    }, [isPageActive]);

    return (
        <div ref={containerRef} className={styles.sceneWrap}>
            {/* BG UI */}
            <div className={styles.bgUI}>
                <div className={styles.bgCircle}></div>
                <div className={styles.bgLabel}>PARTNERS</div>
            </div>

            {/* Canvas Container */}
            <div ref={canvasRef} className={styles.canvasContainer} />

            {/* Info Panel Overlay */}
            <div ref={infoPanelRef} className={styles.infoPanel}>
                <div className={styles.panelBox}>
                    <span ref={infoCatRef} className={styles.panelCategory}>TECHNOLOGY</span>
                    <h2 ref={infoNameRef} className={styles.panelTitle}>Client Name</h2>
                    <p ref={infoDescRef} className={styles.panelDesc}>Strategic partnership focused on digital transformation.</p>
                </div>
            </div>
        </div>
    );
}



================================================================================
FILE: .\components\sections\WorksTunnel\WorksTunnel.module.css
================================================================================

.container {
    position: relative;
    width: 100%;
    /* 500vh to ensure long scroll duration as requested */
    height: 500vh;
    background: transparent;
    z-index: 10;
}

.sceneWrapper {
    position: sticky;
    top: 0;
    width: 100%;
    height: 100vh;
    perspective: 1200px;
    /* Slightly deeper perspective for floating assets */
    perspective-origin: 50% 50%;
    overflow: hidden;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    transition: opacity 0.5s ease;
}

.sceneActive {
    pointer-events: auto;
    opacity: 1;
}

.sceneHidden {
    pointer-events: none;
    opacity: 0;
}

.stack {
    position: relative;
    width: 0;
    height: 0;
    transform-style: preserve-3d;
    will-change: transform;
}

.ring {
    position: absolute;
    top: 0;
    left: 0;
    transform-style: preserve-3d;
    will-change: transform;
    --radius: 300px;
}

/* The Ring Outline - Very subtle for floating look */
.ring::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;
    width: calc(var(--radius) * 2.2);
    height: calc(var(--radius) * 2.2);
    transform: translate(-50%, -50%);
    border-radius: 50%;
    border: 1px solid rgba(112, 0, 255, 0.1);
    pointer-events: none;
}

.panel {
    position: absolute;
    left: 50%;
    top: 50%;
    /* Increased size slightly for floating assets */
    width: 200px;
    height: 200px;
    transform-style: preserve-3d;
    backface-visibility: visible;
    cursor: pointer;
    will-change: transform, opacity;
    transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
}

/* Floating Wrapper: No more card/background/border */
.thumb {
    width: 100%;
    height: 100%;
    position: relative;
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    overflow: visible;
    /* Allow drop shadows to bleed out */
}

/* REMOVED: .thumb::after grayscale overlay for max transparency/clarity */

.img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    /* Don't crop transparent art */
    transition: transform 0.5s ease, filter 0.5s ease;
    /* Clean drop shadow to help floating assets stand out */
    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.5));
}

/* Active / Hover States */
.panel:hover {
    z-index: 100 !important;
}

.panel:hover .thumb {
    transform: scale(1.2) translateZ(40px);
}

.panel:hover .img {
    transform: scale(1.05);
    /* Purple glow on hover for the image itself */
    filter: drop-shadow(0 0 25px rgba(112, 0, 255, 0.4));
}

.panel:active .thumb {
    transform: scale(0.95);
}

/* Central Element (Logo/Brand) */
.centerBrand {
    position: absolute;
    left: 50%;
    top: 50%;
    transform-style: preserve-3d;
    transform: translate(-50%, -50%);
    width: 200px;
    height: 200px;
    display: grid;
    place-items: center;
    z-index: 50;
    pointer-events: none;
    will-change: transform;
}

.logoWrapper {
    position: relative;
    width: 120px;
    height: 120px;
    filter: drop-shadow(0 0 30px rgba(112, 0, 255, 0.3));
}

.logoImg {
    object-fit: contain;
}

/* ========================================= */
/* OVERLAY STYLES (Glassmorphism)            */
/* ========================================= */
.overlay {
    position: fixed;
    inset: 0;
    background: rgba(5, 5, 5, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    opacity: 0;
    pointer-events: none;
    -webkit-backdrop-filter: blur(16px);
    backdrop-filter: blur(16px);
}

.overlayActive {
    opacity: 1;
    pointer-events: all;
}

.card {
    background: rgba(20, 20, 20, 0.6);
    padding: 60px;
    border-radius: 32px;
    max-width: 800px;
    width: 90%;
    color: #fff;
    border: 1px solid rgba(112, 0, 255, 0.2);
    box-shadow: 0 50px 150px rgba(0, 0, 0, 0.8),
        0 0 60px rgba(112, 0, 255, 0.1);
    transform: scale(0.9) translateY(40px);
    opacity: 0;
    position: relative;
    max-height: 90vh;
    overflow-y: auto;
    overflow-x: hidden;
}

.cardTitle {
    margin: 0 0 12px;
    font-size: clamp(32px, 5vw, 64px);
    font-weight: 900;
    line-height: 1.0;
    background: linear-gradient(135deg, #fff 0%, #7000ff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -0.03em;
}

.cardSubtitle {
    margin: 0 0 24px;
    font-size: 16px;
    color: #ff00cc;
    text-transform: uppercase;
    letter-spacing: 0.2em;
    font-weight: 600;
}

.cardDesc {
    margin: 0 0 40px;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.8;
    font-size: 18px;
    font-weight: 300;
    max-width: 90%;
}

.socials {
    display: flex;
    gap: 16px;
    margin-bottom: 32px;
}

.socialBtn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 56px;
    height: 56px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.socialBtn:hover {
    background: #7000ff;
    transform: translateY(-4px);
    border-color: #7000ff;
    color: #fff;
    box-shadow: 0 10px 20px rgba(112, 0, 255, 0.3);
}

.closeBtn {
    width: 100%;
    padding: 18px;
    border: none;
    background: #fff;
    color: #000;
    cursor: pointer;
    border-radius: 16px;
    font-weight: 800;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    font-size: 14px;
}

.closeBtn:hover {
    background: #ff00cc;
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255, 0, 204, 0.3);
}

@media (max-width: 768px) {
    .container {
        height: 350vh;
    }

    .panel {
        width: 140px;
        height: 140px;
    }

    .card {
        padding: 30px 24px;
        width: 95%;
        border-radius: 24px;
    }

    .cardTitle {
        font-size: 32px;
    }

    .cardDesc {
        font-size: 16px;
        margin-bottom: 30px;
    }

    .centerBrand {
        width: 120px;
        height: 120px;
    }
}


================================================================================
FILE: .\components\sections\WorksTunnel\WorksTunnel.tsx
================================================================================

"use client";

import React, { useEffect, useRef, useState, useMemo } from 'react';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import styles from './WorksTunnel.module.css';
import { projects } from '@/data/projects';
import { usePopup } from '@/hooks/usePopup';
import { buildPopupFromProject } from '@/lib/popupMappers';
import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';
import gsap from 'gsap';
import { usePageVisibility } from '@/hooks/usePageVisibility';

// --- UTILS ---
function cn(...inputs: ClassValue[]) {
    return twMerge(clsx(inputs));
}

const clamp = (v: number, min: number, max: number) => Math.max(min, Math.min(max, v));
const lerp = (a: number, b: number, t: number) => a + (b - a) * t;
function easeInOutCubic(t: number) { return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1; }

import { Project } from '@/types/project';

// --- CONFIG ---
const IMAGES_PER_RING = 6;
const TILT_X = 12;
const AUTO_SPEED = 0.012;

const WorksTunnel: React.FC = () => {
    const router = useRouter();
    const { openPopup } = usePopup();
    const isPageActive = usePageVisibility();
    // --- STATE ---
    const [isSceneVisible, setIsSceneVisible] = useState(false);

    // UI Refs
    const containerRef = useRef<HTMLDivElement>(null);
    const sceneRef = useRef<HTMLDivElement>(null);
    const stackRef = useRef<HTMLDivElement>(null);
    const logoRef = useRef<HTMLDivElement>(null);

    // Animation Refs
    const requestRef = useRef<number>();
    const timeRef = useRef(0);
    const pSmoothRef = useRef(0);
    const logoRotRef = useRef(0);

    const ringRefs = useRef<(HTMLDivElement | null)[]>([]);
    const cardRefs = useRef<(HTMLDivElement | null)[][]>([]);

    const dims = useRef({
        radius: 300,
        ringSpacing: 280
    });

    // --- LOGIC: DUPLICATE WORKS FOR DENSITY ---
    const massiveWorks = useMemo(() => {
        if (!projects || projects.length === 0) return [];
        return [...projects, ...projects, ...projects];
    }, []);

    const numRings = Math.ceil(massiveWorks.length / IMAGES_PER_RING);
    const centerIndex = (numRings - 1) / 2;

    const ringsData = useMemo(() => {
        return Array.from({ length: numRings }).map((_, rIndex) => {
            const ringStart = rIndex * IMAGES_PER_RING;
            const ringWorks = massiveWorks.slice(ringStart, ringStart + IMAGES_PER_RING);
            return { index: rIndex, works: ringWorks };
        });
    }, [numRings, massiveWorks]);

    // Visibility Observer (Better performance than setState in loop)
    useEffect(() => {
        if (!containerRef.current) return;
        const observer = new IntersectionObserver(
            ([entry]) => {
                setIsSceneVisible(entry.isIntersecting);
            },
            { threshold: 0 }
        );
        observer.observe(containerRef.current);
        return () => observer.disconnect();
    }, []);

    // --- OVERLAY ANIMATION REMOVED (NOW USING UNIFIED POPUP) ---

    useEffect(() => {
        // Init Refs
        ringRefs.current = ringRefs.current.slice(0, numRings);
        cardRefs.current = cardRefs.current.slice(0, numRings);

        const handleResize = () => {
            if (typeof window === 'undefined') return;
            const isMobile = window.innerWidth < 520;
            dims.current.radius = isMobile ? 160 : 300;
            dims.current.ringSpacing = isMobile ? 200 : 280;

            ringRefs.current.forEach(r => {
                if (r) r.style.setProperty('--radius', `${dims.current.radius}px`);
            });
        };
        handleResize();
        window.addEventListener('resize', handleResize);

        const tick = () => {
            if (!containerRef.current || !stackRef.current || !isPageActive) {
                requestRef.current = undefined;
                return;
            }

            const rect = containerRef.current.getBoundingClientRect();
            const winHeight = window.innerHeight;
            const total = rect.height - winHeight;

            let p = 0;
            if (total > 0) {
                const scrolled = clamp(-rect.top, 0, total);
                p = scrolled / total;
            }

            const prefersReducedMotion = typeof window !== 'undefined' && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
            
            timeRef.current += prefersReducedMotion ? AUTO_SPEED * 0.2 : AUTO_SPEED;
            pSmoothRef.current += (p - pSmoothRef.current) * (prefersReducedMotion ? 0.01 : 0.04);

            const t = easeInOutCubic(pSmoothRef.current);
            const idxFloat = t * (numRings - 1);
            const idx = Math.floor(idxFloat);
            const frac = idxFloat - idx;

            const curY = (idx - centerIndex) * dims.current.ringSpacing;
            const nextY = ((Math.min(idx + 1, numRings - 1)) - centerIndex) * dims.current.ringSpacing;
            const stackY = -lerp(curY, nextY, frac);
            const globalScale = Math.min(1, window.innerWidth / 600);

            stackRef.current.style.transform = `translate3d(0, ${stackY}px, 0) rotateX(${TILT_X}deg) scale(${globalScale})`;

            if (logoRef.current) {
                logoRotRef.current += 0.3;
                const logoOffsetY = -stackY * 0.9;
                logoRef.current.style.transform = `translate3d(-50%, calc(-50% + ${logoOffsetY}px), 0) rotateY(${logoRotRef.current}deg)`;
            }

            const scrollRot = t * 240;
            const breathing = Math.sin(timeRef.current * 0.5) * 10;
            const dynamicRadius = dims.current.radius + breathing + (Math.abs(p - pSmoothRef.current) * 100);

            ringRefs.current.forEach((ring, r) => {
                if (!ring) return;

                const y = (r - centerIndex) * dims.current.ringSpacing;
                const z = (r - centerIndex) * 40;
                const dist = Math.abs(r - idxFloat);
                let ringScale = 1;
                if (dist < 1.5) ringScale = lerp(1.15, 1.0, dist / 1.5);

                const direction = (r % 2 === 0) ? 1 : -1;
                const finalRot = (timeRef.current * 8 * direction) + (scrollRot * direction) + (r * 10);

                ring.style.transform = `translate3d(0, ${y}px, ${z}px) rotateY(${finalRot}deg) scale(${ringScale})`;

                const ringCards = cardRefs.current[r];
                if (ringCards) {
                    ringCards.forEach((card, cIndex) => {
                        if (!card) return;
                        const step = 360 / IMAGES_PER_RING;
                        const angle = cIndex * step;
                        const rad = (finalRot + angle) * Math.PI / 180;
                        const depth = Math.cos(rad);

                        card.style.transform = `translate(-50%, -50%) rotateY(${angle}deg) translateZ(${dynamicRadius}px)`;

                        if (depth < -0.2) {
                            card.style.opacity = '0.3';
                            card.style.zIndex = '0';
                        } else {
                            card.style.opacity = '1';
                            card.style.zIndex = '10';
                        }
                    });
                }
            });

            if (isSceneVisible) {
                requestRef.current = requestAnimationFrame(tick);
            }
        };

        if (isSceneVisible) {
            requestRef.current = requestAnimationFrame(tick);
        }

        return () => {
            window.removeEventListener('resize', handleResize);
            if (requestRef.current) cancelAnimationFrame(requestRef.current);
        };
    }, [numRings, centerIndex, isSceneVisible, isPageActive]);


    return (
        <section id="portfolio" ref={containerRef} className={cn(styles.container, "scroll-mt-20")}>
            <div
                ref={sceneRef}
                className={cn(styles.sceneWrapper, isSceneVisible ? styles.sceneActive : styles.sceneHidden)}
            >
                <div ref={stackRef} className={styles.stack}>
                    <div ref={logoRef} className={styles.centerBrand}>
                        <div className={styles.logoWrapper}>
                            <Image
                                src="/logos/Inkspire logos/logo.svg"
                                alt="Inkspire Logo"
                                fill
                                className={styles.logoImg}
                            />
                        </div>
                    </div>

                    {ringsData.map((ring) => (
                        <div
                            key={ring.index}
                            className={styles.ring}
                            ref={el => { ringRefs.current[ring.index] = el; }}
                        >
                            {ring.works.map((work, wIndex) => (
                                <div
                                    key={`${work.id}-${ring.index}-${wIndex}`}
                                    className={styles.panel}
                                    ref={el => {
                                        if (!cardRefs.current[ring.index]) cardRefs.current[ring.index] = [];
                                        cardRefs.current[ring.index][wIndex] = el;
                                    }}
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        openPopup(buildPopupFromProject(work));
                                    }}
                                >
                                    <div className={styles.thumb}>
                                        <Image
                                            src={work.coverImage || "/works/placeholder.webp"}
                                            alt={work.title}
                                            className={styles.img}
                                            fill
                                            sizes="(max-width: 768px) 90vw, 800px"
                                            quality={80}
                                        />
                                    </div>
                                </div>
                            ))}
                        </div>
                    ))}
                </div>
            </div>
        </section>
    );
};

export default WorksTunnel;



================================================================================
FILE: .\components\tunnel\TunnelBackground.tsx
================================================================================

"use client";

import { useEffect, useRef } from "react";
import * as THREE from "three";
import gsap from "gsap";
import { usePageVisibility } from "@/hooks/usePageVisibility";

interface TunnelBackgroundProps {
    sectionIndex: number;
}

// --- SHADERS ---
const vertexShader = `
    uniform float uTime;
    uniform float uSpeed;

    attribute float aZStart;
    attribute float aSpeedOffset;

    varying vec3 vColor;
    varying float vOpacity;

    void main() {
        // Calculate dynamic Z with looping
        // Range: -3000 to 200 (Total 3200)
        float z = aZStart + uTime * uSpeed * aSpeedOffset;
        float rawZ = z + 3000.0;
        float loopedZ = mod(rawZ, 3200.0) - 3000.0;

        // Apply to instance matrix (replace existing Z translation)
        mat4 instanceMat = instanceMatrix;
        instanceMat[3][2] = loopedZ;

        vec4 mvPosition = modelViewMatrix * instanceMat * vec4(position, 1.0);
        gl_Position = projectionMatrix * mvPosition;

        vColor = instanceColor;
        
        // Dynamic opacity based on Z depth for "ghostly" feel
        // -3000 (0 opacity) -> 200 (max opacity)
        vOpacity = clamp((loopedZ + 3000.0) / 3200.0, 0.0, 1.0) * 0.15;
    }
`;

const fragmentShader = `
    varying vec3 vColor;
    varying float vOpacity;

    void main() {
        gl_FragColor = vec4(vColor, vOpacity);
    }
`;

export default function TunnelBackground({ sectionIndex }: TunnelBackgroundProps) {
    const containerRef = useRef<HTMLDivElement>(null);
    const sceneRef = useRef<THREE.Scene | null>(null);
    const cameraRef = useRef<THREE.PerspectiveCamera | null>(null);
    const rendererRef = useRef<THREE.WebGLRenderer | null>(null);
    const meshRef = useRef<THREE.InstancedMesh | null>(null);
    const materialRef = useRef<THREE.ShaderMaterial | null>(null);
    const isPageActive = usePageVisibility();
    const animationFrameIdRef = useRef<number>(0);

    const isVisible = useRef(true);
    const tunnelState = useRef({ speed: 0.5, rotationSpeed: 0.001, fov: 70 });
    const prevSectionRef = useRef<number>(0);
    const tunnelCount = 600;

    const colorPalette = [0.55, 0.80, 0.15, 0.05, 0.30, 0.65];

    useEffect(() => {
        if (!containerRef.current) return;

        // --- SETUP ---
        const width = window.innerWidth;
        const height = window.innerHeight;
        const scene = new THREE.Scene();
        sceneRef.current = scene;

        const camera = new THREE.PerspectiveCamera(70, width / height, 0.1, 3000);
        cameraRef.current = camera;

        const renderer = new THREE.WebGLRenderer({
            antialias: true,
            powerPreference: "high-performance",
            alpha: true
        });
        renderer.setSize(width, height);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
        renderer.setClearColor(0x000000, 0);
        containerRef.current.appendChild(renderer.domElement);
        rendererRef.current = renderer;

        // --- GEOMETRY & MATERIAL ---
        const baseGeo = new THREE.BoxGeometry(1.5, 1.5, 60);
        const geometry = new THREE.InstancedBufferGeometry().copy(baseGeo as any);
        
        const zStarts = new Float32Array(tunnelCount);
        const speedOffsets = new Float32Array(tunnelCount);
        const dummy = new THREE.Object3D();

        const mesh = new THREE.InstancedMesh(geometry, new THREE.MeshBasicMaterial(), tunnelCount);
        
        for (let i = 0; i < tunnelCount; i++) {
            const radius = 30 + Math.random() * 50;
            const angle = Math.random() * Math.PI * 2;
            const x = Math.cos(angle) * radius;
            const y = Math.sin(angle) * radius;
            const z = (Math.random() - 0.5) * 3000;

            zStarts[i] = z;
            speedOffsets[i] = Math.random() + 0.5;

            // Set fixed rotation and X/Y position
            dummy.position.set(x, y, 0); // Z handled in shader
            dummy.lookAt(0, 0, 50); // Fixed rotation relative to center
            dummy.updateMatrix();
            mesh.setMatrixAt(i, dummy.matrix);

            const color = new THREE.Color().setHSL(colorPalette[0], 1.0, 0.5);
            mesh.setColorAt(i, color);
        }

        geometry.setAttribute('aZStart', new THREE.InstancedBufferAttribute(zStarts, 1));
        geometry.setAttribute('aSpeedOffset', new THREE.InstancedBufferAttribute(speedOffsets, 1));

        const material = new THREE.ShaderMaterial({
            uniforms: {
                uTime: { value: 0 },
                uSpeed: { value: 0.5 },
            },
            vertexShader,
            fragmentShader,
            transparent: true,
            blending: THREE.AdditiveBlending,
            depthWrite: false
        });
        materialRef.current = material;
        (mesh as any).material = material;
        
        scene.add(mesh);
        meshRef.current = mesh;

        // --- ANIMATION ---
        const animate = () => {
            if (!isVisible.current || !isPageActive) {
                animationFrameIdRef.current = 0;
                return;
            }
            animationFrameIdRef.current = requestAnimationFrame(animate); 
            
            if (!cameraRef.current || !materialRef.current || !rendererRef.current || !meshRef.current) return;

            const time = Date.now() * 0.001;
            const state = tunnelState.current;

            // Update FOV
            if (cameraRef.current.fov !== state.fov) {
                cameraRef.current.fov = state.fov;
                cameraRef.current.updateProjectionMatrix();
            }

            // Update Uniforms
            materialRef.current.uniforms.uTime.value = time;
            materialRef.current.uniforms.uSpeed.value = state.speed;

            // Rotation (Z-axis spin)
            meshRef.current.rotation.z += state.rotationSpeed;

            rendererRef.current.render(scene, cameraRef.current);
        };
        animate();

        // --- OBSERVERS ---
        const observer = new IntersectionObserver(([entry]) => {
            isVisible.current = entry.isIntersecting;
            if (isVisible.current && isPageActive && !animationFrameIdRef.current) {
                animate();
            }
        }, { threshold: 0.1 });
        observer.observe(containerRef.current);

        const handleResize = () => {
            if (!cameraRef.current || !rendererRef.current) return;
            const w = window.innerWidth;
            const h = window.innerHeight;
            cameraRef.current.aspect = w / h;
            cameraRef.current.updateProjectionMatrix();
            rendererRef.current.setSize(w, h);
        };
        window.addEventListener('resize', handleResize);

        return () => {
            window.removeEventListener('resize', handleResize);
            observer.disconnect();
            if (animationFrameIdRef.current) cancelAnimationFrame(animationFrameIdRef.current);
            if (containerRef.current && renderer.domElement) {
                containerRef.current.removeChild(renderer.domElement);
            }
            baseGeo.dispose();
            geometry.dispose();
            material.dispose();
            renderer.dispose();
        };
    }, [isPageActive]);

    // --- TRANSITIONS ---
    useEffect(() => {
        if (!meshRef.current || !cameraRef.current) return;
        if (prevSectionRef.current === sectionIndex) return;

        const tl = gsap.timeline();
        const state = tunnelState.current;
        const camera = cameraRef.current;
        const isForward = sectionIndex > prevSectionRef.current;
        const targetSpeed = isForward ? 140 : -140;

        tl.to(state, {
            speed: targetSpeed,
            rotationSpeed: -0.5,
            fov: 120,
            duration: 1.0,
            ease: "expo.in"
        });

        tl.to(camera.rotation, {
            z: -0.4,
            y: -0.8,
            duration: 1.5,
            ease: "power2.inOut"
        }, "<");

        // Color Update
        const targetHue = colorPalette[sectionIndex % colorPalette.length];
        const targetColor = new THREE.Color().setHSL(targetHue, 1.0, 0.5);

        tl.add(() => {
            const mesh = meshRef.current;
            if (!mesh) return;
            for (let i = 0; i < tunnelCount; i++) {
                const c = targetColor.clone().offsetHSL(0, 0, (Math.random() - 0.5) * 0.2);
                mesh.setColorAt(i, c);
            }
            if (mesh.instanceColor) mesh.instanceColor.needsUpdate = true;
        }, "-=0.5");

        tl.to(state, {
            speed: 0.5,
            rotationSpeed: 0.001,
            fov: 70,
            duration: 1.5,
            ease: "power2.out"
        });

        tl.to(camera.rotation, {
            z: 0,
            y: 0,
            duration: 1.2,
            ease: "back.out(1.2)"
        }, "<");

        prevSectionRef.current = sectionIndex;
    }, [sectionIndex]);

    return (
        <div
            ref={containerRef}
            className="fixed top-0 left-0 w-full h-full pointer-events-none"
            style={{ zIndex: 0 }}
        />
    );
}



================================================================================
FILE: .\components\tunnel\TunnelExperience.tsx
================================================================================

"use client";

import { useState, useEffect } from "react";
import TunnelBackground from "./TunnelBackground";
import { motion, AnimatePresence } from "framer-motion";
import { usePageVisibility } from "@/hooks/usePageVisibility";

const sections = [
    {
        id: "hero",
        title: "Inkspire Studio",
        text: "Where ideas turn into stories that move people and build brands.",
        color: "text-cyan-400 shadow-cyan-400/50"
    },
    {
        id: "strategy",
        title: "Strategy First",
        text: "We dont design for looks. We design for purpose, growth, and results.",
        color: "text-fuchsia-500 shadow-fuchsia-500/50"
    },
    {
        id: "impact",
        title: "Impact & Emotion",
        text: "Creativity isnt noise. Its emotion, meaning, and action built into every frame.",
        color: "text-yellow-400 shadow-yellow-400/50"
    }
];

export default function TunnelExperience() {
    const [currentSection, setCurrentSection] = useState(0);
    const [isAnimating, setIsAnimating] = useState(false);
    const isPageActive = usePageVisibility();

    useEffect(() => {
        const handleWheel = (e: WheelEvent) => {
            if (isAnimating || !isPageActive) return;

            // Threshold to prevent accidental double-skips
            if (Math.abs(e.deltaY) < 50) return;

            if (e.deltaY > 0 && currentSection < sections.length - 1) {
                navigate(currentSection + 1);
            } else if (e.deltaY < 0 && currentSection > 0) {
                navigate(currentSection - 1);
            }
        };

        window.addEventListener("wheel", handleWheel);
        return () => window.removeEventListener("wheel", handleWheel);
    }, [currentSection, isAnimating]);

    const navigate = (nextIndex: number) => {
        setIsAnimating(true);
        setCurrentSection(nextIndex);
        // Allow time for the tunnel animation to do its "warp" transition
        // The tunnel animations take about 3s total, but visual impact is early.
        // We unlock input a bit earlier to feel responsive, but not too early.
        setTimeout(() => setIsAnimating(false), 2000);
    };

    return (
        <main className="w-full h-[100dvh] overflow-hidden bg-black text-white relative font-sans selection:bg-white/30">
            <TunnelBackground sectionIndex={currentSection} />

            <div className="fixed bottom-8 left-1/2 -translate-x-1/2 z-20 text-xs md:text-sm tracking-[0.2em] text-white/60 animate-bounce pointer-events-none select-none uppercase">
                Scroll to Travel
            </div>

            <AnimatePresence mode="wait">
                <motion.section
                    key={currentSection}
                    initial={{ opacity: 0, scale: 0.9, filter: "blur(10px)" }}
                    animate={{ opacity: 1, scale: 1, filter: "blur(0px)" }}
                    exit={{ opacity: 0, scale: 1.1, filter: "blur(10px)" }}
                    transition={{ duration: 1, ease: "easeOut" }}
                    className="absolute inset-0 z-10 flex flex-col items-center justify-center pointer-events-none"
                >
                    <h1
                        className={`text-5xl md:text-8xl font-black uppercase tracking-widest mb-6 text-center transition-colors duration-500 ${sections[currentSection].color}`}
                        style={{ textShadow: `0 0 40px currentColor` }}
                    >
                        {sections[currentSection].title}
                    </h1>
                    <p className="text-lg md:text-2xl text-center text-gray-300 max-w-2xl px-6 leading-relaxed font-light tracking-wide">
                        {sections[currentSection].text}
                    </p>
                </motion.section>
            </AnimatePresence>

            {/* Navigation Indicators */}
            <div className="fixed right-8 top-1/2 -translate-y-1/2 flex flex-col gap-6 z-30">
                {sections.map((_, idx) => (
                    <button
                        key={idx}
                        onClick={() => {
                            if (!isAnimating && idx !== currentSection) navigate(idx);
                        }}
                        className={`w-3 h-3 rounded-full transition-all duration-500 border border-white/40 cursor-pointer hover:border-white hover:scale-125 ${currentSection === idx ? 'bg-white scale-125 shadow-[0_0_15px_white]' : 'bg-transparent'}`}
                        aria-label={`Go to section ${idx + 1}`}
                    />
                ))}
            </div>
        </main>
    );
}



================================================================================
FILE: .\components\ui\AnimatedCounter.tsx
================================================================================

"use client";

import { useRef } from "react";
import { useAnimatedCounter } from "@/hooks/useAnimatedCounter";

interface AnimatedCounterProps {
    value: string;
    label: string;
}

export default function AnimatedCounter({ value, label }: AnimatedCounterProps) {
    const countRef = useRef<HTMLHeadingElement>(null);
    const containerRef = useRef<HTMLDivElement>(null);

    const { suffix } = useAnimatedCounter(containerRef, countRef, value);

    return (
        <div ref={containerRef} className="counter-item p-4 sm:p-6 md:p-8 rounded-2xl hover:scale-[1.02] md:hover:scale-105 transition-all duration-500 cursor-default group relative overflow-hidden flex flex-col justify-center items-center h-full min-h-[140px] md:min-h-[180px]
            bg-[linear-gradient(180deg,rgba(255,255,255,0.05),rgba(255,255,255,0.015))]
            shadow-[inset_0_0_0_1px_rgba(255,255,255,0.08),0_20px_50px_rgba(0,0,0,0.35)]
            before:absolute before:inset-0 before:bg-[linear-gradient(180deg,rgba(167,139,250,0.08),rgba(109,40,217,0.04))] before:opacity-100 before:pointer-events-none">
            <div className="absolute inset-0 bg-gradient-to-br from-purple-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
            <h3 ref={countRef} className="text-4xl sm:text-5xl md:text-6xl font-black text-white/85 group-hover:text-white transition-colors mb-2 relative z-10">
                0{suffix}
            </h3>
            <p className="text-white/65 uppercase tracking-widest text-xs sm:text-sm font-semibold relative z-10 group-hover:text-white transition-colors">{label}</p>
        </div>
    );
}



================================================================================
FILE: .\components\ui\Cursor.tsx
================================================================================

"use client";

import dynamic from "next/dynamic";
import { useIsTouchDevice } from "@/hooks/useIsTouchDevice";

// Dynamic import to prevent loading code bundle on mobile
const CursorImpl = dynamic(() => import("./CursorImpl"), { ssr: false });

export default function Cursor() {
    const isTouch = useIsTouchDevice();

    // If undefined (initial client render) or true (mobile), render nothing.
    // This ensures on desktop we wait for check (1 tick) before loading/rendering cursor.
    if (isTouch === undefined || isTouch === true) {
        return null;
    }

    return <CursorImpl />;
}



================================================================================
FILE: .\components\ui\CursorImpl.tsx
================================================================================

"use client";

import { useEffect, useRef } from "react";

export default function ArrowCursor() {
    const cursorRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        // We can keep these checks as a fallback, although the wrapper handles it.
        const coarse = window.matchMedia("(pointer: coarse)").matches;
        const reduce = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        if (coarse || reduce) return;

        const el = cursorRef.current;
        if (!el) return;

        const root = document.body;

        // state
        let prevX = 0;
        let prevY = 0;
        let pointerX = 0;
        let pointerY = 0;

        let angle = 0;
        let prevAngle = 0;
        let angleDisplace = 0;

        const degrees = 57.296;
        const cursorSize = 20;

        // init styles (same spirit as your snippet)
        Object.assign(el.style, {
            boxSizing: "border-box",
            position: "fixed",
            top: "0px",
            left: `${-cursorSize / 2}px`,
            zIndex: "2147483647",
            width: `${cursorSize}px`,
            height: `${cursorSize}px`,
            transition: "250ms, transform 100ms",
            userSelect: "none",
            pointerEvents: "none",
            opacity: "1",
            transform: "translate3d(-9999px,-9999px,0)",
        } as CSSStyleDeclaration);

        const move = (e: MouseEvent) => {
            // Check if element is still mounted
            if (!el) return;

            prevX = pointerX;
            prevY = pointerY;

            // similar to original (pageX + rect offsets)
            const rect = root.getBoundingClientRect();
            pointerX = e.pageX + rect.x;
            pointerY = e.pageY + rect.y;

            const dx = prevX - pointerX;
            const dy = prevY - pointerY;
            const dist = Math.sqrt(dy * dy + dx * dx);

            el.style.transform = `translate3d(${pointerX}px, ${pointerY}px, 0)`;

            if (dist > 1) rotate(dx, dy);
            else el.style.transform += ` rotate(${angleDisplace}deg)`;
        };

        const rotate = (dx: number, dy: number) => {
            const unsortedAngle = Math.atan(Math.abs(dy) / Math.abs(dx)) * degrees;
            prevAngle = angle;

            if (dx <= 0 && dy >= 0) angle = 90 - unsortedAngle + 0;
            else if (dx < 0 && dy < 0) angle = unsortedAngle + 90;
            else if (dx >= 0 && dy <= 0) angle = 90 - unsortedAngle + 180;
            else if (dx > 0 && dy > 0) angle = unsortedAngle + 270;

            if (Number.isNaN(angle)) angle = prevAngle;
            else {
                const diff = angle - prevAngle;
                if (diff <= -270) angleDisplace += 360 + diff;
                else if (diff >= 270) angleDisplace += diff - 360;
                else angleDisplace += diff;
            }

            el.style.transform += ` rotate(${angleDisplace}deg)`;

            // Adjust anchor points based on rotation quadrant (copied behavior)
            const modAngle = angleDisplace >= 0 ? angleDisplace % 360 : 360 + (angleDisplace % 360);

            if (modAngle >= 45 && modAngle < 135) {
                el.style.left = `${-cursorSize}px`;
                el.style.top = `${-cursorSize / 2}px`;
            } else if (modAngle >= 135 && modAngle < 225) {
                el.style.left = `${-cursorSize / 2}px`;
                el.style.top = `${-cursorSize}px`;
            } else if (modAngle >= 225 && modAngle < 315) {
                el.style.left = `0px`;
                el.style.top = `${-cursorSize / 2}px`;
            } else {
                el.style.left = `${-cursorSize / 2}px`;
                el.style.top = `0px`;
            }
        };

        window.addEventListener("mousemove", move, { passive: true });

        return () => {
            window.removeEventListener("mousemove", move);
        };
    }, []);

    return (
        <>
            <div ref={cursorRef} className="curzr" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path
                        className="inner"
                        d="M25,30a5.82,5.82,0,0,1-1.09-.17l-.2-.07-7.36-3.48a.72.72,0,0,0-.35-.08.78.78,0,0,0-.33.07L8.24,29.54a.66.66,0,0,1-.2.06,5.17,5.17,0,0,1-1,.15,3.6,3.6,0,0,1-3.29-5L12.68,4.2a3.59,3.59,0,0,1,6.58,0l9,20.74A3.6,3.6,0,0,1,25,30Z"
                        fill="#F2F5F8"
                    />
                    <path
                        className="outer"
                        d="M16,3A2.59,2.59,0,0,1,18.34,4.6l9,20.74A2.59,2.59,0,0,1,25,29a5.42,5.42,0,0,1-.86-.15l-7.37-3.48a1.84,1.84,0,0,0-.77-.17,1.69,1.69,0,0,0-.73.16l-7.4,3.31a5.89,5.89,0,0,1-.79.12,2.59,2.59,0,0,1-2.37-3.62L13.6,4.6A2.58,2.58,0,0,1,16,3m0-2h0A4.58,4.58,0,0,0,11.76,3.8L2.84,24.33A4.58,4.58,0,0,0,7,30.75a6.08,6.08,0,0,0,1.21-.17,1.87,1.87,0,0,0,.4-.13L16,27.18l7.29,3.44a1.64,1.64,0,0,0,.39.14A6.37,6.37,0,0,0,25,31a4.59,4.59,0,0,0,4.21-6.41l-9-20.75A4.62,4.62,0,0,0,16,1Z"
                        fill="#111920"
                    />
                </svg>
            </div>

            <style jsx global>{`
        @media (pointer: fine) {
          * {
            cursor: none !important;
          }
        }
      `}</style>
        </>
    );
}



================================================================================
FILE: .\components\ui\FloatingVectorParticles.tsx
================================================================================

"use client";

export default function FloatingVectorParticles() {
    return null;
}



================================================================================
FILE: .\components\ui\Preloader.tsx
================================================================================

"use client";

import { useEffect, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import Image from "next/image";

export default function Preloader() {
    const [loading, setLoading] = useState(true);
    const [progress, setProgress] = useState(0);
    const [particles, setParticles] = useState<{ left: string; top: string; duration: number; delay: number; size: number }[]>([]);

    useEffect(() => {
        const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        // Generate fewer particles if reduced motion is requested
        const particleCount = prefersReducedMotion ? 5 : 20;

        const newParticles = Array.from({ length: particleCount }).map(() => ({
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            duration: prefersReducedMotion ? 5 : (2 + Math.random() * 3),
            delay: Math.random() * 2,
            size: Math.random() * 3 + 1,
        }));
        setParticles(newParticles);

        // Simulate loading progress
        const interval = setInterval(() => {
            setProgress((prev) => {
                if (prev >= 100) {
                    clearInterval(interval);
                    setTimeout(() => setLoading(false), 300); // Even faster exit
                    return 100;
                }
                return prev + 10; // Significantly faster progress
            });
        }, 20);

        return () => clearInterval(interval);
    }, []);

    return (
        <AnimatePresence>
            {loading && (
                <motion.div
                    className="fixed inset-0 z-[9999] flex flex-col items-center justify-center bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-neutral-900 via-black to-black overflow-hidden px-6"
                    initial={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    transition={{ duration: 0.8, ease: "easeInOut" }}
                >
                    {/* Animated Logo Container */}
                    <motion.div
                        className="mb-8 md:mb-12 relative w-full max-w-[280px] sm:max-w-md aspect-square flex items-center justify-center"
                        initial={{ scale: 0.8, opacity: 0, filter: "blur(10px)" }}
                        animate={{
                            scale: 1,
                            opacity: 1,
                            filter: "blur(0px)",
                        }}
                        transition={{
                            duration: 1.2,
                            ease: "easeOut"
                        }}
                    >
                        {/* Magical Glow Behind Logo */}
                        <div className="absolute inset-0 bg-purple-600/30 rounded-full blur-[60px] md:blur-[100px] animate-pulse" />
                        <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 h-3/4 bg-indigo-500/20 rounded-full blur-[40px] md:blur-[60px] animate-pulse delay-75" />

                        <div className="relative w-full h-full p-8 sm:p-12">
                            <Image
                                src="/logos/Inkspire logos/logo.webp"
                                alt="Inkspire Logo"
                                fill
                                className="object-contain drop-shadow-[0_0_20px_rgba(168,85,247,0.4)]"
                                priority
                                quality={85}
                                sizes="(max-width: 768px) 200px, 400px"
                            />
                        </div>
                    </motion.div>

                    {/* Progress Bar Container */}
                    <div className="relative group">
                        {/* External Glow for Progress Bar (not clipped) */}
                        <div className="absolute inset-0 bg-purple-500/20 blur-md rounded-full opacity-50" />
                        <div className="relative w-48 sm:w-64 h-1 md:h-1.5 bg-white/5 rounded-full overflow-hidden backdrop-blur-sm ring-1 ring-white/10">
                            <motion.div
                                className="h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"
                                initial={{ width: "0%" }}
                                animate={{ width: `${progress}%` }}
                                transition={{ duration: 0.1 }}
                            />
                        </div>
                    </div>

                    {/* Progress Text */}
                    <motion.div
                        className="mt-6 flex flex-col items-center"
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        transition={{ delay: 0.3 }}
                    >
                        <span className="text-white/80 text-sm md:text-lg font-light tracking-[0.3em] md:tracking-[0.5em] uppercase">Loading</span>
                        <span className="text-purple-400 text-[10px] md:text-xs tracking-widest mt-1">{progress}%</span>
                    </motion.div>

                    {/* Magical Floating Particles */}
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        {particles.map((p, i) => (
                            <motion.div
                                key={i}
                                className="absolute bg-white rounded-full shadow-[0_0_10px_rgba(255,255,255,0.8)]"
                                style={{
                                    left: p.left,
                                    top: p.top,
                                    width: p.size,
                                    height: p.size,
                                }}
                                animate={{
                                    y: [0, -40, 0],
                                    opacity: [0, 0.8, 0],
                                    scale: [0.5, 1.2, 0.5],
                                }}
                                transition={{
                                    duration: p.duration,
                                    repeat: Infinity,
                                    delay: p.delay,
                                    ease: "easeInOut"
                                }}
                            />
                        ))}
                    </div>
                </motion.div>
            )}
        </AnimatePresence>
    );
}



================================================================================
FILE: .\components\ui\SectionTitle.tsx
================================================================================

import React from 'react';

interface SectionTitleProps {
    title: string;
    highlight: string;
    highlightColor?: string;
    className?: string;
}

export default function SectionTitle({ title, highlight, highlightColor = "text-accentPurple", className = "" }: SectionTitleProps) {
    return (
        <h2 
            className={`fade-up relative z-20 text-3xl md:text-4xl lg:text-6xl font-bold mb-6 md:mb-8 text-center ${className}`}
        >
            {title} <span className={highlightColor}>{highlight}</span>
        </h2>
    );
}



================================================================================
FILE: .\components\ui\TypewriterText.tsx
================================================================================

"use client";

import React, { useState, useEffect } from "react";
import { motion } from "framer-motion";
import { usePageVisibility } from "@/hooks/usePageVisibility";

interface TypewriterTextProps {
    text: string;
    speed?: number;
    delay?: number;
    className?: string;
}

export default function TypewriterText({ 
    text, 
    speed = 50, 
    delay = 1000,
    className = "" 
}: TypewriterTextProps) {
    const [displayedText, setDisplayedText] = useState("");
    const [isStarted, setIsStarted] = useState(false);
    const isPageActive = usePageVisibility();

    useEffect(() => {
        if (!isPageActive) return;
        const startTimeout = setTimeout(() => {
            setIsStarted(true);
        }, delay);

        return () => clearTimeout(startTimeout);
    }, [delay, isPageActive]);

    useEffect(() => {
        if (!isStarted || !isPageActive) return;

        if (displayedText.length < text.length) {
            const timeout = setTimeout(() => {
                setDisplayedText(text.slice(0, displayedText.length + 1));
            }, speed);

            return () => clearTimeout(timeout);
        }
    }, [displayedText, text, speed, isStarted]);

    // Split text into lines if it contains <br /> or similar (passed as \n or just let HTML handle it)
    // For simplicity, we just type the string. If the user wants specific line breaks, they can pass them.

    return (
        <span className={className}>
            {displayedText}
            <motion.span
                animate={{ opacity: [1, 0] }}
                transition={{ duration: 0.8, repeat: Infinity, ease: "linear" }}
                className="inline-block w-[3px] h-[0.9em] bg-white align-middle ml-1"
            />
        </span>
    );
}



================================================================================
FILE: .\data\clients.ts
================================================================================

export interface Client {
    id: string;
    logo: string;
    projectSlug: string | null;
    name: string | null;
}

export const clients: Client[] = [
    { id: "c1", logo: "/clients/Inkspire clients logo/1.webp", projectSlug: null, name: "Client 1" },
    { id: "c2", logo: "/clients/Inkspire clients logo/2.webp", projectSlug: null, name: "Client 2" },
    { id: "c3", logo: "/clients/Inkspire clients logo/3.webp", projectSlug: null, name: "Client 3" },
    { id: "c4", logo: "/clients/Inkspire clients logo/4.webp", projectSlug: null, name: "Client 4" },
    { id: "c5", logo: "/clients/Inkspire clients logo/5.webp", projectSlug: null, name: "Client 5" },
    { id: "c6", logo: "/clients/Inkspire clients logo/6.webp", projectSlug: null, name: "Client 6" },
    { id: "c7", logo: "/clients/Inkspire clients logo/7.webp", projectSlug: null, name: "Client 7" },
    { id: "c9", logo: "/clients/Inkspire clients logo/9 (1).webp", projectSlug: null, name: "Client 9" },
    { id: "c8", logo: "/clients/Inkspire clients logo/8.webp", projectSlug: null, name: "Client 8" },
    { id: "c10", logo: "/clients/Inkspire clients logo/10 (1).webp", projectSlug: null, name: "Client 10" },
    { id: "c11", logo: "/clients/Inkspire clients logo/11.webp", projectSlug: null, name: "Client 11" },
    { id: "c12", logo: "/clients/Inkspire clients logo/12.webp", projectSlug: null, name: "Client 12" },
    { id: "c13", logo: "/clients/Inkspire clients logo/13.webp", projectSlug: null, name: "Client 13" },
    { id: "c14", logo: "/clients/Inkspire clients logo/14.webp", projectSlug: null, name: "Client 14" },
    { id: "c15", logo: "/clients/Inkspire clients logo/15 (1).webp", projectSlug: null, name: "Client 15" },
    { id: "c16", logo: "/clients/Inkspire clients logo/16.webp", projectSlug: null, name: "Client 16" },
    { id: "c17", logo: "/clients/Inkspire clients logo/17 (2).webp", projectSlug: null, name: "Client 17" },
    { id: "c18", logo: "/clients/Inkspire clients logo/18 (2).webp", projectSlug: null, name: "Client 18" },
    { id: "c19", logo: "/clients/Inkspire clients logo/19 (2).webp", projectSlug: null, name: "Client 19" }
];



================================================================================
FILE: .\data\derivedWorks.ts
================================================================================

import { projects } from "./projects";
import { clients as newClients } from "./clients";

export const works = projects.map(p => ({
    id: p.id,
    source: "work",
    title: p.title,
    subtitle: p.subtitle || "",
    description: p.description || "",
    imageUrl: p.coverImage || "/works/placeholder.webp",
    social: {
        behanceUrl: p.links?.behance || "#",
        instagramUrl: p.links?.instagram || "#",
        facebookUrl: p.links?.facebook || "#",
        twitterUrl: p.links?.twitter || "#"
    }
}));

export const clients = newClients.map(c => c.logo);



================================================================================
FILE: .\data\projects.ts
================================================================================

import { Project } from "@/types/project";

export const projects: Project[] = [
    {
        id: "work-4",
        slug: "neon-cybernetic",
        title: "Neon Cybernetic Ent",
        subtitle: "Digital Art / Branding",
        description: "A futuristic exploration of neon aesthetics and cybernetic enhancements, creating a vivid digital experience.",
        coverImage: "/works/4.webp",
        logo: null,
        gallery: null,
        clientName: "Cybernetic",
        year: "2024",
        services: ["Digital Art", "Branding"],
        tags: ["Neon", "Futuristic"],
        links: {
            website: null,
            behance: "#",
            instagram: "#"
        }
    },
    {
        id: "work-5",
        slug: "abstract-flow",
        title: "Abstract Flow Systems",
        subtitle: "Motion Graphics",
        description: "Fluid dynamics simulation rendered in real-time, showcasing the chaotic beauty of liquid motion in a digital space.",
        coverImage: "/works/5.webp",
        logo: null,
        gallery: null,
        clientName: "Flow Systems",
        year: "2024",
        services: ["Motion Graphics"],
        tags: ["Abstract", "Dynamics"],
        links: {
            website: null,
            behance: "#",
            instagram: "#"
        }
    },
    {
        id: "work-6",
        slug: "urban-glitch",
        title: "Urban Glitch Series",
        subtitle: "Photography / VFX",
        description: "Capturing the raw energy of urban environments through a lens of digital distortion and glitch art.",
        coverImage: "/works/6.webp",
        logo: null,
        gallery: null,
        clientName: "Urban Glitch",
        year: "2023",
        services: ["Photography", "VFX"],
        tags: ["Urban", "Glitch"],
        links: {
            website: null,
            behance: "#",
            instagram: null
        }
    },
    {
        id: "work-7",
        slug: "holo-interface",
        title: "Holo-Interface V1",
        subtitle: "UI/UX Design",
        description: "Concept for a next-generation holographic interface, focusing on spatial navigation and gesture control.",
        coverImage: "/works/7.webp",
        logo: null,
        gallery: null,
        clientName: "Holo Labs",
        year: "2024",
        services: ["UI/UX Design"],
        tags: ["Holographic", "Spatial"],
        links: {
            website: null,
            behance: null,
            instagram: "#"
        }
    },
    {
        id: "work-8",
        slug: "synthwave-sunset",
        title: "Synthwave Sunset",
        subtitle: "Illustration",
        description: "A nostalgic journey back to the 80s with a modern twist, featuring vibrant sunsets and retro-futuristic landscapes.",
        coverImage: "/works/8.webp",
        logo: null,
        gallery: null,
        clientName: "Retro Wave",
        year: "2023",
        services: ["Illustration"],
        tags: ["80s", "Synthwave"],
        links: {
            website: null,
            behance: "#",
            instagram: null
        }
    },
    {
        id: "work-9",
        slug: "cyber-hookah",
        title: "Cyber Hookah Lounge",
        subtitle: "Brand Identity",
        description: "Complete brand overhaul for a high-tech lounge, merging traditional relaxation with cyberpunk aesthetics.",
        coverImage: "/works/9 (1).webp",
        logo: null,
        gallery: null,
        clientName: "Cyber Hookah",
        year: "2024",
        services: ["Brand Identity", "Interior Design"],
        tags: ["Cyberpunk", "Lifestyle"],
        links: {
            website: null,
            behance: null,
            instagram: "#",
            facebook: "#"
        }
    },
    {
        id: "work-10",
        slug: "deep-space-mining",
        title: "Deep Space Mining",
        subtitle: "Concept Art",
        description: "Visualizing the industrial frontier of the future with massive scale mining operations in the asteroid belt.",
        coverImage: "/works/10.webp",
        logo: null,
        gallery: null,
        clientName: "Stellar Industries",
        year: "2024",
        services: ["Concept Art"],
        tags: ["Sci-Fi", "Industrial"],
        links: {
            website: null,
            behance: "#",
            instagram: null
        }
    },
    {
        id: "work-11",
        slug: "bio-luminescent-flora",
        title: "Bio-Luminescent Flora",
        subtitle: "3D Modeling",
        description: "A study of alien botany, focusing on emissive textures and organic modeling techniques.",
        coverImage: "/works/11.webp",
        logo: null,
        gallery: null,
        clientName: "Xeno Botany",
        year: "2023",
        services: ["3D Modeling"],
        tags: ["Alien", "Nature"],
        links: {
            website: null,
            behance: null,
            instagram: "#"
        }
    },
    {
        id: "work-12",
        slug: "neuro-link",
        title: "Neuro-Link Interface",
        subtitle: "Product Design",
        description: "Speculative design for a brain-computer interface layout, prioritizing data density and readability.",
        coverImage: "/works/12.webp",
        logo: null,
        gallery: null,
        clientName: "Neuro Tech",
        year: "2024",
        services: ["Product Design"],
        tags: ["BCI", "Interface"],
        links: {
            website: null,
            behance: "#",
            instagram: null
        }
    },
    {
        id: "work-14",
        slug: "quantum-viz",
        title: "Quantum Data Visualization",
        subtitle: "Data Viz",
        description: "Representing complex quantum states through abstract, multidimensional visual metaphors.",
        coverImage: "/works/14.webp",
        logo: null,
        gallery: null,
        clientName: "Quantum Labs",
        year: "2024",
        services: ["Data Viz"],
        tags: ["Quantum", "Visualization"],
        links: {
            website: null,
            behance: null,
            instagram: null,
            twitter: "#"
        }
    },
    {
        id: "work-15",
        slug: "void-drifter",
        title: "Void Drifter",
        subtitle: "Character Design",
        description: "Character concept for a lone traveler navigating the empty spaces between stars.",
        coverImage: "/works/15.webp",
        logo: null,
        gallery: null,
        clientName: "Void Studios",
        year: "2023",
        services: ["Character Design"],
        tags: ["Space", "Traveler"],
        links: {
            website: null,
            behance: "#",
            instagram: "#"
        }
    },
    {
        id: "work-16",
        slug: "echoes-silence",
        title: "Echoes of Silence",
        subtitle: "Album Art",
        description: "Cover art design capturing the visual representation of sound decay in an anechoic chamber.",
        coverImage: "/works/16.webp",
        logo: null,
        gallery: null,
        clientName: "Echo Records",
        year: "2024",
        services: ["Album Art"],
        tags: ["Sound", "Minimal"],
        links: {
            website: null,
            behance: null,
            instagram: "#"
        }
    },
    {
        id: "work-17",
        slug: "prismatic-core",
        title: "Prismatic Core",
        subtitle: "3D Render",
        description: "Abstract render exploring light refraction and dispersion through crystalline structures.",
        coverImage: "/works/17.webp",
        logo: null,
        gallery: null,
        clientName: "Prism Collective",
        year: "2024",
        services: ["3D Render"],
        tags: ["Crystalline", "Light"],
        links: {
            website: null,
            behance: "#",
            instagram: null
        }
    },
    {
        id: "work-18",
        slug: "digital-zen",
        title: "Digital Zen Garden",
        subtitle: "Environment Design",
        description: "A peaceful, digitally constructed space designed for virtual reality meditation apps.",
        coverImage: "/works/18.webp",
        logo: null,
        gallery: null,
        clientName: "Zen Apps",
        year: "2023",
        services: ["Environment Design"],
        tags: ["Meditation", "VR"],
        links: {
            website: null,
            behance: null,
            instagram: null,
            facebook: "#"
        }
    }
];

export function getProjectBySlug(slug: string): Project | null {
    return projects.find(p => p.slug === slug) || null;
}

export function getProjectById(id: string): Project | null {
    return projects.find(p => p.id === id) || null;
}



================================================================================
FILE: .\data\siteContent.ts
================================================================================

export const siteContent = {
    global: {
        siteName: "Inkspire Studio",
        logoText: "INKSPIRE",
        footerText: " 2025 Inkspire Agency. All rights reserved.",
    },
    navigation: {
        menuItems: [
            { label: "Home", href: "/" },
            { label: "portfolio", href: "/portfolio" },
            { label: "Contact", href: "/contact" },
        ],
    },
    hero: {
        primaryCtaLabel: "Start Project",
        primaryCtaHref: "/contact",
        scrollLabelTop: " ",
        scrollLabelBottom: " ",
    },


    process: {
        steps: [
            {
                id: "01",
                title: "Strategy First. Always.",
                description: "We dont design for looks. We design for purpose, growth, and results.",
            },
            {
                id: "02",
                title: "Stories That Move People",
                description: "Creativity isnt noise. Its emotion, meaning, and action built into every frame.",
            },
            {
                id: "03",
                title: "Built to Be Executed",
                description: "Great ideas mean nothing if they cant be delivered. We create production-ready concepts that work in the real world.",
            },
            {
                id: "04",
                title: "Platform Over Templates",
                description: "Every platform speaks differently. We dont copy-paste, we create content that fits where it lives.",
            },
            {
                id: "05",
                title: "Impact Over Volume",
                description: "More content doesnt mean better content. We measure success by engagement, leads, and revenue.",
            },
        ],
    },

    finalCta: {
        title: "Ready to craft your next scene?",
        description: "Lets turn your idea into a cinematic experience.",
        buttonLabel: "Start Your Project",
        buttonHref: "/contact",
    },
};



================================================================================
FILE: .\data\staticData.ts
================================================================================

export { works, clients } from "./derivedWorks";

export const services = [
    {
        icon: "Fingerprint",
        title: "Branding",
        desc: "We create brands that feel alive, identities with voice, color, character, and clarity. From naming and visual identity to full brand manuals, we give your brand a system it can grow with."
    },
    {
        icon: "Clapperboard",
        title: "Content Creation",
        desc: "Photography, social visuals, motion pieces, stories, and ideas that stop the scroll. Creative concepts built around your brand tone and audience behavior."
    },
    {
        icon: "Laptop",
        title: "Web Development",
        desc: "We design websites that look good, load fast, and communicate simply. Clean UX, modern layouts, strong copy, and mobile-first development."
    },
    {
        icon: "CalendarCheck",
        title: "Social Media Management",
        desc: "We run your digital presence: content calendars, captions, design direction, posting, ad planning, analytics, everything your brand needs to stay active and consistent."
    },
    {
        icon: "PenTool",
        title: "Social Media Design",
        desc: "We create the visual identity of your feed: Layouts, color systems, typography styles, highlights, story templates, and branded visuals."
    },

    {
        icon: "Megaphone",
        title: "Marketing Campaigns",
        desc: "Integrated campaign concepts crafted for social, ground activation, and digital reach. We create campaigns that people talk about."
    },
];

export const team = [
    {
        name: "Mohammad Aldomi",
        role: "Full-stack Developer",
        image: "/team/mohamed.webp"
    },
    {
        name: "Sultan",
        role: "Marketing Architect",
        image: "/team/sultan.webp"
    },
    {
        name: "Mahmoud",
        role: "Art Director",
        image: "/team/mahmoud.webp"
    },
];



export const stats = [
    { val: "7+", label: "Years of Experience" },
    { val: "13+", label: "Industries" },
    { val: "350+", label: "Creative Assets" },
    { val: "24+", label: "Clients" }
];



================================================================================
FILE: .\data\stories.ts
================================================================================

/**
 * UNIFIED STORY DATA LAYER
 * All cinematic moments are now unified into a single master narrative.
 */

export interface StoryMoment {
    type: "image" | "video";
    src: string;
    tag: string;
}

export interface Story {
    id: string;
    name: string;
    sub: string;
    avatar: string;
    projectSlug: string | null;
    stories: StoryMoment[];
}

// Internal Master Narrative Structure (Semantic organization)
const MASTER_ODYSSEY_MOMENTS: StoryMoment[] = [
    // --- CHAPTER 1: BRAND IDENTITY ---
    { type: "image", src: "/reels/3.webp", tag: "Brand Identity // Creative Direction" },
    { type: "image", src: "/reels/4.webp", tag: "Brand Identity // Visual Language" },

    // --- CHAPTER 2: WEB EXPERIENCE ---
    { type: "image", src: "/reels/5.webp", tag: "Web Experience // Modern UI/UX" },
    { type: "image", src: "/reels/6.webp", tag: "Web Experience // Interactive Motion" },

    // --- CHAPTER 3: CLIENT SUCCESS ---
    { type: "image", src: "/reels/7.webp", tag: "Client Success // Strategic Growth" },
    { type: "image", src: "/reels/8.webp", tag: "Client Success // Digital Transformation" },

    // --- CHAPTER 4: AGENCY LIFE ---
    { type: "image", src: "/reels/9.webp", tag: "Agency Life // Our Studio" },
    { type: "image", src: "/reels/10.webp", tag: "Agency Life // Team Synergy" },

    // --- CHAPTER 5: LATEST WORK ---
    { type: "image", src: "/reels/11.webp", tag: "Latest Work // Modern Aesthetics" },
    { type: "image", src: "/reels/12.webp", tag: "Latest Work // Final Masterpiece" },
];

/**
 * EXPORTED HIGHLIGHTS
 * Optimized for UI rendering: Containing exactly ONE master story.
 * This naturally triggers the UI to show a single prominent story bubble.
 */
export const HIGHLIGHTS: Story[] = [
    {
        id: "inkspire-master-story",
        name: "Inkspire Stories",
        sub: "The Full Odyssey",
        avatar: "/reels/3.webp",
        projectSlug: null,
        stories: MASTER_ODYSSEY_MOMENTS
    }
];

// Semantic Source of Truth
export const INKSPIRE_STORY = {
    id: "inkspire-odyssey",
    title: "Inkspire Stories",
    chapters: MASTER_ODYSSEY_MOMENTS
};



================================================================================
FILE: .\hooks\useAnimatedCounter.ts
================================================================================

"use client";

import { useEffect, RefObject } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import { usePageVisibility } from "@/hooks/usePageVisibility";

gsap.registerPlugin(ScrollTrigger);

export function useAnimatedCounter(
    containerRef: RefObject<HTMLElement>,
    countRef: RefObject<HTMLElement>,
    value: string
) {
    const isPageActive = usePageVisibility();
    const numValue = parseInt(value.replace(/\D/g, ''));
    const suffix = value.replace(/[0-9]/g, '');

    useEffect(() => {
        if (!isPageActive) return;
        const el = countRef.current;
        const container = containerRef.current;
        if (!el || !container) return;

        // Initial state
        el.innerText = "0" + suffix;

        const ctx = gsap.context(() => {
            gsap.from(container, {
                scrollTrigger: {
                    trigger: container,
                    start: "top 70%",
                    once: true
                },
                y: 40,
                opacity: 0,
                scale: 0.95,
                duration: 0.6,
                ease: "power3.out"
            });

            const proxy = { val: 0 };
            gsap.to(proxy, {
                val: numValue,
                duration: 2.5,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: container,
                    start: "top 70%",
                    once: true,
                },
                onUpdate: () => {
                    el.innerText = Math.ceil(proxy.val) + suffix;
                }
            });
        }, container);

        return () => ctx.revert();
    }, [containerRef, countRef, numValue, suffix]);

    return { suffix };
}



================================================================================
FILE: .\hooks\useCinematicReveal.ts
================================================================================

"use client";

import { useEffect, useRef, useCallback } from 'react';
import { useResponsiveMode } from './useResponsiveMode';

// Configuration based on the user's "Global/Premium" reference
const CONFIG = {
    lerpFactor: 0.1,      // Smooth mouse tracking
    maxDist: 400,         // Distance where effect starts
    minMaskRadius: 0,
    maxMaskRadius: 320,   // Large reveal
    maskFeather: 80,      // Soft gradient edge
};

interface StackState {
    intensity: number; // 0 to 1
    rect: DOMRect | null;
}

export function useCinematicReveal() {
    const { hasTouch, isDesktop, prefersReducedMotion } = useResponsiveMode();
    const containerRef = useRef<HTMLDivElement>(null);
    const stacksRef = useRef<(HTMLDivElement | null)[]>([]);
    const requestRef = useRef<number>();

    // Mutable state for physics (avoiding React renders for 60fps)
    const stateRef = useRef({
        mouse: {
            targetX: -1000, targetY: -1000,
            currentX: -1000, currentY: -1000,
            isHovering: false
        },
        stacks: [] as StackState[]
    });

    const setStackRef = useCallback((el: HTMLDivElement | null, index: number) => {
        stacksRef.current[index] = el;
        // Initialize state for this stack
        if (!stateRef.current.stacks[index]) {
            stateRef.current.stacks[index] = { intensity: 0, rect: null };
        }
    }, []);

    const updateRects = useCallback(() => {
        if (!stacksRef.current.length) return;
        stacksRef.current.forEach((stack, i) => {
            if (stack && stateRef.current.stacks[i]) {
                stateRef.current.stacks[i].rect = stack.getBoundingClientRect();
            }
        });
    }, []);

    const animate = useCallback(() => {
        const { mouse, stacks } = stateRef.current;

        // 1. Lerp Mouse
        mouse.currentX += (mouse.targetX - mouse.currentX) * CONFIG.lerpFactor;
        mouse.currentY += (mouse.targetY - mouse.currentY) * CONFIG.lerpFactor;

        // 2. Update Spotlight (Global)
        if (containerRef.current) {
            const containerRect = containerRef.current.getBoundingClientRect();
            const relX = mouse.currentX - containerRect.left;
            const relY = mouse.currentY - containerRect.top;

            containerRef.current.style.setProperty('--sx', `${relX}px`);
            containerRef.current.style.setProperty('--sy', `${relY}px`);
            containerRef.current.style.setProperty('--spot-op', mouse.isHovering ? '1' : '0');
        }

        // 3. Update Stacks
        stacksRef.current.forEach((stack, i) => {
            if (!stack) return;
            const stackState = stacks[i];
            if (!stackState || !stackState.rect) return;

            const rect = stackState.rect;
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            // Distance
            const dist = Math.sqrt(
                Math.pow(mouse.currentX - centerX, 2) +
                Math.pow(mouse.currentY - centerY, 2)
            );

            // Calculate Target Intensity
            let targetIntensity = 0;
            if (mouse.isHovering) {
                const norm = Math.max(0, 1 - dist / CONFIG.maxDist);
                targetIntensity = norm * norm;
            }

            // Lerp Intensity
            stackState.intensity += (targetIntensity - stackState.intensity) * CONFIG.lerpFactor;

            // --- APPLY STYLES ---
            const overlay = stack.querySelector('.re-stack-overlay') as HTMLElement;

            if (stackState.intensity > 0.001) {
                const intensity = stackState.intensity;

                // A. Scale & Z-Index
                const scale = 1 + (intensity * 0.03);
                stack.style.zIndex = intensity > 0.1 ? "20" : "2";
                stack.style.transform = `translateY(var(--y-offset, 0px)) scale(${scale})`;

                // B. Filter (Brightness/Contrast/DropShadow)
                const brightness = 0.8 + (intensity * 0.3);
                const contrast = 1 + (intensity * 0.1);
                const shadowOpacity = intensity * 0.4;
                stack.style.filter = `brightness(${brightness}) contrast(${contrast}) drop-shadow(0 20px 40px rgba(0,0,0,${shadowOpacity}))`;

                // C. Overlay Mask & Opacity
                if (overlay) {
                    overlay.style.opacity = intensity.toFixed(3);
                    const maskX = mouse.currentX - rect.left;
                    const maskY = mouse.currentY - rect.top;
                    const radius = CONFIG.minMaskRadius + (intensity * CONFIG.maxMaskRadius);
                    const feather = CONFIG.maskFeather;
                    const maskValue = `radial-gradient(circle ${radius}px at ${maskX}px ${maskY}px, black 100%, transparent calc(100% + ${feather}px))`;
                    overlay.style.webkitMaskImage = maskValue;
                    overlay.style.maskImage = maskValue;
                }

            } else {
                // Reset to idle
                stack.style.zIndex = "2";
                stack.style.transform = `translateY(var(--y-offset, 0px)) scale(1)`;
                stack.style.filter = `brightness(0.7) contrast(1.0) grayscale(0.2)`;
                if (overlay) {
                    overlay.style.opacity = '0';
                }
            }
        });

        requestRef.current = requestAnimationFrame(animate);
    }, []);

    useEffect(() => {
        if (typeof window === 'undefined') return;

        // Disable reveal on touch devices, non-desktop, or reduced motion
        const isDisabled = hasTouch || !isDesktop || prefersReducedMotion;
        if (isDisabled) {
            return;
        }

        const onMouseMove = (e: MouseEvent) => {
            stateRef.current.mouse.targetX = e.clientX;
            stateRef.current.mouse.targetY = e.clientY;
            stateRef.current.mouse.isHovering = true;
        };
        const onMouseLeave = () => {
            stateRef.current.mouse.isHovering = false;
        };
        const onResize = () => updateRects();

        window.addEventListener('mousemove', onMouseMove);
        window.addEventListener('mouseleave', onMouseLeave);
        window.addEventListener('resize', onResize);

        updateRects();
        requestRef.current = requestAnimationFrame(animate);

        return () => {
            window.removeEventListener('mousemove', onMouseMove);
            window.removeEventListener('mouseleave', onMouseLeave);
            window.removeEventListener('resize', onResize);
            if (requestRef.current) cancelAnimationFrame(requestRef.current);
        };
    }, [hasTouch, isDesktop, prefersReducedMotion, updateRects, animate]);

    // Compute isDisabled based on responsive mode
    const isDisabled = hasTouch || !isDesktop || prefersReducedMotion;

    return {
        isTouch: isDisabled,
        containerRef,
        setStackRef
    };
}



================================================================================
FILE: .\hooks\useCinematicScroll.ts
================================================================================

"use client";

import { useEffect, useRef, useCallback } from "react";
import { usePathname } from "next/navigation";
import Lenis from "lenis";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import { usePageVisibility } from "./usePageVisibility";
import { useResponsiveMode } from "./useResponsiveMode";

// Register GSAP plugin
if (typeof window !== "undefined") {
  gsap.registerPlugin(ScrollTrigger);
}

// ============================================================================
// TYPES
// ============================================================================
interface UseCinematicScrollOptions {
  excludePaths?: string[];
  lenisConfig?: Partial<ConstructorParameters<typeof Lenis>[0]>;
}

interface UseCinematicScrollReturn {
  lenis: Lenis | null;
  isActive: boolean;
  scrollTo: (target: number | string | HTMLElement, options?: object) => void;
}

// ============================================================================
// DEFAULT EXCLUDED PATHS
// ============================================================================
const DEFAULT_EXCLUDED_PATHS = ["/", "/experience"];

// ============================================================================
// THE HOOK
// ============================================================================
export function useCinematicScroll(
  options: UseCinematicScrollOptions = {}
): UseCinematicScrollReturn {
  const { excludePaths = DEFAULT_EXCLUDED_PATHS, lenisConfig = {} } = options;

  const { scrollMode, prefersReducedMotion, isHydrated } = useResponsiveMode();
  const pathname = usePathname();
  const isPageVisible = usePageVisibility();

  const lenisRef = useRef<Lenis | null>(null);
  const isActiveRef = useRef(false);
  
  // GSAP ticker callback ref - for proper cleanup
  const tickerCallbackRef = useRef<((time: number) => void) | null>(null);
  
  // Store previous lagSmoothing to restore on cleanup
  const prevLagSmoothingRef = useRef<{ lag: number; minDuration: number } | null>(null);

  // Check if current path is excluded
  const isExcludedPath = excludePaths.some(
    (path) => pathname === path || pathname?.startsWith(path + "/")
  );

  // Determine if we should activate cinematic scroll
  const shouldActivate =
    isHydrated &&
    scrollMode === "cinematic" &&
    !isExcludedPath &&
    !prefersReducedMotion;

  // ============================================================================
  // AGGRESSIVE CLEANUP FUNCTION
  // ============================================================================
  const cleanup = useCallback(() => {
    // 1. Remove GSAP ticker callback
    if (tickerCallbackRef.current) {
      gsap.ticker.remove(tickerCallbackRef.current);
      tickerCallbackRef.current = null;
    }

    // 2. Restore lagSmoothing if we changed it
    if (prevLagSmoothingRef.current) {
      gsap.ticker.lagSmoothing(
        prevLagSmoothingRef.current.lag,
        prevLagSmoothingRef.current.minDuration
      );
      prevLagSmoothingRef.current = null;
    }

    // 3. Destroy Lenis
    if (lenisRef.current) {
      lenisRef.current.destroy();
      lenisRef.current = null;
    }

    // 4. Kill ALL ScrollTriggers
    ScrollTrigger.getAll().forEach((trigger) => trigger.kill());
    ScrollTrigger.clearScrollMemory();
    ScrollTrigger.refresh();

    // 5. Reset body styles
    if (typeof document !== "undefined") {
      document.body.style.overflow = "";
      document.body.style.height = "";
      document.documentElement.style.overflow = "";
      document.documentElement.style.height = "";
      document.documentElement.style.scrollBehavior = "";
    }

    isActiveRef.current = false;
  }, []);

  // ============================================================================
  // INITIALIZATION EFFECT
  // ============================================================================
  useEffect(() => {
    if (typeof window === "undefined") return;

    // If we shouldn't activate, ensure cleanup and exit
    if (!shouldActivate) {
      cleanup();
      return;
    }

    // Already active? Skip re-init
    if (isActiveRef.current && lenisRef.current) {
      return;
    }

    // Initialize Lenis
    const lenis = new Lenis({
      duration: 1.2,
      easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
      orientation: "vertical",
      smoothWheel: true,
      wheelMultiplier: 1,
      touchMultiplier: 0,
      infinite: false,
      ...lenisConfig,
    });

    lenisRef.current = lenis;

    // Sync Lenis with ScrollTrigger
    lenis.on("scroll", ScrollTrigger.update);

    // Store current lagSmoothing before changing
    // Note: GSAP doesn't expose current values, so we store our change flag
    prevLagSmoothingRef.current = { lag: 500, minDuration: 33 }; // GSAP defaults
    gsap.ticker.lagSmoothing(0);

    // Create ticker callback and store ref for cleanup
    const tickerCallback = (time: number) => {
      if (lenisRef.current) {
        lenisRef.current.raf(time * 1000);
      }
    };
    tickerCallbackRef.current = tickerCallback;
    gsap.ticker.add(tickerCallback);

    isActiveRef.current = true;

    // Cleanup on unmount or mode change
    return cleanup;
  }, [shouldActivate, cleanup, lenisConfig]);

  // ============================================================================
  // PAGE VISIBILITY EFFECT
  // ============================================================================
  useEffect(() => {
    if (!lenisRef.current) return;

    if (isPageVisible) {
      lenisRef.current.start();
    } else {
      lenisRef.current.stop();
    }
  }, [isPageVisible]);

  // ============================================================================
  // SCROLL TO METHOD
  // ============================================================================
  const scrollTo = useCallback(
    (target: number | string | HTMLElement, options?: object) => {
      if (lenisRef.current) {
        lenisRef.current.scrollTo(target, options);
      } else if (typeof window !== "undefined") {
        if (typeof target === "number") {
          window.scrollTo({ top: target, behavior: "smooth" });
        } else if (typeof target === "string") {
          const element = document.querySelector(target);
          element?.scrollIntoView({ behavior: "smooth" });
        } else if (target instanceof HTMLElement) {
          target.scrollIntoView({ behavior: "smooth" });
        }
      }
    },
    []
  );

  return {
    lenis: lenisRef.current,
    isActive: isActiveRef.current,
    scrollTo,
  };
}



================================================================================
FILE: .\hooks\useCinematicTransitions.ts
================================================================================

"use client";

import { useEffect } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

export function useCinematicTransitions() {
    useEffect(() => {
        gsap.registerPlugin(ScrollTrigger);

        // Get all major sections
        const sections = gsap.utils.toArray<HTMLElement>(".cinematic-section");

        sections.forEach((section, index) => {
            // Fade and scale in effect as section enters
            gsap.fromTo(
                section,
                {
                    opacity: 0,
                    scale: 0.95,
                    y: 50,
                },
                {
                    opacity: 1,
                    scale: 1,
                    y: 0,
                    duration: 1.5,
                    ease: "power3.out",
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none reverse",
                        // markers: true, // Uncomment for debugging
                    },
                }
            );

            // Parallax effect on section content
            const content = section.querySelector(".parallax-content");
            if (content) {
                gsap.to(content, {
                    y: -50,
                    ease: "none",
                    scrollTrigger: {
                        trigger: section,
                        start: "top bottom",
                        end: "bottom top",
                        scrub: 1,
                    },
                });
            }
        });

        return () => {
            ScrollTrigger.getAll().forEach((t) => t.kill());
        };
    }, []);
}



================================================================================
FILE: .\hooks\useFloatingParticles.ts
================================================================================

"use client";

import { useRef } from "react";

export interface ParticleConfig {
    id: string;
    img: string;
    left: string;
    top: string;
    size: number;
    rotation: number;
    baseOpacity: number;
    baseScale: number;
    floatSpeed: number;
    floatAmp: number;
    floatPhase: number;
    parallaxFactor: number;
}

export function useFloatingParticles(imageSources: string[]) {
    return {
        containerRef: useRef<HTMLDivElement>(null),
        particles: [],
        isReady: false,
        isTouch: false
    };
}



================================================================================
FILE: .\hooks\useGSAPFade.ts
================================================================================

"use client";

import { useEffect, useRef } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

gsap.registerPlugin(ScrollTrigger);

export function useGSAPFade() {
    const containerRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

        const ctx = gsap.context(() => {
            const fadeElements = gsap.utils.toArray<HTMLElement>(".fade-up");
            
            if (prefersReducedMotion) {
                 fadeElements.forEach((el) => {
                     gsap.set(el, { opacity: 1, y: 0 });
                 });
                 return;
            }
            
            fadeElements.forEach((el, index) => {
                gsap.fromTo(el,
                    {
                        opacity: 0,
                        y: 30,
                        scale: 0.95,
                        visibility: "hidden"
                    },
                    {
                        opacity: 1,
                        y: 0,
                        scale: 1,
                        visibility: "visible",
                        duration: 0.5,
                        ease: "power3.out",
                        scrollTrigger: {
                            trigger: el,
                            start: "top 70%",
                            once: true,
                            toggleActions: "play none none none"
                        },
                        delay: (index % 4) * 0.08,
                        onStart: () => {
                            (el as HTMLElement).style.willChange = "transform, opacity";
                        },
                        onComplete: () => {
                            (el as HTMLElement).style.willChange = "auto";
                        }
                    }
                );
            });
        }, containerRef);

        return () => ctx.revert();
    }, []);

    return containerRef;
}



================================================================================
FILE: .\hooks\useHeroAnimation.ts
================================================================================

"use client";

import { useEffect, RefObject } from "react";
import gsap from "gsap";

export function useHeroAnimation(
    containerRef: RefObject<HTMLElement>,
    titleRef: RefObject<HTMLElement>,
    ctaRef: RefObject<HTMLElement>,
    scrollLabelRef: RefObject<HTMLElement>
) {
    useEffect(() => {
        if (!containerRef.current) return;

        // Check for reduced motion preference
        const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        if (prefersReducedMotion) {
            if (titleRef.current) {
                const logo = titleRef.current.querySelector(".hero-logo");
                const tagline = titleRef.current.querySelector(".hero-tagline");
                if (logo) gsap.set(logo, { y: 0, opacity: 1 });
                if (tagline) gsap.set(tagline, { y: 0, opacity: 1 });
            }
            if (ctaRef.current) gsap.set(ctaRef.current, { y: 0, opacity: 1 });
            if (scrollLabelRef.current) gsap.set(scrollLabelRef.current, { y: 0, opacity: 1 });
            return;
        }

        const ctx = gsap.context(() => {
            const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

            // Logo and Tagline animation
            const logo = titleRef.current?.querySelector(".hero-logo");
            const tagline = titleRef.current?.querySelector(".hero-tagline");

            if (logo || tagline) {
                // Ensure they start invisible to avoid flash
                const elements = [logo, tagline].filter(Boolean);
                if (elements.length > 0) {
                    tl.from(elements, {
                        y: 60,
                        opacity: 0,
                        duration: 0.8,
                        stagger: 0.15,
                    });
                }
            }

            // CTA - quicker entrance
            if (ctaRef.current) {
                tl.from(
                    ctaRef.current,
                    {
                        y: 15,
                        opacity: 0,
                        duration: 0.5,
                    },
                    "-=0.4"
                );
            }

            // Scroll label
            if (scrollLabelRef.current) {
                tl.from(
                    scrollLabelRef.current,
                    {
                        y: 8,
                        opacity: 0,
                        duration: 0.5,
                    },
                    "-=0.4"
                );
            }
        }, containerRef);

        return () => ctx.revert();
    }, [containerRef, titleRef, ctaRef, scrollLabelRef]);
}



================================================================================
FILE: .\hooks\useIsTouchDevice.ts
================================================================================

"use client";

import { useEffect, useState } from "react";

export function useIsTouchDevice() {
    const [isTouch, setIsTouch] = useState<boolean | undefined>(undefined);

    useEffect(() => {
        if (typeof window === "undefined") return;

        const checkTouch = () => {
            return (
                window.matchMedia("(pointer: coarse)").matches ||
                window.matchMedia("(hover: none)").matches ||
                navigator.maxTouchPoints > 0
            );
        };

        setIsTouch(checkTouch());
    }, []);

    return isTouch;
}



================================================================================
FILE: .\hooks\useNativeScroll.ts
================================================================================

"use client";

import { useEffect, useRef, useState, useCallback } from "react";
import { useResponsiveMode } from "./useResponsiveMode";

// ============================================================================
// TYPES
// ============================================================================
interface InViewState {
  /** Whether the element is currently in the viewport */
  isInView: boolean;
  /** Intersection ratio (0-1) */
  ratio: number;
  /** Has ever been in view (for "once" animations) */
  hasBeenInView: boolean;
}

interface UseNativeScrollOptions {
  /** IntersectionObserver threshold(s) */
  threshold?: number | number[];
  /** IntersectionObserver rootMargin */
  rootMargin?: string;
  /** If true, only trigger once when element enters view */
  triggerOnce?: boolean;
}

interface UseNativeScrollReturn {
  /** Ref to attach to the target element */
  ref: React.RefObject<HTMLElement | null>;
  /** Current in-view state */
  inView: InViewState;
  /** Scroll progress (0-1) based on document scroll */
  scrollProgress: number;
}

// ============================================================================
// THE HOOK
// ============================================================================
/**
 * Native scroll handling for mobile/tablet with IntersectionObserver.
 * Provides in-view detection and scroll progress for Framer Motion animations.
 * Respects prefersReducedMotion.
 * 
 * @param options Configuration options
 * @returns Object with ref, inView state, and scrollProgress
 */
export function useNativeScroll(
  options: UseNativeScrollOptions = {}
): UseNativeScrollReturn {
  const {
    threshold = 0.1,
    rootMargin = "0px",
    triggerOnce = false,
  } = options;

  const { prefersReducedMotion } = useResponsiveMode();
  const elementRef = useRef<HTMLElement | null>(null);
  
  const [inView, setInView] = useState<InViewState>({
    isInView: false,
    ratio: 0,
    hasBeenInView: false,
  });

  const [scrollProgress, setScrollProgress] = useState(0);

  // ============================================================================
  // INTERSECTION OBSERVER EFFECT
  // ============================================================================
  useEffect(() => {
    if (typeof window === "undefined") return;

    const element = elementRef.current;
    if (!element) return;

    // If reduced motion, immediately set as in view (no animation needed)
    if (prefersReducedMotion) {
      setInView({
        isInView: true,
        ratio: 1,
        hasBeenInView: true,
      });
      return;
    }

    const observerCallback: IntersectionObserverCallback = (entries) => {
      entries.forEach((entry) => {
        const isInView = entry.isIntersecting;
        const ratio = entry.intersectionRatio;

        setInView((prev) => {
          // If triggerOnce and already been in view, don't update isInView
          if (triggerOnce && prev.hasBeenInView) {
            return {
              ...prev,
              ratio,
            };
          }

          return {
            isInView,
            ratio,
            hasBeenInView: prev.hasBeenInView || isInView,
          };
        });
      });
    };

    const observer = new IntersectionObserver(observerCallback, {
      threshold,
      rootMargin,
    });

    observer.observe(element);

    return () => {
      observer.disconnect();
    };
  }, [threshold, rootMargin, triggerOnce, prefersReducedMotion]);

  // ============================================================================
  // SCROLL PROGRESS EFFECT
  // ============================================================================
  useEffect(() => {
    if (typeof window === "undefined") return;

    // If reduced motion, don't track scroll progress
    if (prefersReducedMotion) {
      setScrollProgress(1);
      return;
    }

    const handleScroll = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = docHeight > 0 ? Math.min(1, Math.max(0, scrollTop / docHeight)) : 0;
      setScrollProgress(progress);
    };

    // Initial calculation
    handleScroll();

    // Use passive listener for performance
    window.addEventListener("scroll", handleScroll, { passive: true });

    return () => {
      window.removeEventListener("scroll", handleScroll);
    };
  }, [prefersReducedMotion]);

  return {
    ref: elementRef,
    inView,
    scrollProgress,
  };
}

// ============================================================================
// BATCH OBSERVER HOOK (for multiple elements)
// ============================================================================
interface BatchObserverOptions extends UseNativeScrollOptions {
  /** Array of refs to observe */
  refs: React.RefObject<HTMLElement | null>[];
}

interface BatchInViewState {
  [key: number]: InViewState;
}

/**
 * Batch IntersectionObserver for multiple elements.
 * More efficient than multiple useNativeScroll hooks.
 */
export function useNativeScrollBatch(
  options: BatchObserverOptions
): BatchInViewState {
  const {
    refs,
    threshold = 0.1,
    rootMargin = "0px",
    triggerOnce = false,
  } = options;

  const { prefersReducedMotion } = useResponsiveMode();
  const [states, setStates] = useState<BatchInViewState>({});

  useEffect(() => {
    if (typeof window === "undefined") return;

    // If reduced motion, immediately set all as in view
    if (prefersReducedMotion) {
      const allInView: BatchInViewState = {};
      refs.forEach((_, index) => {
        allInView[index] = { isInView: true, ratio: 1, hasBeenInView: true };
      });
      setStates(allInView);
      return;
    }

    const elements = refs.map((ref) => ref.current).filter(Boolean) as HTMLElement[];
    if (elements.length === 0) return;

    const observerCallback: IntersectionObserverCallback = (entries) => {
      setStates((prev) => {
        const newStates = { ...prev };

        entries.forEach((entry) => {
          const index = elements.indexOf(entry.target as HTMLElement);
          if (index === -1) return;

          const isInView = entry.isIntersecting;
          const ratio = entry.intersectionRatio;
          const prevState = prev[index] || { isInView: false, ratio: 0, hasBeenInView: false };

          // If triggerOnce and already been in view, don't update isInView
          if (triggerOnce && prevState.hasBeenInView) {
            newStates[index] = { ...prevState, ratio };
          } else {
            newStates[index] = {
              isInView,
              ratio,
              hasBeenInView: prevState.hasBeenInView || isInView,
            };
          }
        });

        return newStates;
      });
    };

    const observer = new IntersectionObserver(observerCallback, {
      threshold,
      rootMargin,
    });

    elements.forEach((el) => observer.observe(el));

    return () => {
      observer.disconnect();
    };
  }, [refs, threshold, rootMargin, triggerOnce, prefersReducedMotion]);

  return states;
}



================================================================================
FILE: .\hooks\useNineDimensionsController.ts
================================================================================

"use client";

import { useState, useEffect, useCallback, useRef } from "react";
import { useResponsiveMode } from "@/hooks/useResponsiveMode";

// ============================================================================
// TYPES
// ============================================================================
interface UseNineDimensionsControllerOptions {
  /** If false, disables all navigation event handlers */
  enabled?: boolean;
  /** Animation lock duration in ms */
  animationDuration?: number;
}

interface UseNineDimensionsControllerReturn {
  /** Current section index (0-8) */
  currentSection: number;
  /** Whether a section transition is in progress */
  isAnimating: boolean;
  /** Navigate to a specific section */
  navigate: (index: number) => void;
  /** Whether the controller is ready (SSR-safe) */
  isReady: boolean;
}

// ============================================================================
// THE HOOK
// ============================================================================
/**
 * Controller for Nine Dimensions section navigation.
 * 
 * Handles:
 * - Wheel navigation (desktop)
 * - Keyboard navigation (arrows)
 * - Touch swipe navigation (tablet with touch)
 * 
 * SSR Safety:
 * - Uses useResponsiveMode for device detection
 * - Has isReady flag for hydration safety
 * - No window access in render path
 * 
 * @param totalSections Number of sections
 * @param options Configuration options
 */
export function useNineDimensionsController(
  totalSections: number,
  options: UseNineDimensionsControllerOptions = {}
): UseNineDimensionsControllerReturn {
  const { enabled = true, animationDuration = 1500 } = options;

  const { scrollMode, prefersReducedMotion } = useResponsiveMode();
  const [currentSection, setCurrentSection] = useState(0);
  const [isAnimating, setIsAnimating] = useState(false);
  const [isReady, setIsReady] = useState(false);
  const animationTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);

  // Mark as ready after hydration
  useEffect(() => {
    setIsReady(true);
    return () => {
      if (animationTimeoutRef.current) {
        clearTimeout(animationTimeoutRef.current);
      }
    };
  }, []);

  // Navigation function
  const navigate = useCallback(
    (nextIndex: number) => {
      if (!enabled) return;
      if (nextIndex < 0 || nextIndex >= totalSections) return;
      if (isAnimating) return;

      setIsAnimating(true);
      setCurrentSection(nextIndex);

      // Lock interaction during transition
      const duration = prefersReducedMotion ? 100 : animationDuration;
      animationTimeoutRef.current = setTimeout(
        () => setIsAnimating(false),
        duration
      );
    },
    [enabled, totalSections, isAnimating, prefersReducedMotion, animationDuration]
  );

  // ============================================================================
  // NAVIGATION EVENT HANDLERS
  // Only active in cinematic mode and when enabled
  // ============================================================================
  useEffect(() => {
    if (typeof window === "undefined") return;
    
    // Don't attach handlers if disabled or in native scroll mode
    if (!enabled || scrollMode !== "cinematic") return;

    // 1. Wheel (Desktop scroll)
    const handleWheel = (e: WheelEvent) => {
      if (isAnimating) return;
      if (Math.abs(e.deltaY) < 30) return;

      if (e.deltaY > 0) {
        navigate(currentSection + 1);
      } else {
        navigate(currentSection - 1);
      }
    };

    // 2. Keyboard (arrows)
    const handleKeyDown = (e: KeyboardEvent) => {
      if (isAnimating) return;
      
      switch (e.key) {
        case "ArrowDown":
        case "ArrowRight":
          e.preventDefault();
          navigate(currentSection + 1);
          break;
        case "ArrowUp":
        case "ArrowLeft":
          e.preventDefault();
          navigate(currentSection - 1);
          break;
      }
    };

    // 3. Touch Swipe (for tablets with touch in cinematic mode)
    let touchStart = 0;
    const handleTouchStart = (e: TouchEvent) => {
      touchStart = e.touches[0].clientY;
    };

    const handleTouchEnd = (e: TouchEvent) => {
      if (isAnimating) return;
      const touchEnd = e.changedTouches[0].clientY;
      const delta = touchStart - touchEnd;

      // Require significant swipe (50px threshold)
      if (Math.abs(delta) > 50) {
        if (delta > 0) {
          navigate(currentSection + 1);
        } else {
          navigate(currentSection - 1);
        }
      }
    };

    // Attach listeners
    window.addEventListener("wheel", handleWheel, { passive: true });
    window.addEventListener("keydown", handleKeyDown);
    window.addEventListener("touchstart", handleTouchStart, { passive: true });
    window.addEventListener("touchend", handleTouchEnd, { passive: true });

    // Cleanup
    return () => {
      window.removeEventListener("wheel", handleWheel);
      window.removeEventListener("keydown", handleKeyDown);
      window.removeEventListener("touchstart", handleTouchStart);
      window.removeEventListener("touchend", handleTouchEnd);
    };
  }, [enabled, scrollMode, isAnimating, currentSection, navigate]);

  return {
    currentSection,
    isAnimating,
    navigate,
    isReady,
  };
}



================================================================================
FILE: .\hooks\usePageVisibility.ts
================================================================================

"use client";

import { useState, useEffect } from 'react';

/**
 * Hook to track page visibility and window focus.
 * Returns true only when the tab is active and the window is focused.
 */
export function usePageVisibility() {
    const [isVisible, setIsVisible] = useState(true);

    useEffect(() => {
        const checkVisibility = () => {
            setIsVisible(document.visibilityState === 'visible' && document.hasFocus());
        };

        const handleFocus = () => setIsVisible(true);
        const handleBlur = () => setIsVisible(false);

        window.addEventListener('focus', handleFocus);
        window.addEventListener('blur', handleBlur);
        document.addEventListener('visibilitychange', checkVisibility);

        // Initial call
        checkVisibility();

        return () => {
            window.removeEventListener('focus', handleFocus);
            window.removeEventListener('blur', handleBlur);
            document.removeEventListener('visibilitychange', checkVisibility);
        };
    }, []);

    return isVisible;
}



================================================================================
FILE: .\hooks\usePopup.tsx
================================================================================

"use client";

import React, { createContext, useContext, useState, ReactNode, useCallback } from "react";
import { PopupPayload } from "@/types/popup";

interface PopupContextType {
    isOpen: boolean;
    currentPopup: PopupPayload | null;
    openPopup: (payload: PopupPayload) => void;
    closePopup: () => void;
}

const PopupContext = createContext<PopupContextType | undefined>(undefined);

export function PopupProvider({ children }: { children: ReactNode }) {
    const [isOpen, setIsOpen] = useState(false);
    const [currentPopup, setCurrentPopup] = useState<PopupPayload | null>(null);

    const openPopup = useCallback((payload: PopupPayload) => {
        setCurrentPopup(payload);
        setIsOpen(true);
    }, []);

    const closePopup = useCallback(() => {
        setIsOpen(false);
    }, []);

    return (
        <PopupContext.Provider value={{ isOpen, currentPopup, openPopup, closePopup }}>
            {children}
        </PopupContext.Provider>
    );
}

export function usePopup() {
    const context = useContext(PopupContext);
    if (!context) {
        throw new Error("usePopup must be used within a PopupProvider");
    }
    return context;
}



================================================================================
FILE: .\hooks\useResponsiveMode.ts
================================================================================

"use client";

import { useSyncExternalStore } from "react";

// ============================================================================
// TYPES
// ============================================================================
export type Breakpoint = "mobile" | "tablet" | "desktop";
export type ScrollMode = "cinematic" | "native";

export interface ResponsiveMode {
  // Hydration safety flag
  isHydrated: boolean;

  // Device Classification
  isMobile: boolean;
  isTablet: boolean;
  isDesktop: boolean;
  breakpoint: Breakpoint;

  // Input Detection
  hasTouch: boolean;
  hasFinePointer: boolean;

  // Preferences
  prefersReducedMotion: boolean;

  // Computed Decisions
  scrollMode: ScrollMode;
  render3D: boolean;

  // Device Capability Heuristics
  deviceCapable: boolean;
}

// ============================================================================
// CONSTANTS
// ============================================================================
const BREAKPOINTS = {
  mobile: 768,
  tablet: 1024,
} as const;

// ============================================================================
// SINGLETON STATE - Global listeners attached ONCE
// ============================================================================
let cachedState: ResponsiveMode | null = null;
let listeners = new Set<() => void>();
let subscriberCount = 0;
let cleanupFn: (() => void) | null = null;

// ============================================================================
// SSR-SAFE INITIAL STATE - isHydrated = false
// ============================================================================
const getServerSnapshot = (): ResponsiveMode => ({
  isHydrated: false, // CRITICAL: false on server
  isMobile: false,
  isTablet: false,
  isDesktop: true,
  breakpoint: "desktop",
  hasTouch: false,
  hasFinePointer: true,
  prefersReducedMotion: false,
  scrollMode: "cinematic",
  render3D: true,
  deviceCapable: true,
});

// ============================================================================
// CLIENT STATE COMPUTATION
// ============================================================================
const computeResponsiveMode = (): ResponsiveMode => {
  if (typeof window === "undefined") {
    return getServerSnapshot();
  }

  const width = window.innerWidth;

  // Breakpoint Detection
  const isMobile = width < BREAKPOINTS.mobile;
  const isTablet = width >= BREAKPOINTS.mobile && width <= BREAKPOINTS.tablet;
  const isDesktop = width > BREAKPOINTS.tablet;
  const breakpoint: Breakpoint = isMobile
    ? "mobile"
    : isTablet
    ? "tablet"
    : "desktop";

  // Input Detection via matchMedia
  const hasTouch =
    window.matchMedia("(pointer: coarse)").matches ||
    window.matchMedia("(hover: none)").matches ||
    navigator.maxTouchPoints > 0;

  const hasFinePointer = window.matchMedia("(pointer: fine)").matches;

  // User Preferences
  const prefersReducedMotion = window.matchMedia(
    "(prefers-reduced-motion: reduce)"
  ).matches;

  // Device Capability Heuristics
  const nav = navigator as Navigator & {
    deviceMemory?: number;
    hardwareConcurrency?: number;
  };
  const hasEnoughMemory = nav.deviceMemory === undefined || nav.deviceMemory >= 4;
  const hasEnoughCores =
    nav.hardwareConcurrency === undefined || nav.hardwareConcurrency >= 6;
  const deviceCapable = hasEnoughMemory && hasEnoughCores;

  // Scroll Mode Decision
  const scrollMode: ScrollMode =
    isDesktop && hasFinePointer && !prefersReducedMotion
      ? "cinematic"
      : "native";

  // 3D Render Decision
  let render3D = false;
  if (!prefersReducedMotion) {
    if (isDesktop) {
      render3D = true;
    } else if (isTablet && hasFinePointer && deviceCapable) {
      render3D = true;
    }
  }

  return {
    isHydrated: true, // CRITICAL: true on client
    isMobile,
    isTablet,
    isDesktop,
    breakpoint,
    hasTouch,
    hasFinePointer,
    prefersReducedMotion,
    scrollMode,
    render3D,
    deviceCapable,
  };
};

// ============================================================================
// NOTIFY ALL LISTENERS
// ============================================================================
const notifyListeners = () => {
  listeners.forEach((listener) => listener());
};

// ============================================================================
// RECOMPUTE AND NOTIFY IF CHANGED
// ============================================================================
const handleChange = () => {
  const newState = computeResponsiveMode();
  const oldState = cachedState;

  // Only notify if something actually changed
  if (
    !oldState ||
    oldState.breakpoint !== newState.breakpoint ||
    oldState.scrollMode !== newState.scrollMode ||
    oldState.render3D !== newState.render3D ||
    oldState.prefersReducedMotion !== newState.prefersReducedMotion ||
    oldState.hasFinePointer !== newState.hasFinePointer ||
    oldState.hasTouch !== newState.hasTouch ||
    oldState.isHydrated !== newState.isHydrated
  ) {
    cachedState = newState;
    notifyListeners();
  }
};

// ============================================================================
// SETUP GLOBAL LISTENERS (ONCE)
// ============================================================================
const setupListeners = () => {
  if (typeof window === "undefined") return;
  if (cleanupFn !== null) return; // Already set up

  const mediaQueries = [
    window.matchMedia(`(max-width: ${BREAKPOINTS.mobile - 1}px)`),
    window.matchMedia(
      `(min-width: ${BREAKPOINTS.mobile}px) and (max-width: ${BREAKPOINTS.tablet}px)`
    ),
    window.matchMedia(`(min-width: ${BREAKPOINTS.tablet + 1}px)`),
    window.matchMedia("(pointer: coarse)"),
    window.matchMedia("(pointer: fine)"),
    window.matchMedia("(hover: none)"),
    window.matchMedia("(hover: hover)"),
    window.matchMedia("(prefers-reduced-motion: reduce)"),
  ];

  const mqHandler = () => handleChange();

  // Subscribe to all media queries
  mediaQueries.forEach((mq) => {
    if (mq.addEventListener) {
      mq.addEventListener("change", mqHandler);
    } else {
      mq.addListener(mqHandler);
    }
  });

  // Debounced resize handler
  let resizeTimer: ReturnType<typeof setTimeout>;
  const resizeHandler = () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(handleChange, 100);
  };

  const orientationHandler = () => handleChange();

  window.addEventListener("resize", resizeHandler);
  window.addEventListener("orientationchange", orientationHandler);

  // Store cleanup function
  cleanupFn = () => {
    mediaQueries.forEach((mq) => {
      if (mq.removeEventListener) {
        mq.removeEventListener("change", mqHandler);
      } else {
        mq.removeListener(mqHandler);
      }
    });
    window.removeEventListener("resize", resizeHandler);
    window.removeEventListener("orientationchange", orientationHandler);
    clearTimeout(resizeTimer);
    cleanupFn = null;
  };
};

// ============================================================================
// TEARDOWN GLOBAL LISTENERS (when last subscriber leaves)
// ============================================================================
const teardownListeners = () => {
  if (cleanupFn) {
    cleanupFn();
  }
};

// ============================================================================
// EXTERNAL STORE IMPLEMENTATION
// ============================================================================
const getSnapshot = (): ResponsiveMode => {
  if (cachedState === null) {
    cachedState = computeResponsiveMode();
  }
  return cachedState;
};

const subscribe = (onStoreChange: () => void): (() => void) => {
  listeners.add(onStoreChange);
  subscriberCount++;

  // Setup global listeners on first subscriber
  if (subscriberCount === 1) {
    setupListeners();
    // Force initial computation on client
    cachedState = computeResponsiveMode();
  }

  return () => {
    listeners.delete(onStoreChange);
    subscriberCount--;

    // Teardown global listeners when last subscriber leaves
    if (subscriberCount === 0) {
      teardownListeners();
    }
  };
};

// ============================================================================
// THE HOOK
// ============================================================================
export function useResponsiveMode(): ResponsiveMode {
  return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot);
}



================================================================================
FILE: .\hooks\useScrollScenes.ts
================================================================================

"use client";

import { useEffect } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

export function useScrollScenes() {
    useEffect(() => {
        gsap.registerPlugin(ScrollTrigger);

        const scenes = document.querySelectorAll(".scene");

        scenes.forEach((scene) => {
            const content = scene.querySelector(".scene-content");
            if (content) {
                gsap.fromTo(
                    content,
                    { opacity: 0, y: 50 },
                    {
                        opacity: 1,
                        y: 0,
                        duration: 1,
                        ease: "power3.out",
                        scrollTrigger: {
                            trigger: scene,
                            start: "top 60%",
                            end: "bottom 20%",
                            toggleActions: "play none none reverse",
                        },
                    }
                );
            }
        });

        return () => {
            ScrollTrigger.getAll().forEach((t) => t.kill());
        };
    }, []);
}



================================================================================
FILE: .\lib\popupMappers.ts
================================================================================

import { PopupPayload, PopupSocialLinks } from "@/types/popup";

interface Service {
    icon: string;
    title: string;
    desc: string;
    social?: PopupSocialLinks;
}

interface TeamMember {
    name: string;
    role: string;
    image: string;
    social?: PopupSocialLinks;
    bio?: string;
}

interface Client {
    path: string;
}

interface Review {
    name: string;
    text: string;
    company: string;
    image?: string;
    social?: PopupSocialLinks;
}

export function buildPopupFromService(service: Service): PopupPayload {
    return {
        id: `service-${service.title}`,
        source: "service",
        title: service.title,
        subtitle: "Key Service",
        description: service.desc,
        social: service.social,
    };
}

export function buildPopupFromTeamMember(member: TeamMember): PopupPayload {
    return {
        id: `team-${member.name}`,
        source: "team",
        title: member.name,
        subtitle: member.role,
        description: member.bio || `${member.name} is a key part of our team, contributing as a ${member.role}.`,
        imageUrl: member.image,
        social: member.social,
    };
}

export function buildPopupFromClient(clientPath: string, index: number): PopupPayload {
    const nameMatch = clientPath.match(/\/([^/]+)\.webp$/);
    const clientName = nameMatch ? nameMatch[1].replace(/%20/g, " ") : "Partner";

    return {
        id: `client-${index}`,
        source: "client",
        title: "Strategic Partner",
        subtitle: clientName,
        imageUrl: clientPath,
        description: "We are proud to have collaborated with this amazing partner to deliver exceptional results.",
    };
}

export function buildPopupFromReview(review: Review): PopupPayload {
    return {
        id: `review-${review.name}`,
        source: "testimonial",
        title: review.name,
        subtitle: review.company,
        description: `"${review.text}"`,
        imageUrl: review.image,
        social: review.social,
    };
}

import { Project } from "@/types/project";

export function buildPopupFromProject(project: Project): PopupPayload {
    return {
        id: project.id,
        source: "work",
        title: project.title,
        subtitle: project.subtitle || "Project",
        description: project.description || "A closer look at this featured project.",
        imageUrl: project.coverImage || "/works/placeholder.webp",
        projectSlug: project.slug,
        social: project.links ? {
            behanceUrl: project.links.behance || undefined,
            instagramUrl: project.links.instagram || undefined,
            facebookUrl: project.links.facebook || undefined,
            twitterUrl: project.links.twitter || undefined,
        } : undefined
    };
}

export function buildPopupFromWork(item: any): PopupPayload {
    return {
        id: item.id || `work-${item.imageUrl}`,
        source: "work",
        title: item.title || "Featured Project",
        subtitle: item.subtitle || "Portfolio",
        imageUrl: item.imageUrl || item.src,
        description: item.description || "A closer look at this featured project.",
        projectSlug: item.slug,
        social: item.social,
    };
}



================================================================================
FILE: .\lib\utils.ts
================================================================================

import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
    return twMerge(clsx(inputs));
}



================================================================================
FILE: .\lib\three\safeDispose.ts
================================================================================

import * as THREE from "three";

type Disposable =
  | THREE.Object3D
  | THREE.Material
  | THREE.Texture
  | THREE.BufferGeometry
  | THREE.WebGLRenderTarget;

const MATERIAL_TEXTURE_KEYS: (keyof THREE.Material)[] = [
  "map",
  "alphaMap",
  "aoMap",
  "bumpMap",
  "displacementMap",
  "emissiveMap",
  "envMap",
  "lightMap",
  "metalnessMap",
  "normalMap",
  "roughnessMap",
  "specularMap",
] as any;

/**
 * Disposes geometries, materials, and textures (including maps + shader uniforms).
 * Uses a WeakSet to avoid double-dispose for shared resources.
 */
export function safeDispose(root: THREE.Object3D) {
  const disposed = new WeakSet<object>();

  const disposeTexture = (tex?: THREE.Texture | null) => {
    if (!tex) return;
    if (disposed.has(tex)) return;
    disposed.add(tex);

    // If texture wraps a video/canvas stream, you may also want to pause/stop it here.
    tex.dispose();
  };

  const disposeMaterial = (mat?: THREE.Material | null) => {
    if (!mat) return;
    if (disposed.has(mat)) return;
    disposed.add(mat);

    // Standard material texture slots
    for (const key of MATERIAL_TEXTURE_KEYS) {
      const value = (mat as any)[key] as THREE.Texture | null | undefined;
      disposeTexture(value);
    }

    // ShaderMaterial uniforms can hold textures too
    const uniforms = (mat as any).uniforms;
    if (uniforms) {
      for (const u of Object.values(uniforms)) {
        const v = (u as any)?.value;
        if (v && (v as THREE.Texture).isTexture) disposeTexture(v as THREE.Texture);
      }
    }

    mat.dispose();
  };

  const disposeGeometry = (geo?: THREE.BufferGeometry | null) => {
    if (!geo) return;
    if (disposed.has(geo)) return;
    disposed.add(geo);
    geo.dispose();
  };

  root.traverse((obj) => {
    // InstancedMesh / Mesh / Points / Line all have geometry + material
    const anyObj = obj as any;

    if (anyObj.geometry) disposeGeometry(anyObj.geometry as THREE.BufferGeometry);

    const mat = anyObj.material as THREE.Material | THREE.Material[] | undefined;
    if (Array.isArray(mat)) mat.forEach(disposeMaterial);
    else disposeMaterial(mat ?? null);
  });
}

/**
 * Composer cleanup: dispose composer + passes if they expose dispose().
 */
export function disposeComposer(composer: any) {
  if (!composer) return;
  try {
    if (Array.isArray(composer.passes)) {
      for (const p of composer.passes) {
        if (p && typeof p.dispose === "function") p.dispose();
      }
    }
    if (typeof composer.dispose === "function") composer.dispose();
  } catch {
    // swallow  disposal is best-effort
  }
}

/**
 * Renderer cleanup: dispose + (optional) forceContextLoss for hard resets on route churn.
 */
export function disposeRenderer(renderer: THREE.WebGLRenderer, forceLoss = false) {
  try {
    renderer.dispose();
    if (forceLoss) {
      // Useful if you see WebGL context accumulation after lots of navigations.
      renderer.forceContextLoss();
    }
  } catch {
    // noop
  }
}



================================================================================
FILE: .\styles\cinematic-reveal.css
================================================================================

/* Cinematic Reveal Styles - v4 Clean & Bottom Aligned */

/* Container */
.re-reveal-container {
    position: relative;
    width: 100%;
    height: 100%;
    z-index: 1;
    pointer-events: none;
    overflow: visible;
    background-color: transparent;
    display: flex;
    justify-content: center;
    align-items: flex-end;
}

@media (min-width: 1025px) {
    .re-reveal-container {
        position: absolute;
        inset: 0;
    }
}

/* 
   GRID LAYOUT 
   - "Images down" -> align-items: flex-end in container
*/
.re-stacks-grid {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    width: 100%;
    height: 100%;
    position: relative;
    z-index: 2;
    padding-bottom: 0px;
}

/* 
   STACK 
   - Treated as "Cutout Characters"
*/
.re-stack {
    position: relative;
    /* Responsive Width: Large & Impactful */
    width: clamp(100px, 30vw, 700px);
    flex: 0 0 auto;

    /* Responsive Spacing - Subtle Overlap */
    margin: 0 calc(var(--overlap, -1.5vw));

    aspect-ratio: 4/5;
    max-height: 95vh;

    /* Invisible Container - Only images show */
    overflow: hidden;
    border-radius: 2rem;
    background: transparent;
    
    /* Removed all visual box indicators */
    box-shadow: none; 
    backdrop-filter: none;

    /* Base Filters - Darker for unrevealed state */
    filter: brightness(0.6) contrast(1.05) grayscale(0.2);

    will-change: transform, filter, z-index;
    transition: filter 0.4s ease-out, transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
}

/* 
   Symmetric Arc Layout
   Applying responsive offsets
*/
.re-stack:nth-child(1),
.re-stack:nth-child(4) {
    --y-offset: clamp(2vh, 4vh, 6vh);
    transform: translateY(var(--y-offset)) scale(1);
    z-index: 1;
}

/* Lifted Middle Images */
.re-stack.re-stack-lifted {
    --y-offset: clamp(-10vh, -18vh, -25vh);
    transform: translateY(var(--y-offset)) scale(1.05);
    z-index: 5;
}

/* Disable Hover Lift on non-hover devices */
@media (hover: hover) {
    .re-stack:hover {
        z-index: 10 !important;
        filter: brightness(1) contrast(1.1) grayscale(0);
    }
}

/* 
   TOUCH / MOBILE STATE
   - Show 4 images on one line
   - No reveal animation (handled by is-touch class)
*/
.re-reveal-container.is-touch .re-stack {
    filter: brightness(0.9) contrast(1.1) grayscale(0);
    transform: translateY(var(--y-offset)) scale(1) !important;
    transition: none !important;
    --overlap: -3vw; /* Slightly more overlap for tight fit */
}

.re-reveal-container.is-touch .re-stacks-grid {
    padding-bottom: 2rem;
    height: auto;
    min-height: 40vh;
}

.re-stack-base {
    z-index: 1;
}

.re-stack-overlay {
    z-index: 2;
    opacity: 0;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    will-change: opacity, mask-image;
    filter: saturate(1.2) brightness(1.1);
}

/* 
   GLOBAL LAYERS 
*/

/* Grain Removed */
.re-grain {
    display: none;
}

.re-dim-layer {
    position: absolute;
    inset: 0;
    z-index: 5;
    /* Bottom gradient to blend feet */
    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0) 50%);
    pointer-events: none;
}

.re-spotlight {
    position: absolute;
    top: 0;
    left: 0;
    width: clamp(600px, 100vw, 1400px);
    height: clamp(600px, 100vw, 1400px);
    transform: translate(calc(var(--sx, -1000px) - 50%), calc(var(--sy, -1000px) - 50%));
    z-index: 20;
    pointer-events: none;

    background: radial-gradient(circle,
            rgba(255, 255, 255, 0.15) 0%,
            rgba(255, 255, 255, 0.05) 30%,
            margin-box,
            rgba(255, 255, 255, 0) 70%);

    mix-blend-mode: overlay;
    opacity: var(--spot-op, 0);
    transition: opacity 0.3s ease;
    will-change: transform, opacity;
}
@media (min-width: 768px) and (max-width: 1024px) {
  .re-reveal-container {
    position: relative !important;
    inset: auto !important;
    height: auto !important;
    min-height: 55vh;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding-top: 10vh;
  }

  .re-stacks-grid {
    height: auto !important;
    max-height: 55vh;
  }
}



================================================================================
FILE: .\styles\tablet.css
================================================================================

/* Tablet range overrides (768px - 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
  html, body {
    overflow-x: hidden;
  }

  /* Section title visibility guard */
  .fade-up {
    position: relative;
    z-index: 20;
  }

  /* Standard tablet section spacing normalization */
  .tablet-section-fix {
    padding-top: 7rem !important;
    padding-bottom: 3.5rem !important;
    justify-content: flex-start !important;
  }

  /* HERO: move reveal grid above text on tablet */
  .re-reveal-container {
    position: relative !important;
    inset: auto !important;
    height: auto !important;
    min-height: 55vh;
    display: flex;
    align-items: flex-start !important;
    justify-content: center;
    padding-top: 5vh;
    z-index: 10 !important;
  }

  .re-stacks-grid {
    height: auto !important;
    max-height: 50vh;
    padding-bottom: 2rem !important;
  }

  /* Readability guard */
  .tablet-text-veil {
    background: linear-gradient(to bottom, rgba(9, 6, 15, 0.85), rgba(9, 6, 15, 0.35));
  }
}



================================================================================
FILE: .\types\popup.ts
================================================================================

export type PopupSource = "client" | "service" | "team" | "work" | "testimonial";

export interface PopupSocialLinks {
    facebookUrl?: string;
    instagramUrl?: string;
    twitterUrl?: string;
    linkedinUrl?: string;
    behanceUrl?: string;
}

export interface PopupPayload {
    id: string; // Unique ID for keying/animations if needed
    source: PopupSource;
    title: string;
    subtitle?: string; // Role, Company, or Service Category
    description?: string;
    imageUrl?: string;
    projectSlug?: string;
    social?: PopupSocialLinks;
    // Optional extra fields for specific rendering logic
    date?: string;
    tags?: string[];
}



================================================================================
FILE: .\types\project.ts
================================================================================

export interface Project {
    id: string;
    slug: string;
    title: string;
    subtitle: string | null;
    description: string | null;
    logo: string | null;
    coverImage: string | null;
    gallery: string[] | null;
    clientName: string | null;
    year: string | null;
    services: string[] | null;
    tags: string[] | null;
    links: {
        website: string | null;
        behance: string | null;
        instagram: string | null;
        facebook?: string | null;
        twitter?: string | null;
    } | null;
}


